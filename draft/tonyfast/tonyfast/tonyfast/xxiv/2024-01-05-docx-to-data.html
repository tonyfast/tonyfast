<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>
   convertin a docx into a structured dataframe
  </title>
  <meta content="this feature engineering task transforms a docx to tidy data.
it can eventually be exported as notebooks." name="description">
  <meta content="light" name="color-scheme">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js">
  </script>
  <script>
   (function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        
        var widgetRendererSrc = 'https://unpkg.com/@jupyter-js-widgets@*/dist/embed.js';
        
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
  </script>
  <style type="text/css">
   /* # accessible css configurations

we define these high level variables to allow for configuration during use and testing.
we are not sure what the preferred default values are for these any accessible notebooks features.
the variables specify critical degrees of freedom in the notebook style.

## notebook interface specific css variables

*/
:root {
    --nb-focus-width: 3px;
    --nb-accent-color: auto;
    --nb-margin: 5%;
    --nb-font-size: 16px;
    --nb-font-family: serif;
    --nb-line-height: 1.5;
    --nb-scrolled-height: 600px;
    --color-light: #FFFFFF;
    --color-dark: #2b2a33;
}


/* map css variables to css properties on the `body` elements.
this mapping turns out css variables into user interfaces. */

body {
    font-size: var(--nb-font-size);
    font-family: var(--nb-font-family);
    accent-color: var(--nb-accent-color);
    margin-left: var(--nb-margin);
    margin-right: var(--nb-margin);
    line-height: var(--nb-line-height);
    width: calc(100% - 2*var(--nb-margin));
    color: var(--color-dark);
    background-color: var(--color-light);
}

body.dark {
    color: var(--color-light);
    background-color: var(--color-dark);
}

main:fullscreen {
    overflow: auto;
    background: var(--color-light);
}

.dark main:fullscreen {
    background: var(--color-dark);
}

/* ## notebook settings

the notebook settings interface connects configurable css features to the user.
we use dialog elements to represents an element that should be hidden by default.
it turns out there are two ways to layout `dialog` elements. 
they can be used as modals or block elements.
we extract this dual purpose to provide both configurations to the user.

*/

dialog form>* {
    display: block;
}


/* ## wcag accessibility guidelines as a feature

flexibility is the future of assistive interfaces.
it is not in the purvey of privileged developers and inaccessible systems to decide what priority accessibility is.
it is the fucking priority.

in this implementation, we want to satisfy broad user needs by making a lot of features configurable.
one configurable feature is the accessibility priority. 
experienced developers may need less assistive features as they spend more time with an interface.

### buttons sizes

WCAG 2.1 defines a huge stinking AAA hit size for buttons. its beautiful.

/* satisfy AAA 2.5.5 */

.wcag-aaa button,
.wcag-aaa input[type=checkbox] {
    min-height: 44px;
    min-width: 44px;
}

.wcag-aaa a {
    font-size: max(44px, var(--nb-font-size));
}

/* WCAG 2.2 clarified a AA button size that is used to style checkboxes and buttons. */
/* satisfy AA 2.5.8 minimum target requirement */
.wcag-aa button,
.wcag-aa input[type=checkbox] {
    min-height: 24px;
    min-width: 24px;
}

.wcag-aa a {
    font-size: max(24px, var(--nb-font-size));
}

/* remove the color styling for AAA */
.wcag-aaa .highlight pre code span[class] {
    color: unset;
}

/* ### native textareas for AAA priority.


our AAA priority choices often ensure that third party libraries can not compromise the accessibility of notebook.
the design decisions are focused native elements so that the assistive technology users have consistent expectations and outcomes.

*/

.markdown textarea[name=source]+[role=group],
.wcag-a textarea[name=source],
.wcag-aa textarea[name=source],
.wcag-aaa .markdown textarea[name=source],
/* this group selector is very ambiguous */
.wcag-aaa textarea[name=source]+[role=group] {
    display: none;
}

/* line height cant change pre elements based on browser presets */
pre,
textarea {
    line-height: unset;
    white-space: pre-wrap;
}

.horiz-overflow pre,
.horiz-overflow textarea {
    white-space: pre;
}

/* this is only needed for the lsit template variant */
ol#cells {
    margin: unset;
    padding: unset;
}

li.cell {
    list-style-type: none;
}

/* ## notebook components layout */

td[role="none"]:not([hidden]),
th[role="none"]:not([hidden]) {
    display: block;
    text-align: unset;
}

table {
    border-spacing: unset;
}

#cells,
#cells .cell,
#cells>tbody {
    display: flex;
    flex-direction: column;
}

ol[reversed]#cells,
[reversed]#cells tbody {
    flex-direction: column-reverse;
}

/* hide the visual output area when there are no outputs. 
assistive technologies will recieve an audible notification that there are not outputs. */

fieldset[data-outputs="0"] {
    display: none;
}

/* ## modifications to html defaults 

### focus 

there nothing to be said about this topic that [sara soueidan](https://www.sarasoueidan.com/blog/focus-indicators/) hasn't said.
we start with her [universal focus recommendation](https://www.sarasoueidan.com/blog/focus-indicators/#a-%E2%80%98universal%E2%80%99-focus-indicator).

*/



.cell:focus-within,
:focus-visible {
    outline: max(var(--nb-focus-width), 1px) solid;
    box-shadow: 0 0 0 calc(2 * max(var(--nb-focus-width), 1px));
}


/* on firefox, the input and output become interactive when there is overflow. chrome fixed this recently find reference.*/
textarea[name=source] {
    min-width: 0;
}

td.nb-outputs,
td.nb-source {
    overflow-x: auto;
}

.horiz-overflow td.nb-outputs,
.horiz-overflow header,
.horiz-overflow footer {
    width: max-content;
}

.horiz-overflow td.nb-source {
    overflow-x: visible;
}

.horiz-overflow td.nb-outputs {
    min-width: 100%;
}

.horiz-overflow .cell {
    width: fit-content;
}

#nb-settings li::marker,
summary[inert]::marker {
    content: "";
}

/* ### inheriting styles */

input,
select,
button {
    font-family: inherit;
    font-size: inherit;
}

textarea {
    font-family: monospace;
    font-size: inherit;
    line-height: inherit;
    overflow: auto;
    color: unset;
}

textarea[name=source] {
    box-sizing: border-box;
    width: 100%;
    resize: none;
}


/* align checkboxes with buttons */
input[type="checkbox"] {
    vertical-align: middle;
}

/* ## custom class selectors */

#nb-dialogs details:not([open])~dialog:not([open]):not(:focus-within):not(:active),
/* legend:not(:focus-within):not(:active), */
details.log:not([open])+table,
.visually-hidden:not(:focus-within):not(:active),
.visually-hide {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 1px;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}

.nb-outputs.nb-scrolled {
    max-height: var(--nb-scrolled-height);
    overflow-y: auto;
}

.nb-outputs.nb-collapsed {
    display: none;
}
  </style>
  <style id="nb-light-highlight" media="screen" type="text/css">
   /** accessible pygments github-light-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #0969da4a }
.c { color: #66707b } /* Comment */
.err { color: #a0111f } /* Error */
.k { color: #a0111f } /* Keyword */
.l { color: #702c00 } /* Literal */
.n { color: #622cbc } /* Name */
.o { color: #024c1a } /* Operator */
.p { color: #24292f } /* Punctuation */
.ch { color: #66707b } /* Comment.Hashbang */
.cm { color: #66707b } /* Comment.Multiline */
.cp { color: #66707b } /* Comment.Preproc */
.cpf { color: #66707b } /* Comment.PreprocFile */
.c1 { color: #66707b } /* Comment.Single */
.cs { color: #66707b } /* Comment.Special */
.gd { color: #023b95 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #a0111f } /* Generic.Error */
.gh { color: #023b95 } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #023b95 } /* Generic.Subheading */
.kc { color: #023b95 } /* Keyword.Constant */
.kd { color: #a0111f } /* Keyword.Declaration */
.kn { color: #a0111f } /* Keyword.Namespace */
.kp { color: #a0111f } /* Keyword.Pseudo */
.kr { color: #a0111f } /* Keyword.Reserved */
.kt { color: #a0111f } /* Keyword.Type */
.ld { color: #702c00 } /* Literal.Date */
.m { color: #702c00 } /* Literal.Number */
.s { color: #023b95 } /* Literal.String */
.na { color: #702c00 } /* Name.Attribute */
.nb { color: #702c00 } /* Name.Builtin */
.nc { color: #023b95 } /* Name.Class */
.no { color: #023b95 } /* Name.Constant */
.nd { color: #702c00 } /* Name.Decorator */
.ni { color: #024c1a } /* Name.Entity */
.ne { color: #622cbc } /* Name.Exception */
.nf { color: #023b95 } /* Name.Function */
.nl { color: #702c00 } /* Name.Label */
.nn { color: #24292f } /* Name.Namespace */
.nx { color: #622cbc } /* Name.Other */
.py { color: #023b95 } /* Name.Property */
.nt { color: #024c1a } /* Name.Tag */
.nv { color: #702c00 } /* Name.Variable */
.ow { color: #622cbc } /* Operator.Word */
.pm { color: #24292f } /* Punctuation.Marker */
.w { color: #24292f } /* Text.Whitespace */
.mb { color: #702c00 } /* Literal.Number.Bin */
.mf { color: #702c00 } /* Literal.Number.Float */
.mh { color: #702c00 } /* Literal.Number.Hex */
.mi { color: #702c00 } /* Literal.Number.Integer */
.mo { color: #702c00 } /* Literal.Number.Oct */
.sa { color: #023b95 } /* Literal.String.Affix */
.sb { color: #023b95 } /* Literal.String.Backtick */
.sc { color: #023b95 } /* Literal.String.Char */
.dl { color: #023b95 } /* Literal.String.Delimiter */
.sd { color: #023b95 } /* Literal.String.Doc */
.s2 { color: #023b95 } /* Literal.String.Double */
.se { color: #023b95 } /* Literal.String.Escape */
.sh { color: #023b95 } /* Literal.String.Heredoc */
.si { color: #023b95 } /* Literal.String.Interpol */
.sx { color: #023b95 } /* Literal.String.Other */
.sr { color: #023b95 } /* Literal.String.Regex */
.s1 { color: #023b95 } /* Literal.String.Single */
.ss { color: #023b95 } /* Literal.String.Symbol */
.bp { color: #702c00 } /* Name.Builtin.Pseudo */
.fm { color: #023b95 } /* Name.Function.Magic */
.vc { color: #702c00 } /* Name.Variable.Class */
.vg { color: #702c00 } /* Name.Variable.Global */
.vi { color: #702c00 } /* Name.Variable.Instance */
.vm { color: #702c00 } /* Name.Variable.Magic */
.il { color: #702c00 } /* Literal.Number.Integer.Long */
  </style>
  <style id="nb-dark-highlight" media="not  screen" type="text/css">
   /** accessible pygments github-dark-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #58a6ff70 }
.c { color: #d9dee3 } /* Comment */
.err { color: #ff9492 } /* Error */
.k { color: #ff9492 } /* Keyword */
.l { color: #ffb757 } /* Literal */
.n { color: #dbb7ff } /* Name */
.o { color: #72f088 } /* Operator */
.p { color: #C9D1D9 } /* Punctuation */
.ch { color: #d9dee3 } /* Comment.Hashbang */
.cm { color: #d9dee3 } /* Comment.Multiline */
.cp { color: #d9dee3 } /* Comment.Preproc */
.cpf { color: #d9dee3 } /* Comment.PreprocFile */
.c1 { color: #d9dee3 } /* Comment.Single */
.cs { color: #d9dee3 } /* Comment.Special */
.gd { color: #91cbff } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #ff9492 } /* Generic.Error */
.gh { color: #91cbff } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #91cbff } /* Generic.Subheading */
.kc { color: #91cbff } /* Keyword.Constant */
.kd { color: #ff9492 } /* Keyword.Declaration */
.kn { color: #ff9492 } /* Keyword.Namespace */
.kp { color: #ff9492 } /* Keyword.Pseudo */
.kr { color: #ff9492 } /* Keyword.Reserved */
.kt { color: #ff9492 } /* Keyword.Type */
.ld { color: #ffb757 } /* Literal.Date */
.m { color: #ffb757 } /* Literal.Number */
.s { color: #91cbff } /* Literal.String */
.na { color: #ffb757 } /* Name.Attribute */
.nb { color: #ffb757 } /* Name.Builtin */
.nc { color: #91cbff } /* Name.Class */
.no { color: #91cbff } /* Name.Constant */
.nd { color: #ffb757 } /* Name.Decorator */
.ni { color: #72f088 } /* Name.Entity */
.ne { color: #dbb7ff } /* Name.Exception */
.nf { color: #91cbff } /* Name.Function */
.nl { color: #ffb757 } /* Name.Label */
.nn { color: #C9D1D9 } /* Name.Namespace */
.nx { color: #dbb7ff } /* Name.Other */
.py { color: #91cbff } /* Name.Property */
.nt { color: #72f088 } /* Name.Tag */
.nv { color: #ffb757 } /* Name.Variable */
.ow { color: #dbb7ff } /* Operator.Word */
.pm { color: #C9D1D9 } /* Punctuation.Marker */
.w { color: #C9D1D9 } /* Text.Whitespace */
.mb { color: #ffb757 } /* Literal.Number.Bin */
.mf { color: #ffb757 } /* Literal.Number.Float */
.mh { color: #ffb757 } /* Literal.Number.Hex */
.mi { color: #ffb757 } /* Literal.Number.Integer */
.mo { color: #ffb757 } /* Literal.Number.Oct */
.sa { color: #91cbff } /* Literal.String.Affix */
.sb { color: #91cbff } /* Literal.String.Backtick */
.sc { color: #91cbff } /* Literal.String.Char */
.dl { color: #91cbff } /* Literal.String.Delimiter */
.sd { color: #91cbff } /* Literal.String.Doc */
.s2 { color: #91cbff } /* Literal.String.Double */
.se { color: #91cbff } /* Literal.String.Escape */
.sh { color: #91cbff } /* Literal.String.Heredoc */
.si { color: #91cbff } /* Literal.String.Interpol */
.sx { color: #91cbff } /* Literal.String.Other */
.sr { color: #91cbff } /* Literal.String.Regex */
.s1 { color: #91cbff } /* Literal.String.Single */
.ss { color: #91cbff } /* Literal.String.Symbol */
.bp { color: #ffb757 } /* Name.Builtin.Pseudo */
.fm { color: #91cbff } /* Name.Function.Magic */
.vc { color: #ffb757 } /* Name.Variable.Class */
.vg { color: #ffb757 } /* Name.Variable.Global */
.vi { color: #ffb757 } /* Name.Variable.Instance */
.vm { color: #ffb757 } /* Name.Variable.Magic */
.il { color: #ffb757 } /* Literal.Number.Integer.Long */
  </style>
  <!-- Load mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe">
  </script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
   init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
  </script>
  <!-- End of mathjax configuration -->
  <script type="module">
   document.addEventListener("DOMContentLoaded", async () => {
    const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs")).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      maxEdges: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue("--jp-ui-font-family"),
      theme: document.querySelector("body[data-jp-theme-light='true']")
        ? "default"
        : "dark",
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement("img");
      const doc = parser.parseFromString(svg, "image/svg+xml");
      const svgEl = doc.querySelector("svg");
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector("title");
      const firstDesc = doc.querySelector("desc");

      img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute("alt", firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement("figcaption");
        caption.className = "sr-only";
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = "";
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement("details");
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement("summary");
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement("pre");
      const code = document.createElement("code");
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement("pre");
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement("div");
      el.style.visibility = "hidden";
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        let { svg } = await mermaid.render(id, raw, el);
        svg = cleanMermaidSvg(svg);
        results = makeMermaidImage(svg);
        output = document.createElement("figure");
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add("jp-mod-warning");
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add("jp-RenderedMermaid");
      parent.appendChild(output);
    }


    /**
     * Post-process to ensure mermaid diagrams contain only valid SVG and XHTML.
     */
    function cleanMermaidSvg(svg) {
      return svg.replace(RE_VOID_ELEMENT, replaceVoidElement);
    }


    /**
     * A regular expression for all void elements, which may include attributes and
     * a slash.
     *
     * @see https://developer.mozilla.org/en-US/docs/Glossary/Void_element
     *
     * Of these, only `<br>` is generated by Mermaid in place of `\n`,
     * but _any_ "malformed" tag will break the SVG rendering entirely.
     */
    const RE_VOID_ELEMENT =
      /<\s*(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)\s*([^>]*?)\s*>/gi;

    /**
     * Ensure a void element is closed with a slash, preserving any attributes.
     */
    function replaceVoidElement(match, tag, rest) {
      rest = rest.trim();
      if (!rest.endsWith('/')) {
        rest = `${rest} /`;
      }
      return `<${tag} ${rest}>`;
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
  </script>
  <style>
   .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details > pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary > pre {
    display: inline-block;
    white-space: normal;
  }
  </style>
  <!-- End of mermaid configuration -->
 </head>
 <body class="wcag-aa">
  <header>
   <a href="#1" id="TOP">
    skip to main content
   </a>
   <br>
   <button accesskey="," aria-controls="nb-settings" onclick="openDialog()">
    settings
   </button>
   <button id="nb-fullscreen" onclick="fullScreen()">
    fullscreen
   </button>
   <p>
    <a aria-description="opens new tab" href="https://github.com/tonyfast" rel="me" style="font-size: bigger;" target="_blank">
     @tonyfast
    </a>
    s notebooks
   </p>
   <details>
    <summary>
     site navigation
    </summary>
    <nav>
     <ol>
      <li>
       <a href="2024-03-05-traceback-figure-tables.ipynb.html">
        using tables to structure tracebacks
       </a>
      </li>
      <li>
       <a href="2024-03-04-semantic-outputs.html">
        improved output semantic for python objects
       </a>
      </li>
      <li>
       <a href="2024-03-01-notebook-accessibility-workshop.html">
        notebooks and accessibility workshop
       </a>
      </li>
      <li>
       <a href="2024-03-01-a11y-list-string.ipynb.html">
        using microdata and semantic html to represent python objects
       </a>
      </li>
      <li>
       <a href="2024-02-28-histograms-sucks.html">
        histograms suck
       </a>
      </li>
      <li>
       <a href="2024-02-26-bash-midgy.html">
        adding shell and css fence directives to midgy
       </a>
      </li>
      <li>
       <a href="2024-02-26-lunr-search.html">
        creating accessible search
       </a>
      </li>
      <li>
       <a href="2024-02-26-multiindex-aria.html">
        adding aria to long or wide tables
       </a>
      </li>
      <li>
       <a href="2024-02-21-build-docs-pd.html">
        build the site docs
       </a>
      </li>
      <li>
       <a href="2024-02-20-multiindex-html.html">
        proper html tables with multiple indexes
       </a>
      </li>
      <li>
       <a href="2024-02-15-pandas-table-names.html">
        a study of pandas dataframes with different levels
       </a>
      </li>
      <li>
       <a href="2024-02-05-aiohttp-pandas-accessor.html">
        adding an http attribrute to pandas series
       </a>
      </li>
      <li>
       <a href="2024-01-25-mast-a11y-notebooks.html">
        transforming mast notebooks into nbconvert templates.
       </a>
      </li>
      <li>
       <a href="2024-01-20-colgroup-schema.html">
        semantic representation of columns based on schema
       </a>
      </li>
      <li>
       <a href="2024-01-05-docx-to-data.html">
        convertin a docx into a structured dataframe
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-12-20-interactive-html-validation.html">
        interactive w3c validation
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-12-15-a11y-testing-dimensions.html">
        slicing and dicing accessibility violations with exception groups
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-12-13-jupyter-community-call.html">
        It's the Community Call Y'all
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-12-08-vnu-validator-exceptions.html">
        generating higher resolution exceptions for the vnu validator
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-12-03-axe-rules-topology.html">
        axe testing codes as dataframes and exceptions
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-11-14-w3c-validator.html">
        running the w3c validator
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-08-24-semantically-meaningful-displays.html">
        semantically meaningful display outputs for notebooks
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-08-23-semantic-lits.html">
        semantically meaningful lists
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-08-10-semantic-code-blocks.html">
        accessibile semantics for python code
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-08-03-pandas-accessors.html">
        pandas accessors
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-07-17-accessible-string-representations.html">
        the string is a samp
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-06-26-dataframe-diagrams-figure-semantics.html">
        a semantic dataframe
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-06-21-v7-aom.html">
        jupyter notebook v7 remediations
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-03-18-ally-talk.html">
        A Crash Course in Digital Accessibility
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-03-18-pycascades-ally-talk.html">
        A Crash Course in Digital Accessibility
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-03-04-computational-notebooks-history.html">
        a sprint through history toward computional notebooks
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-02-28-community-demo.html">
        pidgy literate computing
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-02-19-semantic.html">
        semantic notebook structure
       </a>
      </li>
      <li>
       <a href="2023-02-05-pipings.html">
        pipes are common sugar
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-24-lite-build.html">
        including development builds in jupyter lite
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-24-system-dependency-graphs.html">
        extracting a dependency graph from importlib_metadata
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-24-whoosh-search.html">
        use whoosh to search cells/articles on disk
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-18-voila-pidgy-integration.html">
        cleaner integration of pidgy &amp; voila
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-16-inspector-hack.html">
        customizing the IPython contextual help
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-14-links-in-markdown-tokens.html">
        where do all the good links go?
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-12-giscus-comments.html">
        adding giscus comments to this blog
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-12-tree-sitter.html">
        getting start with tree sitter
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-11-extensible-metadata.html">
        extensible metadata in the notebook format
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-11-duckdb-search.html">
        full text search for notebooks and files using duckdb
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-10-rara-gtfo.html">
        restart and run all or it didn't happen
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-09-notebooks-states.html">
        three states of python in a notebook
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-07-pidgy-voila.html">
        running pidgy in voila
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-04-tfoot-dataframe.html">
        using tfoot in dataframes for more information
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-04-using-diagrams.html">
        diagrams in jupyter and mkdocs
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-02-accessible-dataframes-basic-indexes.html">
        rendering dataframes for screen readers with pandas
       </a>
      </li>
      <li>
       <a href="../xxiii/2023-01-01-strawberry-server.html">
        WIP: strawberry jupyter server
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-31-markdownish-notebook.html">
        a template for exporting markdownish notebooks
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-31-jupyter-config-files.html">
        configuration files
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-30-typer-magic.html">
        using typer in ipython magics
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-23-mkdocs-plugin.html">
        mkdocs plugin for jupyter notebooks
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-22-pyproject-analysis.html">
        analyzing pyproject.toml configurations of popular projects
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-21-lite-build.html">
        jupyterlite blog integration
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-20-pyscript-nbconvert.html">
        rendering a notebook with pyscript
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-19-integrating-typer.html">
        integrating typer into the blog
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-18-mkdocs-task.html">
        doit integration - a mkdocs example
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-17-find-dependencies-in-content.html">
        automating blog posts to work with jupyter-lite
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-16-issue-activity-graphql.html">
        retreiving my issue activity
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-15-html-tags-study.html">
        all the tags i could be using
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-13-github-api-stats.html">
        extracting info from the github statistics api
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-09-pyproject-analysis.html">
        exploring many pyproject.toml configs
       </a>
      </li>
      <li>
       <a href="../xxii/2022-12-05-markdown-to-doctest.html">
        formatting markdown it tokens as python doctests
       </a>
      </li>
      <li>
       <a href="../xxii/2022-11-26-package-mimic-and-rel-imports.html">
        making __main__ a __package__
       </a>
      </li>
      <li>
       <a href="../xxii/2022-11-23-better-dask-shape.html">
        unravel directories of notebooks with dask
       </a>
      </li>
      <li>
       <a href="../xxii/2022-11-17-assignment-expression-display.html">
        using assignment expressions to display and assign in IPython
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-11-17-assignment-expression-display.html">
        using assignment expressions to display and assign in IPython
       </a>
      </li>
      <li>
       <a href="../xxii/2022-11-12-async-import.html">
        asynchronous imports in python
       </a>
      </li>
      <li>
       <a href="../xxii/2022-11-12-pluggy-experiments.html">
        fumbling around with pluggy
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-10-29-metadata-formatter.html">
        inferring linked data from IPython run times.
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-10-27-axe-core-playwright-python.html">
        invoking axe-core from python playwright
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-10-25-static-notebook-tags.html">
        post processing html accessibility
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-10-21-markdown-future.html">
        when markdown and python collide
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-10-21-pidgy-displays.html">
        literate computing - interactive literate programming
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-10-20-meeting-link-widgets.html">
        making meeting links
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-10-19-mobius-text.html">
        turn some text into a mobius surface
       </a>
      </li>
      <li>
       <a href="../../xxii/oct/2022-10-05-dask-search.html">
        searching notebooks
       </a>
      </li>
      <li>
       <a href="../../../xxii/oct/colormap-dataframes/2021-10-11-colorizing.html">
        what do we learn when we make colormaps from dataframes
       </a>
      </li>
     </ol>
    </nav>
   </details>
   <section aria-labelledby="nb-summary-label">
    <details>
     <summary aria-describedby="nb-ct-total nb-cells-label nb-ct-code nb-state nb-ct-loc nb-loc-label
nb-ct-outputs nb-outputs-label" id="nb-summary-label">
      notebook summary
     </summary>
     <button aria-controls="nb-metadata" onclick="openDialog()">
      show metadata
     </button>
     <dl aria-labelledby="nb-summary-label">
      <dt>
       title
      </dt>
      <dd id="nb-title">
       convertin a docx into a structured dataframe
      </dd>
      <dt>
       description
      </dt>
      <dd id>
       this feature engineering task transforms a docx to tidy data.
it can eventually be exported as notebooks.
      </dd>
      <dt>
       cells
      </dt>
      <dd id="nb-ct-total">
       15 total
      </dd>
      <dd id="nb-ct-code">
       9 code
      </dd>
      <dd>
      </dd>
      <dt>
       state
      </dt>
      <dd id="nb-state">
       executed in order
      </dd>
      <dt>
       language
      </dt>
      <dd id="nb-lang">
       python
      </dd>
      <dt id="nb-loc-label">
       lines of code
      </dt>
      <dd id="nb-ct-loc">
       46
      </dd>
      <dt>
       outputs
      </dt>
      <dd id="nb-ct-outputs">
       11
      </dd>
     </dl>
    </details>
   </section>
   <section aria-labelledby="nb-toc">
    <details open>
     <summary id="toc">
      <span id="nb-toc">
       table of contents
      </span>
     </summary>
     <a id="nb-toc-start">
     </a>
     <nav>
      <ol>
       <li>
        <a href="#None">
         convertin a docx into a structured dataframe
        </a>
       </li>
       <li>
        <ol>
         <li>
          <a href="#ellingham-diagram-and-buffered-systems">
           Ellingham diagram and buffered systems
          </a>
         </li>
         <li>
          <a href="#internal-process-and-differential-and-integrated-driving-forces">
           Internal process and differential and integrated driving forces
          </a>
         </li>
         <li>
          <a href="#maximum-reaction-rate-and-chemical-transport-reactions">
           Maximum reaction rate and chemical transport reactions
          </a>
         </li>
         <li>
          <a href="#trends-of-entropies-of-reactions">
           Trends of entropies of reactions
          </a>
         </li>
         <li>
          <a href="#aqueous-solution-and-pourbaix-diagram">
           Aqueous solution and Pourbaix diagram
          </a>
         </li>
         <li>
          <a href="#concentrations-activities-and-reference-states-of-electrolyte-species">
           Concentrations, activities, and reference states of electrolyte species
          </a>
         </li>
         <li>
          <ol>
           <li>
            <a href="#None">
             Electrical batteries
            </a>
           </li>
          </ol>
         </li>
         <li>
          <a href="#electrolyte-reactions-and-electrochemical-reactions">
           Electrolyte reactions and electrochemical reactions
          </a>
         </li>
         <li>
          <a href="#None">
           Fuel cells
          </a>
         </li>
         <li>
          <a href="#None">
           Half cell potentials
          </a>
         </li>
        </ol>
       </li>
      </ol>
     </nav>
    </details>
   </section>
   <dialog id="nb-metadata">
    <form method="dialog">
     <button formmethod="dialog">
      Close
     </button>
     {"kernelspec": {"display_name": "Python [conda env:p311] *", "language": "python", "name": "conda-env-p311-py"}, "language_info": {"codemirror_mode": {"name": "ipython", "version": 3}, "file_extension": ".py", "mimetype": "text/x-python", "name": "python", "nbconvert_exporter": "python", "pygments_lexer": "ipython3", "version": "3.11.3"}, "widgets": {"application/vnd.jupyter.widget-state+json": {"state": {}, "version_major": 2, "version_minor": 0}}, "title": "convertin a docx into a structured dataframe", "description": "this feature engineering task transforms a docx to tidy data.\nit can eventually be exported as notebooks."}
    </form>
   </dialog>
  </header>
  <main>
   <table id="cells" role="none">
    <colgroup>
     <col class="nb-index">
     <col class="nb-execution_count">
     <col class="nb-cell_type">
     <col class="nb-toolbar">
     <col class="nb-started_at">
     <col class="nb-completed_at">
     <col class="nb-source">
     <col class="nb-loc">
     <col class="nb-metadata">
     <col class="nb-outputs">
    </colgroup>
    <tbody aria-labelledby="nb-notebook-label nb-cells-label" role="list">
     <tr hidden role="listitem">
      <th role="none" scope="col">
       index
      </th>
      <th role="none" scope="col">
       execution_count
      </th>
      <th role="none" scope="col">
       cell_type
      </th>
      <th role="none" scope="col">
       toolbar
      </th>
      <th role="none" scope="col">
       started_at
      </th>
      <th role="none" scope="col">
       completed_at
      </th>
      <th role="none" scope="col">
       source
      </th>
      <th role="none" scope="col">
       loc
      </th>
      <th role="none" scope="col">
       metadata
      </th>
      <th role="none" scope="col">
       outputs
      </th>
     </tr>
     <tr aria-labelledby="nb-cell-label 1 cell-1-cell_type" class="cell markdown" data-index="1" data-loc="9" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="1" aria-describedby="nb-markdown-label nb-cell-label " aria-labelledby="nb-cell-label 1" class="nb-anchor visually-hidden" href="#1" id="1">
        1
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-1-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-1-exec-label">
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-1-cell_type">
        markdown
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-1-exec-label" class="nb-toolbar" hidden id="cell-1" name="cell-1">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-1-start" role="none">
      </td>
      <td class="nb-end" hidden id="cell-1-end" role="none">
      </td>
      <td class="nb-source" hidden role="none">
       <textarea aria-labelledby="cell-1-in-label cell-1-exec-label nb-source-label" class="nb-source" form="cell-1" id="cell-1-source" name="source" readonly rows="9"># convertin a docx into a structured dataframe

this feature engineering task transforms a docx to tidy data.
it can eventually be exported as notebooks.

this work is important because we when open existing course content 
we want to avoid redundant work. spending &lt;1 week to feature engineer
existing content into structured notebooks is a reasonable time line.
developers become familiar with the content through this data engineering activity.: typing.Sequence[docx.Type]</textarea>
       <div aria-labelledby="cell-1-in-label cell-1-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code><span class="gh"># convertin a docx into a structured dataframe</span>

this feature engineering task transforms a docx to tidy data.
it can eventually be exported as notebooks.

this work is important because we when open existing course content 
we want to avoid redundant work. spending &lt;1 week to feature engineer
existing content into structured notebooks is a reasonable time line.
developers become familiar with the content through this data engineering activity.: typing.Sequence[docx.Type]
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-1-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-1" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-1-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'data': {'text/html': '<h1><a href="#convertin-a-docx-into-a-structured-dataframe">convertin a docx into a structured dataframe</a></h1>\n<p>this feature engineering task transforms a docx to tidy data.\nit can eventually be exported as notebooks.</p>\n<p>this work is important because we when open existing course content\nwe want to avoid redundant work. spending &lt;1 week to feature engineer\nexisting content into structured notebooks is a reasonable time line.\ndevelopers become familiar with the content through this data engineering activity.: typing.Sequence[docx.Type]</p>\n'}}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-1-loc" role="none">
       9
      </td>
      <td class="nb-outputs" role="none">
       <h1>
        <a href="#convertin-a-docx-into-a-structured-dataframe">
         convertin a docx into a structured dataframe
        </a>
       </h1>
       <p>
        this feature engineering task transforms a docx to tidy data.
it can eventually be exported as notebooks.
       </p>
       <p>
        this work is important because we when open existing course content
we want to avoid redundant work. spending &lt;1 week to feature engineer
existing content into structured notebooks is a reasonable time line.
developers become familiar with the content through this data engineering activity.: typing.Sequence[docx.Type]
       </p>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 2 cell-2-cell_type" class="cell code" data-index="2" data-loc="4" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="2" aria-describedby="nb-code-label nb-cell-label cell-2-loc nb-loc-label
    cell-2-outputs-len" aria-labelledby="nb-cell-label 2" class="nb-anchor visually-hidden" href="#2" id="2">
        2
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-2-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-2-exec-label">
         1
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-2-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-2-exec-label" class="nb-toolbar" hidden id="cell-2" name="cell-2">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-2-start" role="none">
       <time datetime="2024-01-06T04:45:51.374+00:00">
        2024-01-06T04:45:51.374743+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-2-end" role="none">
       <time datetime="2024-01-06T04:45:51.632+00:00">
        2024-01-06T04:45:51.632471+00:00
       </time>
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-2-in-label cell-2-exec-label nb-source-label" class="nb-source" form="cell-2" id="cell-2-source" name="source" readonly rows="4">    import docx, itertools, pandas, tempfile, shutil, typing, asyncio, subprocess
    from IPython.display import Markdown, display; from toolz.curried import *
    g = compose_left
    PANDOC = shutil.which("pandoc")</textarea>
       <div aria-labelledby="cell-2-in-label cell-2-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>    <span class="kn">import</span> <span class="nn">docx</span><span class="o">,</span> <span class="nn">itertools</span><span class="o">,</span> <span class="nn">pandas</span><span class="o">,</span> <span class="nn">tempfile</span><span class="o">,</span> <span class="nn">shutil</span><span class="o">,</span> <span class="nn">typing</span><span class="o">,</span> <span class="nn">asyncio</span><span class="o">,</span> <span class="nn">subprocess</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">display</span><span class="p">;</span> <span class="kn">from</span> <span class="nn">toolz.curried</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">compose_left</span>
    <span class="n">PANDOC</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s2">"pandoc"</span><span class="p">)</span>
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-2-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-2" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-2-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:45:51.374743Z', 'iopub.status.busy': '2024-01-06T04:45:51.374661Z', 'iopub.status.idle': '2024-01-06T04:45:51.632939Z', 'shell.execute_reply': '2024-01-06T04:45:51.632471Z', 'shell.execute_reply.started': '2024-01-06T04:45:51.374733Z'}, 'tags': []}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-2-loc" role="none">
       4
      </td>
      <td class="nb-outputs" hidden role="none">
       <span class="nb-outputs visually-hidden" id="cell-2-outputs-len">
        0 outputs.
       </span>
       <fieldset class="nb-outputs" data-outputs="0">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-2-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          1
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
       </fieldset>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 3 cell-3-cell_type" class="cell code" data-index="3" data-loc="1" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="3" aria-describedby="nb-code-label nb-cell-label cell-3-loc nb-loc-label
    cell-3-outputs-len" aria-labelledby="nb-cell-label 3" class="nb-anchor visually-hidden" href="#3" id="3">
        3
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-3-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-3-exec-label">
         2
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-3-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-3-exec-label" class="nb-toolbar" hidden id="cell-3" name="cell-3">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-3-start" role="none">
       <time datetime="2024-01-06T04:45:51.633+00:00">
        2024-01-06T04:45:51.633860+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-3-end" role="none">
       <time datetime="2024-01-06T04:45:51.758+00:00">
        2024-01-06T04:45:51.758683+00:00
       </time>
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-3-in-label cell-3-exec-label nb-source-label" class="nb-source" form="cell-3" id="cell-3-source" name="source" readonly rows="1">    document = docx.Document("/home/tbone/Downloads/2015-07-15-Textbook-Cambridge-U-P.docx")</textarea>
       <div aria-labelledby="cell-3-in-label cell-3-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>    <span class="n">document</span> <span class="o">=</span> <span class="n">docx</span><span class="o">.</span><span class="n">Document</span><span class="p">(</span><span class="s2">"/home/tbone/Downloads/2015-07-15-Textbook-Cambridge-U-P.docx"</span><span class="p">)</span>
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-3-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-3" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-3-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:45:51.633860Z', 'iopub.status.busy': '2024-01-06T04:45:51.633680Z', 'iopub.status.idle': '2024-01-06T04:45:51.759093Z', 'shell.execute_reply': '2024-01-06T04:45:51.758683Z', 'shell.execute_reply.started': '2024-01-06T04:45:51.633845Z'}, 'tags': []}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-3-loc" role="none">
       1
      </td>
      <td class="nb-outputs" hidden role="none">
       <span class="nb-outputs visually-hidden" id="cell-3-outputs-len">
        0 outputs.
       </span>
       <fieldset class="nb-outputs" data-outputs="0">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-3-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          2
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
       </fieldset>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 4 cell-4-cell_type" class="cell markdown" data-index="4" data-loc="1" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="4" aria-describedby="nb-markdown-label nb-cell-label " aria-labelledby="nb-cell-label 4" class="nb-anchor visually-hidden" href="#4" id="4">
        4
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-4-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-4-exec-label">
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-4-cell_type">
        markdown
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-4-exec-label" class="nb-toolbar" hidden id="cell-4" name="cell-4">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-4-start" role="none">
       <time datetime="2024-01-06T04:44:46.234+00:00">
        2024-01-06T04:44:46.234364+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-4-end" role="none">
       <time datetime="2024-01-06T04:44:46.237+00:00">
        2024-01-06T04:44:46.237652+00:00
       </time>
      </td>
      <td class="nb-source" hidden role="none">
       <textarea aria-labelledby="cell-4-in-label cell-4-exec-label nb-source-label" class="nb-source" form="cell-4" id="cell-4-source" name="source" readonly rows="1">the snippet discovers the style id's of each paragraph. this means we could remediate the the headings here and make them formal headings</textarea>
       <div aria-labelledby="cell-4-in-label cell-4-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>the snippet discovers the style id's of each paragraph. this means we could remediate the the headings here and make them formal headings
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-4-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-4" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-4-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:44:46.234364Z', 'iopub.status.busy': '2024-01-06T04:44:46.234086Z', 'iopub.status.idle': '2024-01-06T04:44:46.238225Z', 'shell.execute_reply': '2024-01-06T04:44:46.237652Z', 'shell.execute_reply.started': '2024-01-06T04:44:46.234339Z'}, 'tags': [], 'data': {'text/html': "<p>the snippet discovers the style id's of each paragraph. this means we could remediate the the headings here and make them formal headings</p>\n"}}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-4-loc" role="none">
       1
      </td>
      <td class="nb-outputs" role="none">
       <p>
        the snippet discovers the style id's of each paragraph. this means we could remediate the the headings here and make them formal headings
       </p>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 5 cell-5-cell_type" class="cell code" data-index="5" data-loc="7" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="5" aria-describedby="nb-code-label nb-cell-label cell-5-loc nb-loc-label
    cell-5-outputs-len" aria-labelledby="nb-cell-label 5" class="nb-anchor visually-hidden" href="#5" id="5">
        5
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-5-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-5-exec-label">
         3
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-5-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-5-exec-label" class="nb-toolbar" hidden id="cell-5" name="cell-5">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-5-start" role="none">
       <time datetime="2024-01-06T04:45:51.759+00:00">
        2024-01-06T04:45:51.759587+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-5-end" role="none">
       <time datetime="2024-01-06T04:45:52.408+00:00">
        2024-01-06T04:45:52.408481+00:00
       </time>
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-5-in-label cell-5-exec-label nb-source-label" class="nb-source" form="cell-5" id="cell-5-source" name="source" readonly rows="7">    paragraphs = pandas.Series(document.iter_inner_content())
    df = paragraphs.to_frame("p").join(
        paragraphs.apply(
            g(operator.attrgetter("style"), operator.attrgetter("style_id"))
        ).rename("style_id")
    )
    </textarea>
       <div aria-labelledby="cell-5-in-label cell-5-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>    <span class="n">paragraphs</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">iter_inner_content</span><span class="p">())</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">paragraphs</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s2">"p"</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">paragraphs</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">g</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">"style"</span><span class="p">),</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">"style_id"</span><span class="p">))</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">"style_id"</span><span class="p">)</span>
    <span class="p">)</span>
    
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-5-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-5" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-5-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:45:51.759587Z', 'iopub.status.busy': '2024-01-06T04:45:51.759480Z', 'iopub.status.idle': '2024-01-06T04:45:52.408896Z', 'shell.execute_reply': '2024-01-06T04:45:52.408481Z', 'shell.execute_reply.started': '2024-01-06T04:45:51.759577Z'}, 'tags': []}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-5-loc" role="none">
       7
      </td>
      <td class="nb-outputs" hidden role="none">
       <span class="nb-outputs visually-hidden" id="cell-5-outputs-len">
        0 outputs.
       </span>
       <fieldset class="nb-outputs" data-outputs="0">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-5-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          3
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
       </fieldset>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 6 cell-6-cell_type" class="cell code" data-index="6" data-loc="2" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="6" aria-describedby="nb-code-label nb-cell-label cell-6-loc nb-loc-label
    cell-6-outputs-len" aria-labelledby="nb-cell-label 6" class="nb-anchor visually-hidden" href="#6" id="6">
        6
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-6-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-6-exec-label">
         4
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-6-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-6-exec-label" class="nb-toolbar" hidden id="cell-6" name="cell-6">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-6-start" role="none">
       <time datetime="2024-01-06T04:45:52.409+00:00">
        2024-01-06T04:45:52.409453+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-6-end" role="none">
       <time datetime="2024-01-06T04:45:52.412+00:00">
        2024-01-06T04:45:52.412904+00:00
       </time>
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-6-in-label cell-6-exec-label nb-source-label" class="nb-source" form="cell-6" id="cell-6-source" name="source" readonly rows="2">    end_of_toc = df.style_id.str.match("^TOC").pipe(lambda x: x[x]).index[-1] + 1
    toc, df, refs = df.iloc[:end_of_toc], df.iloc[end_of_toc:], df.iloc[-1:]</textarea>
       <div aria-labelledby="cell-6-in-label cell-6-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>    <span class="n">end_of_toc</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">style_id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"^TOC"</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">toc</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">refs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">end_of_toc</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">end_of_toc</span><span class="p">:],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-6-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-6" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-6-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:45:52.409453Z', 'iopub.status.busy': '2024-01-06T04:45:52.409353Z', 'iopub.status.idle': '2024-01-06T04:45:52.413256Z', 'shell.execute_reply': '2024-01-06T04:45:52.412904Z', 'shell.execute_reply.started': '2024-01-06T04:45:52.409443Z'}, 'tags': []}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-6-loc" role="none">
       2
      </td>
      <td class="nb-outputs" hidden role="none">
       <span class="nb-outputs visually-hidden" id="cell-6-outputs-len">
        0 outputs.
       </span>
       <fieldset class="nb-outputs" data-outputs="0">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-6-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          4
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
       </fieldset>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 7 cell-7-cell_type" class="cell code" data-index="7" data-loc="10" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="7" aria-describedby="nb-code-label nb-cell-label cell-7-loc nb-loc-label
    cell-7-outputs-len" aria-labelledby="nb-cell-label 7" class="nb-anchor visually-hidden" href="#7" id="7">
        7
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-7-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-7-exec-label">
         5
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-7-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-7-exec-label" class="nb-toolbar" hidden id="cell-7" name="cell-7">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-7-start" role="none">
       <time datetime="2024-01-06T04:45:52.413+00:00">
        2024-01-06T04:45:52.413783+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-7-end" role="none">
       <time datetime="2024-01-06T04:45:52.425+00:00">
        2024-01-06T04:45:52.425385+00:00
       </time>
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-7-in-label cell-7-exec-label nb-source-label" class="nb-source" form="cell-7" id="cell-7-source" name="source" readonly rows="10">    def get_docx_subset(elements: typing.Sequence[docx.Type]) -&gt; docx.document.Document:
        """create a new docx object with a subset of elements from an original"""
        (new := docx.Document())._body._element.extend(x._element for x in elements)
        return new
    
    async def get_docx_subset_markdown(elements: typing.Sequence[docx.Type]) -&gt; str:
        """shell out to pandoc to convert the docx elements to markdown"""
        tmp = tempfile.NamedTemporaryFile(suffix=".docx")
        get_docx_subset(elements).save(tmp.name)
        return subprocess.check_output([PANDOC, "--to", "gfm", "--from", "docx", tmp.name]).decode()</textarea>
       <div aria-labelledby="cell-7-in-label cell-7-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>    <span class="k">def</span> <span class="nf">get_docx_subset</span><span class="p">(</span><span class="n">elements</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">docx</span><span class="o">.</span><span class="n">Type</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">docx</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">Document</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""create a new docx object with a subset of elements from an original"""</span>
        <span class="p">(</span><span class="n">new</span> <span class="o">:=</span> <span class="n">docx</span><span class="o">.</span><span class="n">Document</span><span class="p">())</span><span class="o">.</span><span class="n">_body</span><span class="o">.</span><span class="n">_element</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">_element</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_docx_subset_markdown</span><span class="p">(</span><span class="n">elements</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">docx</span><span class="o">.</span><span class="n">Type</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""shell out to pandoc to convert the docx elements to markdown"""</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">".docx"</span><span class="p">)</span>
        <span class="n">get_docx_subset</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">([</span><span class="n">PANDOC</span><span class="p">,</span> <span class="s2">"--to"</span><span class="p">,</span> <span class="s2">"gfm"</span><span class="p">,</span> <span class="s2">"--from"</span><span class="p">,</span> <span class="s2">"docx"</span><span class="p">,</span> <span class="n">tmp</span><span class="o">.</span><span class="n">name</span><span class="p">])</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-7-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-7" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-7-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:45:52.413783Z', 'iopub.status.busy': '2024-01-06T04:45:52.413669Z', 'iopub.status.idle': '2024-01-06T04:45:52.425766Z', 'shell.execute_reply': '2024-01-06T04:45:52.425385Z', 'shell.execute_reply.started': '2024-01-06T04:45:52.413773Z'}, 'tags': []}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-7-loc" role="none">
       10
      </td>
      <td class="nb-outputs" hidden role="none">
       <span class="nb-outputs visually-hidden" id="cell-7-outputs-len">
        0 outputs.
       </span>
       <fieldset class="nb-outputs" data-outputs="0">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-7-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          5
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
       </fieldset>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 8 cell-8-cell_type" class="cell markdown" data-index="8" data-loc="1" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="8" aria-describedby="nb-markdown-label nb-cell-label " aria-labelledby="nb-cell-label 8" class="nb-anchor visually-hidden" href="#8" id="8">
        8
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-8-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-8-exec-label">
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-8-cell_type">
        markdown
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-8-exec-label" class="nb-toolbar" hidden id="cell-8" name="cell-8">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-8-start" role="none">
      </td>
      <td class="nb-end" hidden id="cell-8-end" role="none">
      </td>
      <td class="nb-source" hidden role="none">
       <textarea aria-labelledby="cell-8-in-label cell-8-exec-label nb-source-label" class="nb-source" form="cell-8" id="cell-8-source" name="source" readonly rows="1">define chapters by the 10 h1s we found and the nearest heading to identify notebooks.</textarea>
       <div aria-labelledby="cell-8-in-label cell-8-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>define chapters by the 10 h1s we found and the nearest heading to identify notebooks.
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-8-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-8" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-8-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'data': {'text/html': '<p>define chapters by the 10 h1s we found and the nearest heading to identify notebooks.</p>\n'}}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-8-loc" role="none">
       1
      </td>
      <td class="nb-outputs" role="none">
       <p>
        define chapters by the 10 h1s we found and the nearest heading to identify notebooks.
       </p>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 9 cell-9-cell_type" class="cell code" data-index="9" data-loc="5" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a accesskey="9" aria-describedby="nb-code-label nb-cell-label cell-9-loc nb-loc-label
    cell-9-outputs-len" aria-labelledby="nb-cell-label 9" class="nb-anchor visually-hidden" href="#9" id="9">
        9
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-9-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-9-exec-label">
         6
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-9-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-9-exec-label" class="nb-toolbar" hidden id="cell-9" name="cell-9">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-9-start" role="none">
       <time datetime="2024-01-06T04:45:52.426+00:00">
        2024-01-06T04:45:52.426452+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-9-end" role="none">
       <time datetime="2024-01-06T04:45:52.445+00:00">
        2024-01-06T04:45:52.445108+00:00
       </time>
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-9-in-label cell-9-exec-label nb-source-label" class="nb-source" form="cell-9" id="cell-9-source" name="source" readonly rows="5">    notebooks = df.join(
        df[df.style_id.str.match("^Heading1")].p.apply(operator.attrgetter("text")).rename("chapter")
    ).join(
        df[df.style_id.str.match("^Heading")].p.apply(operator.attrgetter("text")).rename("notebook")
    ).ffill().fillna("empty").groupby(["chapter", "notebook"])</textarea>
       <div aria-labelledby="cell-9-in-label cell-9-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>    <span class="n">notebooks</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">style_id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"^Heading1"</span><span class="p">)]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">"text"</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">"chapter"</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">style_id</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"^Heading"</span><span class="p">)]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">"text"</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">"notebook"</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">"empty"</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">"chapter"</span><span class="p">,</span> <span class="s2">"notebook"</span><span class="p">])</span>
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-9-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-9" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-9-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:45:52.426452Z', 'iopub.status.busy': '2024-01-06T04:45:52.426293Z', 'iopub.status.idle': '2024-01-06T04:45:52.445444Z', 'shell.execute_reply': '2024-01-06T04:45:52.445108Z', 'shell.execute_reply.started': '2024-01-06T04:45:52.426439Z'}, 'tags': []}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-9-loc" role="none">
       5
      </td>
      <td class="nb-outputs" hidden role="none">
       <span class="nb-outputs visually-hidden" id="cell-9-outputs-len">
        0 outputs.
       </span>
       <fieldset class="nb-outputs" data-outputs="0">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-9-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          6
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
       </fieldset>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 10 cell-10-cell_type" class="cell markdown" data-index="10" data-loc="1" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a aria-describedby="nb-markdown-label nb-cell-label " aria-labelledby="nb-cell-label 10" class="nb-anchor visually-hidden" href="#10" id="10">
        10
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-10-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-10-exec-label">
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-10-cell_type">
        markdown
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-10-exec-label" class="nb-toolbar" hidden id="cell-10" name="cell-10">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-10-start" role="none">
      </td>
      <td class="nb-end" hidden id="cell-10-end" role="none">
      </td>
      <td class="nb-source" hidden role="none">
       <textarea aria-labelledby="cell-10-in-label cell-10-exec-label nb-source-label" class="nb-source" form="cell-10" id="cell-10-source" name="source" readonly rows="1">turned the grouped notebooks to markdown</textarea>
       <div aria-labelledby="cell-10-in-label cell-10-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>turned the grouped notebooks to markdown
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-10-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-10" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-10-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'data': {'text/html': '<p>turned the grouped notebooks to markdown</p>\n'}}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-10-loc" role="none">
       1
      </td>
      <td class="nb-outputs" role="none">
       <p>
        turned the grouped notebooks to markdown
       </p>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 11 cell-11-cell_type" class="cell code" data-index="11" data-loc="4" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a aria-describedby="nb-code-label nb-cell-label cell-11-loc nb-loc-label
    cell-11-outputs-len" aria-labelledby="nb-cell-label 11" class="nb-anchor visually-hidden" href="#11" id="11">
        11
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-11-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-11-exec-label">
         7
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-11-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-11-exec-label" class="nb-toolbar" hidden id="cell-11" name="cell-11">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-11-start" role="none">
       <time datetime="2024-01-06T04:45:52.446+00:00">
        2024-01-06T04:45:52.446340+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-11-end" role="none">
       <time datetime="2024-01-06T04:46:05.370+00:00">
        2024-01-06T04:46:05.370877+00:00
       </time>
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-11-in-label cell-11-exec-label nb-source-label" class="nb-source" form="cell-11" id="cell-11-source" name="source" readonly rows="4">    (md := pandas.Series(
        await asyncio.gather(*(get_docx_subset_markdown(notebooks.get_group(x).p) for x in notebooks.groups)),
        notebooks.groups
    ).to_frame("markdown"))</textarea>
       <div aria-labelledby="cell-11-in-label cell-11-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>    <span class="p">(</span><span class="n">md</span> <span class="o">:=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">get_docx_subset_markdown</span><span class="p">(</span><span class="n">notebooks</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">notebooks</span><span class="o">.</span><span class="n">groups</span><span class="p">)),</span>
        <span class="n">notebooks</span><span class="o">.</span><span class="n">groups</span>
    <span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s2">"markdown"</span><span class="p">))</span>
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-11-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-11" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-11-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:45:52.446340Z', 'iopub.status.busy': '2024-01-06T04:45:52.446197Z', 'iopub.status.idle': '2024-01-06T04:46:05.371383Z', 'shell.execute_reply': '2024-01-06T04:46:05.370877Z', 'shell.execute_reply.started': '2024-01-06T04:45:52.446329Z'}, 'tags': []}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-11-loc" role="none">
       4
      </td>
      <td class="nb-outputs" role="none">
       <span class="nb-outputs visually-hidden" id="cell-11-outputs-len">
        1 outputs.
       </span>
       <fieldset class="nb-outputs" data-outputs="1">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-11-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          7
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
        <div>
         <style scoped>
          .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
         </style>
         <table border="1" class="dataframe">
          <thead>
           <tr style="text-align: right;">
            <th>
            </th>
            <th>
            </th>
            <th>
             markdown
            </th>
           </tr>
          </thead>
          <tbody>
           <tr>
            <th rowspan="5" valign="top">
             Applications to chemical reactions
            </th>
            <th>
             Applications to chemical reactions
            </th>
            <td>
             # Applications to chemical reactions\n\nA chem...
            </td>
           </tr>
           <tr>
            <th>
             Ellingham diagram and buffered systems
            </th>
            <td>
             ## Ellingham diagram and buffered systems\n\nO...
            </td>
           </tr>
           <tr>
            <th>
             Internal process and differential and integrated driving forces
            </th>
            <td>
             ## Internal process and differential and integ...
            </td>
           </tr>
           <tr>
            <th>
             Maximum reaction rate and chemical transport reactions
            </th>
            <td>
             ## Maximum reaction rate and chemical transpor...
            </td>
           </tr>
           <tr>
            <th>
             Trends of entropies of reactions
            </th>
            <td>
             ## Trends of entropies of reactions\n\nThe rea...
            </td>
           </tr>
           <tr>
            <th>
             ...
            </th>
            <th>
             ...
            </th>
            <td>
             ...
            </td>
           </tr>
           <tr>
            <th rowspan="3" valign="top">
             Phase equilibria in heterogeneous systems
            </th>
            <th>
             Projection and section of phase diagrams with potential and molar quantities
            </th>
            <td>
             ### Projection and section of phase diagrams w...
            </td>
           </tr>
           <tr>
            <th>
             Section of potential phase diagrams
            </th>
            <td>
             ### Section of potential phase diagrams\n\nBas...
            </td>
           </tr>
           <tr>
            <th>
             Tie-lines and lever rule
            </th>
            <td>
             ### Tie-lines and lever rule\n\nIt is self-evi...
            </td>
           </tr>
           <tr>
            <th>
             References
            </th>
            <th>
             References
            </th>
            <td>
             # References\n\n1\. M. Hillert, *Phase Equilib...
            </td>
           </tr>
           <tr>
            <th>
             empty
            </th>
            <th>
             empty
            </th>
            <td>
             Thermodynamics is a science concerning the sta...
            </td>
           </tr>
          </tbody>
         </table>
         <p>
          97 rows &times; 1 columns
         </p>
        </div>
       </fieldset>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 12 cell-12-cell_type" class="cell markdown" data-index="12" data-loc="1" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a aria-describedby="nb-markdown-label nb-cell-label " aria-labelledby="nb-cell-label 12" class="nb-anchor visually-hidden" href="#12" id="12">
        12
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-12-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-12-exec-label">
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-12-cell_type">
        markdown
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-12-exec-label" class="nb-toolbar" hidden id="cell-12" name="cell-12">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-12-start" role="none">
      </td>
      <td class="nb-end" hidden id="cell-12-end" role="none">
      </td>
      <td class="nb-source" hidden role="none">
       <textarea aria-labelledby="cell-12-in-label cell-12-exec-label nb-source-label" class="nb-source" form="cell-12" id="cell-12-source" name="source" readonly rows="1">below we see that most of this transformation renders pretty ok on notebooks</textarea>
       <div aria-labelledby="cell-12-in-label cell-12-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>below we see that most of this transformation renders pretty ok on notebooks
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-12-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-12" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-12-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'data': {'text/html': '<p>below we see that most of this transformation renders pretty ok on notebooks</p>\n'}}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-12-loc" role="none">
       1
      </td>
      <td class="nb-outputs" role="none">
       <p>
        below we see that most of this transformation renders pretty ok on notebooks
       </p>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 13 cell-13-cell_type" class="cell code" data-index="13" data-loc="1" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a aria-describedby="nb-code-label nb-cell-label cell-13-loc nb-loc-label
    cell-13-outputs-len" aria-labelledby="nb-cell-label 13" class="nb-anchor visually-hidden" href="#13" id="13">
        13
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-13-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-13-exec-label">
         8
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-13-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-13-exec-label" class="nb-toolbar" hidden id="cell-13" name="cell-13">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-13-start" role="none">
       <time datetime="2024-01-06T04:46:05.372+00:00">
        2024-01-06T04:46:05.372702+00:00
       </time>
      </td>
      <td class="nb-end" hidden id="cell-13-end" role="none">
       <time datetime="2024-01-06T04:46:05.384+00:00">
        2024-01-06T04:46:05.384363+00:00
       </time>
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-13-in-label cell-13-exec-label nb-source-label" class="nb-source" form="cell-13" id="cell-13-source" name="source" readonly rows="1">    display(*md[md.markdown.str.contains("\$")].iloc[:10].markdown.apply(Markdown))</textarea>
       <div aria-labelledby="cell-13-in-label cell-13-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>    <span class="n">display</span><span class="p">(</span><span class="o">*</span><span class="n">md</span><span class="p">[</span><span class="n">md</span><span class="o">.</span><span class="n">markdown</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"\$"</span><span class="p">)]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">markdown</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Markdown</span><span class="p">))</span>
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-13-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-13" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-13-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'execution': {'iopub.execute_input': '2024-01-06T04:46:05.372702Z', 'iopub.status.busy': '2024-01-06T04:46:05.372146Z', 'iopub.status.idle': '2024-01-06T04:46:05.384615Z', 'shell.execute_reply': '2024-01-06T04:46:05.384363Z', 'shell.execute_reply.started': '2024-01-06T04:46:05.372676Z'}, 'tags': []}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-13-loc" role="none">
       1
      </td>
      <td class="nb-outputs" role="none">
       <span class="nb-outputs visually-hidden" id="cell-13-outputs-len">
        10 outputs.
       </span>
       <fieldset class="nb-outputs" data-outputs="10">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-13-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          8
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
        <h2 id="ellingham-diagram-and-buffered-systems">
         <a href="#ellingham-diagram-and-buffered-systems">
          Ellingham diagram and buffered systems
         </a>
        </h2>
        <p>
         One type of chemical reactions is between a pure element in liquid or
solid states and its oxides involving one mole of oxygen gas, i.e.
        </p>
        <p>
         <em>
          Eq. 77
         </em>
         $\frac{4}{v_{M}}M + O_{2}(gas) = M_{4/v_{M}}O_{2}$
        </p>
        <p>
         with $v_{M}$ being the valence of the element $M$ in the oxide. Taking
the pure $M$ and the gaseous $O_{2}$ at the reaction temperature and one
atmospheric pressure as their respective reference states, both
activities of the pure $M$ solid or liquid phase and its oxide are
unity, and the activity of $O_{2}$ equals to its partial pressure in an
ideal gas. becomes
        </p>
        <p>
         <em>
          Eq. 78
         </em>
         $RTlnP_{O_{2}} = \mathrm{\Delta}
         <em>
          {\ }^{0}G = \mathrm{\Delta}
         </em>
         {\ }^{0}H - T\mathrm{\Delta}_{\ }^{0}S$
        </p>
        <p>
         Based on , one can plot $\mathrm{\Delta}
         <em>
          {\ }^{0}G$ as a function of
temperature for various oxidation reactions, which is called Ellingham
diagram. The intercept at $T = 0K$ is given by
$\mathrm{\Delta}
         </em>
         {\ }^{0}H$, and the slope is represented by
$- \mathrm{\Delta}_{\ }^{0}S$, depicted by the following equation
        </p>
        <p>
         <em>
          Eq. 79
         </em>
         $\mathrm{\Delta}
         <em>
          {\ }^{0}S = S
         </em>
         {M_{4/v_{M}}O_{2}} - S_{O_{2}} - \frac{4}{v_{M}}S_{M}$
        </p>
        <p>
         Since the entropy of one mole of $O_{2}$ gas is significantly larger
than those of the pure element and its oxide when they are in solid or
liquid states and the entropy difference between the pure element and
its oxide, the entropy of reaction is thus dominated by the reduction of
the entropy by one mole of $O_{2}$ gas. Consequently, the entropies of
reaction are approximately the same for most reactions when the pure
elements and their oxides are solid as seen in where most lines have
similar slopes.
        </p>
        <p>
         Figure : Ellingham Diagram for a number of metal-oxide systems.
        </p>
        <p>
         For a chemical reaction on the Ellingham diagram at a given temperature,
$\mathrm{\Delta}
         <em>
          {\ }^{0}G$ can be read from the y-axis of the diagram,
and the equilibrium partial pressure of $O
         </em>
         {2}$ gas can be calculated
using . Alternatively, one can plot the left part of for a given
$P_{O_{2}}$ as a function of temperature on the Ellingham diagram, i.e.
        </p>
        <p>
         <em>
          Eq. 710
         </em>
         $\mathrm{\Delta}
         <em>
          {\ }^{0}{G =}RTlnP
         </em>
         {O_{2}}$
        </p>
        <p>
         This results in straight lines, representing iso-partial-pressure lines
of $O_{2}$, with the intercept being zero at $T = 0K$ and slopes of
$RlnP_{O_{2}}$, which are negative for $P_{O_{2}}$ lower than one
atmospheric pressure (1atm). The values of $P_{O_{2}}$ are marked on the
secondary axis on the right of the Ellingham diagram. The intersection
of the isoactivitiy line and the equilibrium line of the chemical
reaction thus gives the relation of equilibrium temperature and
equilibrium partial pressure of $O_{2}$. This is demonstrated in .
        </p>
        <p>
         Figure : Intersection of iso-partial-pressure lines of $O_{2}$ and
equilibrium lines in the Ellingham diagram
        </p>
        <p>
         For each chemical reaction in the Ellingham diagram, the three phases
are in equilibrium on the line represented by , i.e. metal, metal
oxides, and O
         <sub>
          2
         </sub>
         gas. For conditions above the line, the value
of $P_{O_{2}}$ is larger than its equilibrium value, and the metal will
be oxidized. For conditions below the line, the value of $P_{O_{2}}$ is
lower than its equilibrium value, and the metal oxide will be reduced.
Therefore, the metal oxides in the upper part of the Ellingham diagram
can be reduced by the metals in the lower part of the diagram, and vice
versus, metals in the lower part of the diagram can be oxidized by the
metal oxides in the upper part of the diagram. For example, in , Ca can
reduce all oxides, and Cu
         <sub>
          2
         </sub>
         O is the least stable oxide.
        </p>
        <p>
         From the above Ellingham diagram, it is noted that equilibrium partial
pressures of $O_{2}$ are very low for most chemical reactions with many
of them lower than $10^{- 12}\ atm$. One approach to obtain such a low
pressure is to use auxiliary reactions containing $O_{2}$ that are easy
to control and are independent of the equilibrium system of interest
except the sharing of the oxygen partial pressure. Two common auxiliary
reactions are the $H_{2}$/$H_{2}O$ and $CO$/$CO_{2}$ mixtures. For the
$H_{2}$/$H_{2}O$ mixture, the chemical reaction is
        </p>
        <p>
         <em>
          Eq. 711
         </em>
         $2H_{2}(gas) + O_{2}(gas) = 2H_{2}O(gas)$
        </p>
        <p>
         The equilibrium oxygen partial pressure is obtained as
        </p>
        <p>
         <em>
          Eq. 712
         </em>
         $- RTln\left{ {\frac{1}{P_{O_{2}}}\left( \frac{P_{H_{2}O}}{P_{H_{2}}} \right)}^{2} \right} = \mathrm{\Delta}
         <em>
          {\ }^{0}G = \mathrm{\Delta}
         </em>
         {\ }^{0}H - T\mathrm{\Delta}_{\ }^{0}S = - 498488\  + 112.972T\ (J)$
        </p>
        <p>
         where the $\mathrm{\Delta}
         <em>
          {\ }^{0}H$ and $\mathrm{\Delta}
         </em>
         {\ }^{0}S$
are taken from the substance thermodynamic database (SSUB4) compiled by
Scientific Group Thermodata Europe (SGTE) [59], which are slightly
dependent on temperature, and the values in are evaluated at 1273K using
Thermo-Calc [60]. At any given temperature, one has the following
relation
        </p>
        <p>
         <em>
          Eq. 713
         </em>
         $RTlnP_{O_{2}} = \mathrm{\Delta}
         <em>
          {\ }^{0}H - T\mathrm{\Delta}
         </em>
         {\ }^{0}S - 2RTln\frac{P_{H_{2}}}{P_{H_{2}O}} = - 498488 + \left( 112.972 - 2Rln\frac{P_{H_{2}}}{P_{H_{2}O}} \right)T$
        </p>
        <p>
         Its intercept at $T = 0K$ is given by
$\mathrm{\Delta}
         <em>
          {\ }^{0}H = - 498,488\ (J)$, and the slope by
$- \mathrm{\Delta}
         </em>
         {\ }^{0}S - 2Rln\left( \frac{P_{H_{2}}}{P_{H_{2}O}} \right) = 112.972 - 2Rln\left( \frac{P_{H_{2}}}{P_{H_{2}O}} \right)$.
The values of the $\frac{P_{H_{2}}}{P_{H_{2}O}}$ ratio are marked on
another secondary axis on the right of the Ellingham diagram. The
intersection of the iso-partial-pressure-ratio line and the equilibrium
line of the chemical reaction gives the relation of equilibrium
temperature and equilibrium partial pressure ratio
$\frac{P_{H_{2}}}{P_{H_{2}O}}$ for desired $P_{O_{2}}$ of the chemical
equilibrium.
        </p>
        <p>
         For the $CO$/$CO_{2}$mixture, the chemical reaction is shown below
        </p>
        <p>
         <em>
          Eq. 714
         </em>
         $2CO(gas) + O_{2}(gas) = 2CO_{2}(gas)$
        </p>
        <p>
         Similar, from the SSUB database, the following equation is obtained
        </p>
        <p>
         <em>
          Eq. 715
         </em>
         $- RTln\left{ {\frac{1}{P_{O_{2}}}\left( \frac{P_{{CO}
         <em>
          {2}}}{P
         </em>
         {CO}} \right)}^{2} \right} = \mathrm{\Delta}
         <em>
          {\ }^{0}G = \mathrm{\Delta}
         </em>
         {\ }^{0}H - T\mathrm{\Delta}_{\ }^{0}S = - 562,927 - 172.020T\ (J)$
        </p>
        <p>
         with $\mathrm{\Delta}
         <em>
          {\ }^{0}H$ and $\mathrm{\Delta}
         </em>
         {\ }^{0}S$
calculated at 1273K, which are also slightly temperature-dependent as in
the case of the $H_{2}$/$H_{2}O$ mixture. The iso-partial-pressure-ratio
lines are written as
        </p>
        <p>
         <em>
          Eq. 716
         </em>
         $RTlnP_{O_{2}} = \mathrm{\Delta}
         <em>
          {\ }^{0}H - T\mathrm{\Delta}
         </em>
         {\ }^{0}S - 2RTln\frac{P_{CO}}{P_{{CO}
         <em>
          {2}}} = - 562,927 + \left( 172.020 - 2Rln\frac{P
         </em>
         {CO}}{P_{{CO}_{2}}} \right)T\ $
        </p>
        <p>
         Its intercept at $T = 0K$ is given by
$\mathrm{\Delta}
         <em>
          {\ }^{0}H = - 562,927\ (J)$, and the slope by
$172.020 - - 2Rln\left( \frac{P
         </em>
         {CO}}{P_{{CO}
         <em>
          {2}}} \right)$. The values
of the $\frac{P
         </em>
         {CO}}{P_{{CO}
         <em>
          {2}}}$ ratio are marked on the third
secondary axis on the right of the Ellingham diagram. The intersection
of the iso-partial-pressure-ratio line and the equilibrium line of the
chemical reaction gives the relation of equilibrium temperature and
equilibrium partial pressure ratio $\frac{P
         </em>
         {CO}}{P_{{CO}
         <em>
          {2}}}$ for
desired $P
         </em>
         {O_{2}}$ of the chemical equilibrium.
        </p>
        <p>
         Therefore, one can use a mixture of the $H_{2}$/$H_{2}O$ or
$CO$/$CO_{2}$ to obtain the desired low $P_{O_{2}}$ values using and or
calculating from the SSUB database. For example,
$P_{O_{2}} = 10^{- 15}\ atm$ at 1273K, the calculated values from the
SSUB database are $\frac{P_{H_{2}}}{P_{H_{2}O}} \approx 1.67$ and
$\frac{P_{CO}}{P_{{CO}
         <em>
          {2}}} \approx 2.78$, respectively, in which the
temperature dependences of $\mathrm{\Delta}
         </em>
         {\ }^{0}H$ and
$\mathrm{\Delta}
         <em>
          {\ }^{0}S$ and the many more gaseous species in the gas
phase are taken into account. On the other hand, the reading from the
Ellingham diagram gives $\frac{P
         </em>
         {H_{2}}}{P_{H_{2}O}} \approx 2.0$ and
$\frac{P_{CO}}{P_{{CO}_{2}}} \approx 2.4$, and the agreement with the
more accurate calculations above is remarkable keeping in mind the
uncertainties in graphically drawing the lines and reading both values
in the logarithmic scales from the diagram, indicating the robustness of
the Ellingham diagram.
        </p>
        <h2 id="internal-process-and-differential-and-integrated-driving-forces">
         <a href="#internal-process-and-differential-and-integrated-driving-forces">
          Internal process and differential and integrated driving forces
         </a>
        </h2>
        <p>
         The driving force for an internal process can be defined as following
using $U$, $H$, $F$, or $G$ as discussed in Chapter and depending on
what system variables are kept constant
        </p>
        <p>
         <em>
          Eq. 71
         </em>
         $- D = \left( \frac{\partial U}{\partial\xi} \right)
         <em>
          {S,\ V,N
         </em>
         {i}\ } = \left( \frac{\partial H}{\partial\xi} \right)
         <em>
          {S,\ P,N
         </em>
         {i}\ } = \left( \frac{\partial F}{\partial\xi} \right)
         <em>
          {T,\ V,N
         </em>
         {i}\ } = \left( \frac{\partial G}{\partial\xi} \right)
         <em>
          {T,P,N
         </em>
         {i}\ }$
        </p>
        <p>
         This can be termed as differential driving force as it relates the
derivative of energy with respect to an internal process so the change
is infinitesimally small and does not affect the properties of the
system significantly. For a system under constant $T$ and $P$, let us
consider an internal process for forming a new phase $\alpha$ with the
composition $x_{i}^{\alpha}$ and Gibbs energy
$G_{m}^{\alpha}\left( x_{i}^{\alpha} \right)$. The differential driving
force for such an internal process can thus be defined as
        </p>
        <p>
         <em>
          Eq. 72
         </em>
         $- D = G_{m}^{\alpha}\left( x_{i}^{\alpha} \right) - \sum_{i}^{}x_{i}^{\alpha}\mu_{i} = \sum_{i}^{}x_{i}^{\alpha}\left( \mu_{i}^{\alpha} - \mu_{i} \right)$
        </p>
        <p>
         where $\mu_{i}$ is the chemical potential of component
         <em>
          i
         </em>
         in the
system. This may also be called as nucleation driving force as if the
$\alpha$ phase is nucleating in the system. As discussed in Chapter ,
chemical potentials are the intercepts on the Gibbs energy axis by the
tangent plane of Gibbs energy. thus represents the distance between the
tangent planes of the original system and the $\alpha$ phase at the
composition of the $\alpha$ phase. Evidently, this distance is at its
maximum when the two tangent planes are parallel to each other, i.e. the
commonly called parallel tangent construction when evaluating nucleation
driving force.
        </p>
        <p>
         The situation is different for chemical reactions where the amount of
each component in reactants is the same as that in products, i.e. there
is a mass balance between reactants and products. The driving force for
a chemical reaction is defined by the Gibbs energy difference between
the reactants and products as if all the reactants are transferred to
the products. This driving force may thus be called integrated driving
force as it describes the energy difference of a system under two
different states, i.e.
        </p>
        <p>
         <em>
          Eq. 73
         </em>
         $- \int_{}^{}{Dd\xi} = \mathrm{\Delta}G = \sum_{p}^{}{n_{p}G_{p}} - \sum_{r}^{}{n_{r}G_{r}}$
        </p>
        <p>
         where superscripts $p$ and $r$ denote products and reactants, $n_{p}$
and $n_{r}$ their corresponding moles, $G_{p}$and $G_{r}$ the Gibbs
energies in per mole of formula of their respective stoichiometries as
written in the chemical reaction. Conventionally, the products and
reactants are represented by species or stoichiometric compounds rather
than individual phases. This is particularly evident when various
gaseous species are considered in a chemical reaction. Consequently,
$G_{p}$and $G_{r}$ in represent the chemical potentials of product and
reactant species. For species with a fixed composition, its chemical
potential is the same as its Gibbs energy as shown by . For a species in
a solution phase, its chemical potential is related to its activity as
shown in . can thus be further written as
        </p>
        <p>
         <em>
          Eq. 74
         </em>
         $\mathrm{\Delta}G = \sum_{p}^{}{n_{p}
         <em>
          {\ }^{0}G
         </em>
         {p}} - \sum_{r}^{}{n_{r}
         <em>
          {\ }^{0}G
         </em>
         {r}} + RTln\frac{\prod_{p}^{}\left( a_{p} \right)^{n_{p}}}{\prod_{r}^{}\left( a_{r} \right)^{n_{r}}} = \mathrm{\Delta}
         <em>
          {\ }^{0}G + RTln\frac{\prod
         </em>
         {p}^{}\left( a_{p} \right)^{n_{p}}}{\prod_{r}^{}\left( a_{r} \right)^{n_{r}}}$
        </p>
        <p>
         It is evident from that for stoichiometric phases in a chemical
reaction, their activities equal to one. At equilibrium, the integrated
driving force becomes zero, i.e. $\mathrm{\Delta}G = 0$, and is
re-arranged to become
        </p>
        <p>
         <em>
          Eq. 75
         </em>
         $- RTln\frac{\prod_{p}^{}\left( a_{p} \right)^{n_{p}}}{\prod_{r}^{}\left( a_{r} \right)^{n_{r}}} = - RTlnK_{e} = \mathrm{\Delta}
         <em>
          {\ }^{0}G = \mathrm{\Delta}
         </em>
         {\ }^{0}H - T\mathrm{\Delta}_{\ }^{0}S$
        </p>
        <p>
         where $K_{e}$ is often called reaction constant relating the activities
of products and reactants at equilibrium. In a system with
$\frac{\prod_{p}^{}\left( a_{p} \right)^{n_{p}}}{\prod_{r}^{}\left( a_{r} \right)^{n_{r}}} &gt; K_{e}$,
the chemical reaction goes to left, and the products are decomposed,
while
$\frac{\prod_{p}^{}\left( a_{p} \right)^{n_{p}}}{\prod_{r}^{}\left( a_{r} \right)^{n_{r}}} &lt; K_{e}$,
the chemical reaction goes to right, and the products are formed. is
often recast into the following form by dividing $&ndash;RT$ on both sides of
the equation
        </p>
        <p>
         <em>
          Eq. 76
         </em>
         $\ln K_{e} = - \frac{\mathrm{\Delta}
         <em>
          {\ }^{0}H}{RT} + \frac{\mathrm{\Delta}
         </em>
         {\ }^{0}S}{R}$
        </p>
        <p>
         With $\ln K_{e}$ plotted with respect to $1/T$, indicates that the slope
is $- \mathrm{\Delta}
         <em>
          {\ }^{0}H$/R and the intercept on the y axis is
$\mathrm{\Delta}
         </em>
         {\ }^{0}{S/R}$ as shown in .
        </p>
        <p>
         Figure : $\ln K_{e}$ plotted with respect to $1/T$ for several M-O
systems at 1 bar and $K_{e}$ represented by the partial pressure ratio
of CO
         <sub>
          2
         </sub>
         and CO.
        </p>
        <h2 id="maximum-reaction-rate-and-chemical-transport-reactions">
         <a href="#maximum-reaction-rate-and-chemical-transport-reactions">
          Maximum reaction rate and chemical transport reactions
         </a>
        </h2>
        <p>
         Equilibrium thermodynamics can be used to calculate the maximum rates of
reaction that are possible in dynamically reacting systems, such as when
a corrosive gas passes over a heated sample. Other examples of such
reactions include the reduction of a metal oxide in flowing hydrogen,
the evaporation of a material in a vacuum, and the deposition of a thin
film by a chemical vapour deposition process. The basic assumption used
in calculating these maximum reaction rates is that local equilibrium
exists at the location of the considered reaction.
        </p>
        <p>
         This section examines several examples in which maximum reaction rates
are calculated. The system can typically be divided into three regions:
(1) the input region, which is usually near room temperature, (2) the
high temperature region in which the primary reaction of interest is
occurring, and (3) the exit region. Such a system is almost always at
constant pressure throughout the system. Since the three regions have
different temperatures, the key is to use the mass conservation of the
carrier gas in all three regions. With the input gas at $T = 298K$ and
$P = 1atm$, the volume of one mole of ideal gas is
$0.0244\left( m^{3} \right) = 24.4(liter)$. The number of moles of input
gas flowing through the system can be written as
        </p>
        <p>
         <em>
          Eq. 717
         </em>
         $n_{gas}^{0} = \frac{Pf_{gas}}{RT} = \frac{f_{gas}}{24.4} = 0.0409f_{gas}$
        </p>
        <p>
         where $f_{gas}$ is the input gas flow rate in liter per unit time at
$T = 298K$ and $P = 1atm$, and $R$ the gas constant.
        </p>
        <p>
         The first example is the evaporation of water in a flowing stream of dry
hydrogen. A schematic diagram of the system being considered is given in
. The goal of the calculation is to determine the maximum rate of
$H_{2}O(liquid)$ loss, $n_{H_{2}O}^{\ }$, through vaporization in a
flowing stream of $H_{2}$, e.g. for generating a given $H_{2}O/H_{2}$
ratio for producing a given $O_{2}$ pressure in a high temperature
system as related to the Ellingham diagram discussed in Chapter . The
maximum rate is determined by saturating the $H_{2}$ with the
equilibrium vapour pressure of $H_{2}O(liquid)$ with the number of moles
of $H_{2}$ being $n_{H_{2}}^{0} = 0.0409f_{H_{2}}$ and $f_{H_{2}}$ being
the input flow rate of $H_{2}$ in liter per unit time.
        </p>
        <p>
         Figure : Schematic diagram of vaporization of water in a flowing stream
of dry hydrogen
        </p>
        <p>
         In the first input region, the total number moles of gas is
$N = n_{H_{2}}^{0}$. In the second high temperature region with the
temperature and pressure being $T_{sys}$ and $P_{sys}$, the total number
moles of gas is $N = n_{H_{2}}^{0} + n_{H_{2}O}^{\ }$, which is the same
for the third exit region with $T_{exit}$. To avoid condensation, one
needs to maintain $T_{exit} &gt; T_{sys}$. The vapour pressure of $H_{2}O$
at $T_{sys}$, $P_{H_{2}O\ }$, can be obtained from equilibrium
thermodynamic calculations. Since the $H_{2}$ and $H_{2}O$ are occupying
the same volume at the same temperature, the maximum number of moles
$H_{2}O$ can be calculated from the following relation based on the
ideal gas law
        </p>
        <p>
         <em>
          Eq. 718
         </em>
         $n_{H_{2}O}^{\ } = \frac{P_{H_{2}O}^{\ }}{P_{H_{2}}^{\ }}n_{H_{2}}^{0} = \frac{P_{H_{2}O}^{\ }}{P_{sys}^{\ } - P_{H_{2}O}^{\ }}n_{H_{2}}^{0} = \frac{P_{H_{2}O}^{\ }}{P_{sys}^{\ } - P_{H_{2}O}^{\ }}\frac{f_{H_{2}}}{24.4}$
        </p>
        <p>
         For $P_{sys}^{\ } = 101325Pa$, one can calculate $P_{H_{2}O}^{\ }$ and
plot $\frac{n_{H_{2}O}^{\ }}{f_{H_{2}}}$ as a function of temperature
from the SSUB database as shown in . The corresponding partial pressure
ratio, $P_{H_{2}O}/P_{H_{2}}$ , is plotted in , which can be used to
calculate $P_{O_{2}}^{\ }$ at any given temperatures. An example is
shown in with $T_{sys} = 348.15K$ and $P_{H_{2}O}/P_{H_{2}} = 0.607$.
        </p>
        <p>
         Figure : Ratio of maximum number of moles $H_{2}O$ with respect to
hydrogen flow rate, $\frac{n_{H_{2}O}^{\ }}{f_{H_{2}}}$, plotted as a
function of temperature.
        </p>
        <p>
         Figure : Partial pressure ratio, $P_{H_{2}O}/P_{H_{2}}$, corresponding
to .
        </p>
        <p>
         Figure : Partial pressure of oxygen, $P_{O_{2}}^{\ }$, as a function of
temperature with $T_{sys} = 348.15K$ and $P_{H_{2}O}/P_{H_{2}} = 0.607$.
        </p>
        <p>
         The second example is the corrosion of $SiO_{2}$(s) by flowing $H_{2}$
gas at high temperatures. Considering $T_{sys}^{\ } = 1700K$,
$P_{sys}^{\ } = 101325Pa$, and $f_{H_{2}} = 1\ liter/min$, the system is
thus defined with 0.0409 moles of $H_{2}$ and an equilibrium between the
gas phase and the tridymite $SiO_{2}$. The equilibrium calculation gives
0.04092 moles of gas with its constitutions as
$H_{2}:H_{2}O:SiO = 0.998887:4.833 \bullet 10^{- 4}:4.832 \bullet 10^{- 4}$.
The corrosion rate of SiO
         <sub>
          2
         </sub>
         (s) is thus
$0.04092x4.832 \bullet 10^{- 4} = 1.98 \bullet 10^{- 5}mol/min = 1.19gram/min.$
        </p>
        <p>
         Another example is to consider that the flowing $CO$ gas of 298K and
1atm ($= 101325Pa$) at a rate of $1\ liter/min$ passes through and
equilibrates with single phase $C(s)$ at 1500K. The equilibrium system
is defined by $T = 1500K$, $P = 1atm$, and 0.0409 moles of $CO$ with the
equilibrium between the gas phase and C(s). The equilibrium calculation
gives 0.040872 moles of gas phase with the mole fraction of $CO$ being
0.999327, resulting in the loss of
         <em>
          CO
         </em>
         or the deposition of
         <em>
          C(s)
         </em>
         at a
rate of
$0.0409 - 0.040872 \bullet 0.999327 = 5.55 \bullet 10^{- 5}mole/min$.
        </p>
        <p>
         A chemical transport reaction is a reaction in which a condensed phase
reacts with a gas phase to form vapour-phase products, which in turn
undergo the reverse reformation of the condensed phase. Two well-known
examples of such reactions are
        </p>
        <p>
         <em>
          Eq. 719
         </em>
         $M(s) + \frac{n}{2}I_{2}(g) = MI_{n}(g)$
        </p>
        <p>
         <em>
          Eq. 720
         </em>
         $Ni(s) + 4CO(g) = Ni{(CO)}_{4}(g)$
        </p>
        <p>
         which are used in the purification of metals by the iodide process and
in the purification of nickel by the Mond-Langer process. In both
processes the forward reaction is favoured by lower temperatures and the
reverse reaction by higher temperatures, resulting in the deposition of
the metal. The most common technique for causing a chemical transport of
a condensed substance makes use of the temperature dependence of the
equilibrium constant. As was discussed previously, the enthalpy of
reaction, $\mathrm{\Delta}
         <em>
          {\ }^{0}H$, determines the manner in which
$K
         </em>
         {e}$ changes with temperature (see ). The value of $K_{e}$ increases
with increasing
         <em>
          T
         </em>
         for $\mathrm{\Delta}
         <em>
          {\ }^{0}H &gt; 0$, $K
         </em>
         {e}$
decreases with increasing
         <em>
          T
         </em>
         for $\mathrm{\Delta}
         <em>
          {\ }^{0}H &lt; 0$, and
$K
         </em>
         {e}$ is independent of T for $\mathrm{\Delta}
         <em>
          {\ }^{0}H = 0$. The
$\mathrm{\Delta}
         </em>
         {\ }^{0}H$ and $\mathrm{\Delta}_{\ }^{0}S$ values for
chemical transport reactions may be either positive or negative. For
reactions by both are positive, and for reactions by both are negative.
        </p>
        <p>
         In a typical experiment the starting solid is located at the point in a
temperature gradient that corresponds to the largest $K_{e}$ value for
the experimental condition. As the gaseous species migrate to other
locations in the system with temperatures corresponding to lower $K_{e}$
values, the reverse reaction occurs to satisfy the new equilibrium
requirements, and the solid phase is deposited. The dependence of
$K_{e}$ on $\mathrm{\Delta}
         <em>
          {\ }^{0}H$ results in a material transport
from hot to cold for $\mathrm{\Delta}
         </em>
         {\ }^{0}H &gt; 0$ (the same as for
vaporization-condensation reactions), from cold to hot for
$\mathrm{\Delta}
         <em>
          {\ }^{0}H &lt; 0$, and no transport for
$\mathrm{\Delta}
         </em>
         {\ }^{0}H = 0$.
        </p>
        <p>
         The success of a particular reaction in causing an appreciable transport
of a condensed phase depends mainly upon the partial pressure gradients
or concentration gradients of the gaseous species in the system. A
reaction whose equilibrium is extreme toward either the reactant side or
the product side will not give an appreciable transport of material. The
concentration gradients are too small in such a system. Reactions with
equilibrium constants near unity at the experimental temperatures
usually give the largest transport since small changes in $K_{e}$ cause
large changes in concentrations. The general condition required for
obtaining a $K_{e}$ value near unity at a reasonable temperature is that
$\mathrm{\Delta}
         <em>
          {\ }^{0}H$ and $\mathrm{\Delta}
         </em>
         {\ }^{0}S$ both have
the same sign, resulting from the equalities of .
        </p>
        <h2 id="trends-of-entropies-of-reactions">
         <a href="#trends-of-entropies-of-reactions">
          Trends of entropies of reactions
         </a>
        </h2>
        <p>
         The reaction entropy, $\mathrm{\Delta}_{\ }^{0}S$ in , plays an
important role in determining equilibria of high-temperature reactions.
The most important single factor that determines the entropy of a
reaction is the net change in the number of moles of gas as briefly
mentioned in the discussion of the Ellingham diagram above. The reason
this is true can be explained as follows.
        </p>
        <p>
         The entropy of a substance can be thought of as being the sum of four
parts: (i) translational, (ii) rotational, (iii) vibrational, and (iv)
electronic. The translational entropy of a gas is the largest entropy
term under most conditions. To the extent that the other contributions
cancel between reactants and products, the entropy of reaction is
determined by the change in the number of moles of gaseous molecules.
Based on the literature data or calculations from the SSUB database, the
net change in the number of moles of gas in a reaction results
approximately in an entropy of reaction of about 175&plusmn;45 J/K/mole-gas at
298K for many halides and oxides. The chemical reactions of and
discussed above both reduce the gas by one mole, and their entropies of
reaction are -113 and -172 J/K at 1273K, and -89 and -173J/K at 298K,
respectively, indicating that the chemical reaction of is an exception
of the empirical rule. For chemical reactions shown in the Ellingham
diagram, their entropies of reaction follow this empirical rule pretty
well with some of them shown in calculated from the SGTE database.
        </p>
        <p>
         Table : Entropies of reactions with gas at 298.15K, J/K
        </p>
        <p>
         Reaction: Si+O
         <sub>
          2
         </sub>
         =SiO
         <sub>
          2
         </sub>
         -182
        </p>
        <p>
         Reaction: Ti+O
         <sub>
          2
         </sub>
         =TiO
         <sub>
          2
         </sub>
         -185
        </p>
        <p>
         Reaction: 2Mg+O
         <sub>
          2
         </sub>
         =2MgO -217
        </p>
        <p>
         Reaction: 2Ca+O
         <sub>
          2
         </sub>
         =2CaO -212
        </p>
        <p>
         Reaction: 2Mn+O
         <sub>
          2
         </sub>
         =2MnO -150
        </p>
        <p>
         Since the entropy of a reaction is primarily determined by the net
change in the number of moles of gas, the entropies for reactions
involving only condensed phases must be small. The entropies of fusion
of monatomic solids are usually in the range 8-15 J/K/mole-atom as shown
for some elements in . Most metals and many ionic salts have values that
lie in this range when given in terms of per mole of atom of material.
There are few exceptions such as silicon and boron shown in the table.
For solid-state reactions, the average values can be approximated as
0&plusmn;8J/K/mole-atom as also shown in the table.
        </p>
        <p>
         Table : Entropies of reactions of condensed phases at 298.15K, J/K
        </p>
        <p>
         Reaction: Si(s)=Si(l) 29.762
        </p>
        <p>
         Reaction: Ti(s2)=Ti(l) 7.288
        </p>
        <p>
         Reaction: Mg(s2)=Mg(l) 9.184
        </p>
        <p>
         Reaction: Ca(s2)=Ca(l) 7.659
        </p>
        <p>
         Reaction: Mn(s2)=Mn(l) 11.443
        </p>
        <p>
         Reaction: W(s)=W(l) 14.158
        </p>
        <p>
         Reaction: B(s)=B(l) 21.380
        </p>
        <p>
         Reaction: 3Fe+C=CFe
         <sub>
          3
         </sub>
         17.060
        </p>
        <p>
         Reaction: S+Mn=MnS 13.909
        </p>
        <p>
         Reaction: NiO+Fe
         <sub>
          2
         </sub>
         O
         <sub>
          3
         </sub>
         =Fe
         <sub>
          2
         </sub>
         NiO
         <sub>
          4
         </sub>
         0.464
        </p>
        <h2 id="aqueous-solution-and-pourbaix-diagram">
         <a href="#aqueous-solution-and-pourbaix-diagram">
          Aqueous solution and Pourbaix diagram
         </a>
        </h2>
        <p>
         The importance of aqueous solutions in all aspects of life is so well
known and needs not be discussed further. Since many electrochemical
processes involve electrolyte solutions in an aqueous solvent,
electrochemical processes including water, hydrogen, and/or oxygen are
discussed in more details. The hydrogen-oxygen cell can be described for
both acidic electrolytes and alkaline electrolytes. With acidic
electrolytes, H
         <sup>
          +
         </sup>
         is in much higher concentrations than
OH
         <sup>
          -
         </sup>
         , and thus half-cell reactions with H
         <sup>
          +
         </sup>
         as an
ionic transport species are more important than those involving
OH
         <sup>
          -
         </sup>
         . The reverse is true for alkaline electrolytes that
contain high OH
         <sup>
          -
         </sup>
         concentrations. Other than for nearly neutral
acid-base systems, either H
         <sup>
          +
         </sup>
         or OH
         <sup>
          -
         </sup>
         dominates the
other by several orders of magnitude as can be seen from the value of
the 298 K dissociation constant for H
         <sub>
          2
         </sub>
         O:
        </p>
        <p>
         <em>
          Eq. 835
         </em>
         H
         <sub>
          2
         </sub>
         O(l) = H
         <sup>
          +
         </sup>
         (aq) + OH
         <sup>
          -
         </sup>
         (aq)
        </p>
        <p>
         with the reaction constant being K
         <sub>
          e
         </sub>
         =
[H
         <sup>
          +
         </sup>
         ][OH
         <sup>
          -
         </sup>
         ] = 10
         <sup>
          -14
         </sup>
         and
$\mathrm{\Delta}_{\ }^{0}G$= -RT
         <em>
          ln
         </em>
         K
         <sub>
          e
         </sub>
         <em>
          &beta;
         </em>
         = +79,908 J. By
convention, one defines pH = - log [H
         <sup>
          +
         </sup>
         ] and pOH = - log
[OH
         <sup>
          -
         </sup>
         ], and then pH + pOH = 14.
        </p>
        <p>
         Under acidic electrolyte conditions of low pH (high [H
         <sup>
          +
         </sup>
         ]
concentrations) the anode reaction in a hydrogen-oxygen cell is:
        </p>
        <p>
         <em>
          Eq. 836
         </em>
         &frac12; H
         <sub>
          2
         </sub>
         (g) = H
         <sup>
          +
         </sup>
         (aq) + e
         <sup>
          -
         </sup>
        </p>
        <p>
         with &epsilon;
         <sub>
          1
         </sub>
         <sup>
          o
         </sup>
         = 0.0 V and
$\mathrm{\Delta}
         <em>
          {\ }^{0}G
         </em>
         {1}$= 0 J. The corresponding cathode
(reduction) reaction is:
        </p>
        <p>
         <em>
          Eq. 837
         </em>
         2 H
         <sup>
          +
         </sup>
         (aq) + &frac12; O
         <sub>
          2
         </sub>
         (g) + 2 e
         <sup>
          -
         </sup>
         =
H
         <sub>
          2
         </sub>
         O(l)
        </p>
        <p>
         with &epsilon;
         <sub>
          2
         </sub>
         <sup>
          o
         </sup>
         = 1.229 V and
$\mathrm{\Delta}
         <em>
          {\ }^{0}G
         </em>
         {2}$ = -2*1.229*96,485 J = -237,160 J. The
net cell reaction for acidic electrolytes is:
        </p>
        <p>
         <em>
          Eq. 838
         </em>
         H
         <sub>
          2
         </sub>
         (g) + &frac12; O
         <sub>
          2
         </sub>
         (g) = H
         <sub>
          2
         </sub>
         O(l)
        </p>
        <p>
         with &epsilon;
         <sup>
          o
         </sup>
         <sub>
          cell
         </sub>
         = 1.229 V and
$\mathrm{\Delta}
         <em>
          {\ }^{0}G
         </em>
         {cell}$ = -2*1.229*96,485 J = -237,160 J
        </p>
        <p>
         Under alkaline electrolyte conditions of high pH (high
[OH
         <sup>
          -
         </sup>
         ] concentrations) the anode reaction in a
hydrogen-oxygen cell is:
        </p>
        <p>
         <em>
          Eq. 839
         </em>
         2 OH
         <sup>
          -
         </sup>
         (aq) + H
         <sub>
          2
         </sub>
         (g) = 2
H
         <sub>
          2
         </sub>
         O(l) + 2 e
         <sup>
          -
         </sup>
        </p>
        <p>
         with &epsilon;
         <sub>
          3
         </sub>
         <sup>
          o
         </sup>
         = 0.828 V and
$\mathrm{\Delta}
         <em>
          {\ }^{0}G
         </em>
         {3}$= -2*0.828*96,485 J = -159,779 J. The
corresponding cathode (reduction) reaction is:
        </p>
        <p>
         <em>
          Eq. 840
         </em>
         H
         <sub>
          2
         </sub>
         O(l) + &frac12; O
         <sub>
          2
         </sub>
         (g) + 2 e
         <sup>
          -
         </sup>
         = 2
OH
         <sup>
          -
         </sup>
         (aq)
        </p>
        <p>
         with &epsilon;
         <sub>
          4
         </sub>
         <sup>
          o
         </sup>
         = 0.401 V and
$\mathrm{\Delta}
         <em>
          {\ }^{0}G
         </em>
         {4}$ = -2*0.401*96,485 J = -77,381 J. The
net cell reaction for alkaline electrolytes is:
        </p>
        <p>
         <em>
          Eq. 841
         </em>
         H
         <sub>
          2
         </sub>
         (g) + &frac12; O
         <sub>
          2
         </sub>
         (g) = H
         <sub>
          2
         </sub>
         O(l)
        </p>
        <p>
         with &epsilon;
         <sup>
          o
         </sup>
         <sub>
          cell
         </sub>
         = 1.229 V and
$\mathrm{\Delta}
         <em>
          {\ }^{0}G
         </em>
         {cell}$ = -2*1.229*96,485 J = -237,160 J.
        </p>
        <p>
         Plots of &epsilon; versus pH for a given chemical system have been typically
used to exhibit the stability relationships of ionic species and solid
phases in aqueous-based electrochemical systems. These graphs are often
called Pourbaix diagrams after the inventor and are at constant
temperature and constant pressure diagrams for a constant concentration,
usually for one metallic element. By convention, the &epsilon; in a Pourbaix
diagram corresponds to the potential for the cathode reduction reactions
in the electrochemical half-cell with electrons as reactants. Pourbaix
diagrams can be extended to multi-component materials when thermodynamic
properties of the components are available in both the materials and the
aqueous solution.
        </p>
        <p>
         An example of an &epsilon; versus pH diagram is shown in for the
Ni-H
         <sub>
          2
         </sub>
         O system at a 298K, 1 bar, and $c_{{Ni}^{2 +}} = 0.001$
molality. Three stability regions for Ni species are shown: Ni(s),
NiO(s), and [Ni
         <sup>
          2+
         </sup>
         ]. The two dashed lines on this diagram
correspond to hydrogen reduction () and oxygen reduction () reactions,
respectively.
        </p>
        <p>
         Figure : An &epsilon; versus pH, Pourbaix diagram for the Ni-H
         <sub>
          2
         </sub>
         O at
298K, 1 bar, and $c_{{Ni}^{2 +}} = 0.001$ molality.
        </p>
        <p>
         For the &epsilon; and pH conditions within the boundaries of the Ni(s) region,
no solid phase other than Ni(s) is stable, no ionic species with a
concentration of 1 molarity is stable, and no gas species with a
pressure of 1 bar is stable. Similar statements could be made about the
NiO(s) and [Ni
         <sup>
          2+
         </sup>
         ] areas on the diagram. In the
[Ni
         <sup>
          2+
         </sup>
         ] area, introduction of Ni(s) or NiO(s) into the
system would result in the dissolution of these solid phases since they
are not stable with respect to the [Ni
         <sup>
          2+
         </sup>
         ] aqueous solution.
The corresponding chemical reactions proceed spontaneously to the right
as follows until the solid phases are consumed:
        </p>
        <p>
         <em>
          Eq. 842
         </em>
         Ni(s) &rarr; Ni
         <sup>
          2+
         </sup>
         (1 molarity) + 2 e
         <sup>
          -
         </sup>
        </p>
        <p>
         <em>
          Eq. 843
         </em>
         NiO(s) + 2 H
         <sup>
          +
         </sup>
         (aq) &rarr; Ni
         <sup>
          2+
         </sup>
         (1 molarity) +
H
         <sub>
          2
         </sub>
         O(l)
        </p>
        <p>
         No H
         <sup>
          +
         </sup>
         (aq) in involved in the first reaction, , so the
boundary line separating Ni(s) and Ni
         <sup>
          2+
         </sup>
         is independent of pH.
No oxidation or reduction occurs in the second reaction, , i.e. no
electrons are reactants or products in the reaction, the boundary line
separating NiO(s) and Ni
         <sup>
          2+
         </sup>
         is independent of &epsilon;.
        </p>
        <p>
         Note the convention that the &epsilon; is the potential for a cathode reduction
reaction, and boundary lines between two stability regions depict
conditions under which partial equilibrium occurs for the two species
for the &epsilon; and pH values at any point on these lines. For the boundary
line separating Ni(s) and Ni
         <sup>
          2+
         </sup>
         in an ideal aqueous solution,
i.e. the reverse of , the following equation is obtained.
        </p>
        <p>
         <em>
          Eq. 844
         </em>
         &epsilon; = &epsilon;
         <sup>
          o
         </sup>
         = -0.268 V
        </p>
        <p>
         For the NiO(s)-Ni
         <sup>
          2+
         </sup>
         boundary line of an ideal solution, the
reaction, , is a complete equilibrium, and thus the relationship is
        </p>
        <p>
         <em>
          Eq. 845
         </em>
         $0 = \mathrm{\Delta}
         <em>
          {\ }^{0}G + RTln\frac{1}{\left( c
         </em>
         {H^{+}} \right)^{2}} = \mathrm{\Delta}_{\ }^{0}G + 2 \cdot 2.303 \cdot RT \cdot pH$
        </p>
        <p>
         <em>
          Eq. 846
         </em>
         $pH = - \frac{\mathrm{\Delta}_{\ }^{0}G}{2 \cdot 2.303 \cdot RT}$
        </p>
        <p>
         where $\mathrm{\Delta}_{\ }^{0}G$ is obtained as follows and can be
calculated from the SSUB database and the standard potential of Ni,
        </p>
        <p>
         <em>
          Eq. 847
         </em>
        </p>
        <p>
         At a specified temperature, only one standard free energy and only one
equilibrium constant exists for this chemical reaction, and thus only
one specific value of $pH = 6.631$ exists for the reaction represented
by in this Pourbaix diagram.
        </p>
        <p>
         The diagonal line in represents the equilibrium between Ni(s) and NiO(s)
and is for a partial equilibrium reaction that is the sum of reactions
of and
        </p>
        <p>
         <em>
          Eq. 848
         </em>
         NiO(s) + 2 H
         <sup>
          +
         </sup>
         (aq) + 2 e
         <sup>
          -
         </sup>
         &boxH; Ni(s) +
H
         <sub>
          2
         </sub>
         O(l)
        </p>
        <p>
         The reduction of Ni from a divalent state in NiO to metallic Ni(s)
occurs, but the reaction also depends on the H
         <sup>
          +
         </sup>
         concentration, the pH. The corresponding Gibbs energy and Nernst
equations are,
        </p>
        <p>
         <em>
          Eq. 849
         </em>
         $\mathrm{\Delta}G = \mathrm{\Delta}
         <em>
          {\ }^{0}G + RTln\frac{1}{\left( c
         </em>
         {H^{+}} \right)^{2}} = - 23,939 + 2 \cdot 2.303 \cdot RT \cdot pH$
        </p>
        <p>
         <em>
          Eq. 850
         </em>
         $\varepsilon\  = \ \varepsilon^{0}\  - \ \frac{RT}{2f}\ln\frac{1}{\left( c_{H^{+}} \right)^{2}}\  = 0.124\ &ndash;\ \frac{2.303 \cdot RT}{f}pH$
        </p>
        <p>
         where $\mathrm{\Delta}_{\ }^{0}G$ can be calculated as follows
        </p>
        <p>
         <em>
          Eq. 851
         </em>
        </p>
        <p>
         The two additional lines in correspond to the reduction reactions
related to H
         <sub>
          2
         </sub>
         and O
         <sub>
          2
         </sub>
         gases, i.e. the stability of
H
         <sub>
          2
         </sub>
         O. The lower one is for the reverse of under &epsilon;
         <sup>
          o
         </sup>
         = 0 and $P_{H_{2}} = 1$ with the Nernst equation being
        </p>
        <p>
         <em>
          Eq. 852
         </em>
         $\varepsilon\  = \ \varepsilon^{0}\  - \ \frac{RT}{f}\ln\frac{\left( P_{H_{2}} \right)^{1/2}}{c_{H^{+}}}\  = - \frac{2.303 \cdot RT}{f}pH$
        </p>
        <p>
         As the pH increases from 0, &epsilon; becomes more negative as is depicted. The
top dashed line corresponds to the oxygen reduction reaction represented
by under &epsilon;
         <sup>
          o
         </sup>
         = 1.225 calculated from the aqueous solution
database in Thermo-Calc [60] and $P_{O_{2}} = 1$ with the Nernst
equation being
        </p>
        <p>
         Eq. 853
$\varepsilon\  = \ \varepsilon^{0}\  - \ \frac{RT}{2f}\ln\frac{\left( P_{O_{2}} \right)^{1/2}}{\left( c_{H^{+}} \right)^{2}}\  = 1.225\ &ndash;\ \frac{2.303 \cdot RT}{f}pH$
        </p>
        <p>
         The dependence of &epsilon; on pH is identical for both reduction reaction and ,
and their intercepts at $pH = 0$ differ by their difference in their
&epsilon;
         <sup>
          o
         </sup>
         values.
        </p>
        <p>
         In this simple Pourbaix diagram of Ni in an ideal aqueous solution, all
boundary lines are straight because there is only one ionic species of
Ni in the aqueous solution, i.e. Ni
         <sup>
          2+
         </sup>
         . When there are more
than one ionic species in the aqueous solution, the boundary lines may
no longer be straight due to the competition between species. One
example is Cu with two main ionic species of Cu
         <sup>
          +2
         </sup>
         and
CuOH
         <sup>
          +
         </sup>
         , and the reduction reaction between the metallic Cu and
the aqueous solution involves both two species, i.e.
        </p>
        <p>
         <em>
          Eq. 854
         </em>
         ${xCu}^{2 + \ }\  + \ (1 - x){CuOH}^{+} + (1 - x)H^{+} + 2\ e - \ \  = \ \ Cu(s) + {(1 - x)H}_{2}O$
        </p>
        <p>
         with
        </p>
        <p>
         <em>
          Eq. 855
         </em>
         $\mathrm{\Delta}G = \mathrm{\Delta}
         <em>
          {\ }^{0}G + RTln\frac{1}{\left( c
         </em>
         {{Cu}^{2 +}} \right)^{x}\left( c_{{CuOH}^{+}}c_{H^{+}} \right)^{1 - x}} = \mathrm{\Delta}
         <em>
          {\ }^{0}G + RTln\frac{1}{\left( c
         </em>
         {{Cu}^{2 +}} \right)^{x}\left( c_{{CuOH}^{+}} \right)^{1 - x}} + 2.303(1 - x) \cdot RT \cdot pH$
        </p>
        <p>
         <em>
          Eq. 856
         </em>
         $\varepsilon = \varepsilon^{0} - \frac{RT}{2f}\ln\frac{1}{\left( c_{{Cu}^{2 +}} \right)^{x}\left( c_{{CuOH}^{+}} \right)^{1 - x}} - \frac{2.303(1 - x) \cdot RT}{2f}pH$.
        </p>
        <p>
         It is evident that both the slope and the intercept at $pH = 0$ are a
function of the concentration of ${CuOH}^{+}$, which is a function of
$pH$. Consequently, the boundary between the metallic Cu and the aqueous
solution is no longer a straight line as shown in .
        </p>
        <p>
         Figure : An &epsilon; versus pH, Pourbaix diagram for the Cu-H
         <sub>
          2
         </sub>
         O
system at 298K, 1 bar, and $c_{Cu} = 0.001$ molality.
        </p>
        <p>
         The concentrations of various species in the aqueous solution, i.e.
commonly called speciation, are plotted in , showing the change of
dominant species as a function of pH value.
        </p>
        <p>
         Figure : Concentrations of ionic species in the aqueous solution at
$\varepsilon = 0.3\ V$ from .
        </p>
        <p>
         In Pourbaix diagrams for alloys with two or more elements, activities of
individual elements are to be used in calculating the potentials of
reduction reactions. Considering a Fe-Ni alloy with Fe
         <sup>
          2+
         </sup>
         and
Ni
         <sup>
          2+
         </sup>
         in the aqueous solution, the reduction reactions for Fe
and Ni can be written separately as
        </p>
        <p>
         <em>
          Eq. 857
         </em>
         Ni
         <sup>
          2+
         </sup>
         (c
         <sub>
          Ni
         </sub>
         ) + 2 e
         <sup>
          -
         </sup>
         &rarr; Ni
(a
         <sub>
          Ni
         </sub>
         in alloy)
        </p>
        <p>
         <em>
          Eq. 858
         </em>
         Fe
         <sup>
          2+
         </sup>
         (c
         <sub>
          Fe
         </sub>
         ) + 2 e
         <sup>
          -
         </sup>
         &rarr; Fe
(a
         <sub>
          Fe
         </sub>
         in alloy)
        </p>
        <p>
         with their potentials as
        </p>
        <p>
         <em>
          Eq. 859
         </em>
         $\varepsilon_{Ni}\  = \ \varepsilon_{Ni}^{0} - \frac{2.303RT}{2f}\ln\frac{a_{Ni}}{c_{Ni}} = \  - 0.268 - \frac{2.303RT}{2f}\ln\frac{a_{Ni}}{c_{Ni}}$
        </p>
        <p>
         <em>
          Eq. 860
         </em>
         $\varepsilon_{Fe}\  = \ \varepsilon_{Fe}^{0} - \frac{2.303RT}{2f}\ln\frac{a_{Fe}}{c_{Fe}} = \  - 0.441 - \frac{2.303RT}{2f}\ln\frac{a_{Fe}}{c_{Fe}}$
        </p>
        <p>
         In principle, there are two scenarios for a given set of $a_{Ni}$ and
$a_{Fe}$ of the alloy. The first scenario is at the limit of a dilute
aqueous solution, i.e. $c_{Ni} = c_{Fe} = 0.001\ $molarity,
$\varepsilon_{Ni}$ and $\varepsilon_{Fe}$ can be calculated, and the
element with the lower potential has the tendency to dissolve first,
which can result in the so-called dialloying effect. The second scenario
is for the equal potential, i.e. $\varepsilon_{Ni} = \varepsilon_{Fe}$
due to the externally imposed potential, and the equilibrium
concentrations of Fe
         <sup>
          +2
         </sup>
         and Ni
         <sup>
          +2
         </sup>
         can be calculated
from and .
        </p>
        <h2 id="concentrations-activities-and-reference-states-of-electrolyte-species">
         <a href="#concentrations-activities-and-reference-states-of-electrolyte-species">
          Concentrations, activities, and reference states of electrolyte species
         </a>
        </h2>
        <p>
         Thermodynamic descriptions of ionic species in solutions are different
from those of neutral species, which leads to a need for defining
concentration units, standard states, activities, and activity
coefficients of ionic solutions. In most studies of electrochemical
corrosion and electrodeposition, and in applied work of electrochemical
engineers, ionic species concentrations are given in units of molarity,
the number of moles of a species in a liter of solution (mol/l)
symbolically represented in equations by either
         <em>
          c
          <sub>
           i
          </sub>
         </em>
         or
[M
         <sup>
          +Z
         </sup>
         ]. The other common concentration used for ionic
species is molality, which is defined as the number of moles of a
species in 1000g of solvent. For dilute aqueous solutions, molarity and
molality values are very similar.
        </p>
        <p>
         As discussed in Chapter , a practical definition of the activity of a
species
         <em>
          i
         </em>
         is the thermodynamic reactivity, or tendency to react, of
species
         <em>
          i
         </em>
         in the system of interest as compared to
         <em>
          i
         </em>
         in its
reference state form. The reference state of a species is typically
chosen as a specific chemical/physical state of the species at 1 atm
external pressure and the temperature of interest. Similarly, a typical
reference state for ionic species in aqueous solutions is the 1 molar
ideal solution at 1 bar external pressure and the temperature of
interest. If an electrolyte solution behaves ideally, then the activity
of species
         <em>
          i
         </em>
         in solution is
        </p>
        <p>
         <em>
          Eq. 86
         </em>
         $a_{i} = \frac{c_{i}\left( \frac{mol}{l} \right)}{c_{i}^{0}\left( \frac{mol}{l} \right)} = \frac{c_{i}\left( \frac{mol}{l} \right)}{1\left( \frac{mol}{l} \right)} = c_{i}(dimensionless)$
        </p>
        <p>
         where $c_{i}$ is the molar concentration of
         <em>
          i
         </em>
         in the solution divided
by $c_{i}^{0}$, the 1 molar reference state ideal solution
concentration. Thus, in ideal solutions, the activity of an electrolyte
species is numerically equal to its molar concentration. The above
treatment of ionic species is equivalent to the common practice of
depicting the activity of a gas by the value of its ideal gas partial
pressure in units of bar.
        </p>
        <p>
         The activity coefficient corrects for the nonideality of the species in
solution as defined in . If the solution is ideal, $\gamma_{i} = 1$ for
all concentrations of a species in solution. For all solutions, one
expects $\gamma_{i} \rightarrow 1$ as $c_{i} \rightarrow 1$. It is not
possible to measure $\gamma_{i^{+}}$ or $\gamma_{i^{-}}$ for individual
charged ions, only a geometric mean of the positive and negative ion
values. Consider the following ionic solution
        </p>
        <p>
         Eq. 87
        </p>
        <p>
         Its chemical potential can be written as
        </p>
        <p>
         <em>
          Eq. 88
         </em>
        </p>
        <p>
         Its geometric average or mean activity and activity coefficient are
defined as
        </p>
        <p>
         <em>
          Eq. 89
         </em>
        </p>
        <p>
         <em>
          Eq. 810
         </em>
        </p>
        <p>
         For example, one can define
$\gamma_{\pm} = \left( \gamma_{{Na}^{+}}\gamma_{{Cl}^{-}} \right)^{1/2}$
and
$\gamma_{\pm} = \left( \gamma_{{Al}^{3 +}}^{2}\gamma_{{{SO}
         <em>
          {4}}^{2 -}}^{3} \right)^{1/5}$
for NaCl and Al
          <sub>
           2
          </sub>
          (SO
          <sub>
           4
          </sub>
          )
          <sub>
           3
          </sub>
          , respectively.
For idea, weak electrolytes, $\gamma
         </em>
         {\pm} = 1$, and for non-ideal,
strong electrolytes, $\gamma_{\pm} \neq 1$.
        </p>
        <h3>
         <a href="#electrical-batteries">
          Electrical batteries
         </a>
        </h3>
        <p>
         Batteries utilize electrochemical reactions to generate electricity for
various devices. The theoretic voltage of a battery can be calculated
from and , i.e.
        </p>
        <p>
         <em>
          Eq. 873
         </em>
         $\varepsilon = - \frac{\mathrm{\Delta}G}{zf} = \varepsilon^{0} - \frac{RTlnQ}{zf}$
        </p>
        <p>
         with $\mathrm{\Delta}G$ being the driving force of the net cell reaction
and $Q$ being the reaction activity quotient. The actual voltage of a
battery is lower than the theoretical one due to kinetic limitations of
cell reactions and resistance to ion diffusion through the electrolyte.
Based on whether the cell reactions are reversible or not, batteries
typically categorized as either primary disposable or secondary
rechargeable batteries. The net cell reactions in primary disposable
batteries are not easily reversible, and electrode materials may not
return to their original forms by applying a higher external potential
of opposite sign. Consequently, primary batteries cannot be reliably
recharged. On the other hand, the net cell reactions in secondary
batteries are easily reversible. Furthermore, two half-cells in
batteries may use different electrolytes with each half-cell enclosed in
a container and a separator permeable to conducting ions but not the
bulk of the electrolytes.
        </p>
        <p>
         One common primary battery is zinc-carbon battery with a zinc anode
cylinder and a carbon cathode central rod. The electrolytes are ammonium
or zinc chloride next to the zinc anode and a mixture of ammonium
chloride and manganese dioxide next to the carbon cathode. The half cell
and net reactions with ammonium chloride are as follows
        </p>
        <p>
         <em>
          Eq. 874
         </em>
         Zn + 2NH
         <sub>
          3
         </sub>
         &rarr;
Zn(NH
         <sub>
          3
         </sub>
         )
         <sub>
          2
         </sub>
         <sup>
          2+
         </sup>
         + 2 e
         <sup>
          -
         </sup>
        </p>
        <p>
         <em>
          Eq. 875
         </em>
         2NH
         <sub>
          4
         </sub>
         Cl + 2MnO
         <sub>
          2
         </sub>
         + 2 e
         <sup>
          -
         </sup>
         &rarr;
2NH
         <sub>
          3
         </sub>
         + Mn
         <sub>
          2
         </sub>
         O
         <sub>
          3
         </sub>
         +
H
         <sub>
          2
         </sub>
         O+2Cl
         <sup>
          &minus;
         </sup>
        </p>
        <p>
         <em>
          Eq. 876
         </em>
         Zn + 2MnO
         <sub>
          2
         </sub>
         + 2NH
         <sub>
          4
         </sub>
         Cl &rarr;
Mn
         <sub>
          2
         </sub>
         O
         <sub>
          3
         </sub>
         +
Zn(NH
         <sub>
          3
         </sub>
         )
         <sub>
          2
         </sub>
         Cl
         <sub>
          2
         </sub>
         + H
         <sub>
          2
         </sub>
         O.
        </p>
        <p>
         The electric potential of the reaction is, treating all compounds as
stoichiometric compounds
        </p>
        <p>
         Eq. 877
$\varepsilon = - \frac{\mathrm{\Delta}G}{2f} = - \frac{\mathrm{\Delta}^{0}G}{2f} = \frac{1}{2f}\left(
         <em>
          {\ }^{0}G^{Zn} + 2
         </em>
         {\ }^{0}G^{{MnO}
         <em>
          {2}} + 2
         </em>
         {\ }^{0}G^{{NH}
         <em>
          {4}Cl} -
         </em>
         {\ }^{0}G^{H_{2}O} -
         <em>
          {\ }^{0}G^{Zn\left( {NH}
         </em>
         {3} \right)
         <em>
          {2}{Cl}
         </em>
         {2}} -
         <em>
          {\ }^{0}G^{{{Mn}
         </em>
         {2}O}_{3}} \right)$.
        </p>
        <p>
         The Gibbs energy of $Zn\left( {NH}
         <em>
          {3} \right)
         </em>
         {2}{Cl}_{2}$ is not
available in current databases and has been recently estimated to be
&minus;505,375 J/mole-formula [62]. The value of at 298.15K is thus obtained
as 1.67 V, which is pretty close to the actual operating voltage of the
battery around 1.5 V.
        </p>
        <p>
         While with zinc chloride, the cell reactions and electric potential may
be written as
        </p>
        <p>
         Eq. 878 Zn + ZnCl
         <sub>
          2
         </sub>
         + 2OH
         <sup>
          &minus;
         </sup>
         &rarr; 2ZnOHCl + 2
e
         <sup>
          -
         </sup>
        </p>
        <p>
         <em>
          Eq. 879
         </em>
         MnO
         <sub>
          2
         </sub>
         + H
         <sub>
          2
         </sub>
         O + e
         <sup>
          -
         </sup>
         &rarr; MnOOH +
OH
         <sup>
          -
         </sup>
        </p>
        <p>
         <em>
          Eq. 880
         </em>
         Zn + 2 MnO
         <sub>
          2
         </sub>
         + ZnCl
         <sub>
          2
         </sub>
         + 2 H
         <sub>
          2
         </sub>
         O
&rarr; 2 MnOOH + 2 ZnOHCl
        </p>
        <p>
         <em>
          Eq. 881
         </em>
         $\varepsilon = \frac{1}{2f}\left(
         <em>
          {\ }^{0}G^{Zn} + 2
         </em>
         {\ }^{0}G^{{MnO}
         <em>
          {2}} +
         </em>
         {\ }^{0}G^{Zn{Cl}
         <em>
          {2}} + 2
         </em>
         {\ }^{0}G^{H_{2}O} - 2_{\ }^{0}G^{MnOOH} - 2_{\ }^{0}G^{ZnOHCl} \right)$
        </p>
        <p>
         Secondary batteries can be recharged by applying an external electrical
potential, which reverses the net cell reaction that occur during
discharging. The oldest form of rechargeable battery is the lead-acid
batteries used in automotive, and the latest development is the
lithium-ion (Li-ion) batteries. A lead-acid battery typically uses Pb
and PbO2 as the cathode and anode electrodes and a 35% sulfuric acid and
65% water solution as the electrolyte. Its anode and cathode reactions
can be simplified as follows
        </p>
        <p>
         Eq. 882 $Pb + SO_{4}^{2 -} = PbSO_{4} + 2e^{-}$
        </p>
        <p>
         Eq. 883 $PbO_{2} + 4H^{+} + SO_{4}^{2 -} + 2e^{-} = PbSO_{4} + 2H_{2}O$
        </p>
        <p>
         The net cell reaction is
        </p>
        <p>
         Eq. 884 $Pb + PbO_{2} + 2H_{2}SO_{4}^{\ } = 2PbSO_{4} + 2H_{2}O$.
        </p>
        <p>
         Its electric potential is represented by the following equation
        </p>
        <p>
         <em>
          Eq. 885
         </em>
         $\varepsilon = - \frac{1}{2f}\left( 2_{\ }^{0}G^{H_{2}O} + 2_{\ }^{0}G^{{PbSO}
         <em>
          {4}} -
         </em>
         {\ }^{0}G^{Pb} -
         <em>
          {\ }^{0}G^{{PbO}
         </em>
         {2}} - 2_{\ }^{0}G^{H_{2}SO_{4}} \right)$
        </p>
        <p>
         with the value at 298.15K being 2.651 V calculated from Thermo-Calc
[60]. During discharging, the reaction goes to right, and $PbSO_{4}$
is formed on both anode and cathode, while during charging, the reaction
goes to the left, and $Pb$ and $PbO_{2}$ are restored. In practical
applications, other ionic species such as ${H_{3}O}^{+}$ and
$HSO_{4}^{-}$ may form in the electrolyte, complicating the reactions
and affecting its potential.
        </p>
        <p>
         In lithium ion batteries, lithium ions migrate in electrolytes between
electrodes made of intercalated lithium compounds during charging and
discharging. LiCoO
         <sub>
          2
         </sub>
         and LiFePO
         <sub>
          4
         </sub>
         are two of the
several cathode materials used in lithium ion batteries, and the anode
is typically made of carbon or metallic Li. The anode and cathode
reactions for LiCoO2 batteries can be written in simple forms as follows
        </p>
        <p>
         Eq. 886 ${Li}
         <em>
          {x}C
         </em>
         {6} = x{Li}^{+} + xe^{-} + 6C$
        </p>
        <p>
         Eq. 887 $x{Li}^{+} + xe^{-} + {Li}
         <em>
          {1 - x}CoO
         </em>
         {2} = LiCoO_{2}$
        </p>
        <p>
         with the net reaction and electric potential being
        </p>
        <p>
         Eq. 888 ${Li}
         <em>
          {x}C
         </em>
         {6} + {Li}
         <em>
          {1 - x}CoO
         </em>
         {2} = LiCoO_{2} + 6C$
        </p>
        <p>
         <em>
          Eq. 889
         </em>
         $\varepsilon = - \frac{1}{xf}\left{ 6_{\ }^{0}G^{C} +
         <em>
          {\ }^{0}G^{{LiCoO}
         </em>
         {2}} - G^{{{Li}
         <em>
          {x}C}
         </em>
         {6}} - G^{{{Li}
         <em>
          {1 - x}CoO}
         </em>
         {2}} \right} = - \frac{1}{f}\left{ \left( \mu_{Li}^{{Li}
         <em>
          {1 - x}CoO
         </em>
         {2}} - \mu_{Li}^{{Li}
         <em>
          {x}C} \right) - \frac{1}{x}\left( \mu
         </em>
         {LiCoO_{2}}^{{Li}
         <em>
          {1 - x}CoO
         </em>
         {2}} -
         <em>
          {\ }^{0}G^{{LiCoO}
         </em>
         {2}} \right) \right}$
        </p>
        <p>
         The electric potential is a function of $x$. The value in the first
parenthesis in the above equation denotes the chemical potential
difference of Li between two electrodes, and the value in the second
parenthesis represents the chemical potential difference of
${LiCoO}
         <em>
          {2}$ between the states in the solution phase of
${Li}
         </em>
         {1 - x}CoO_{2}$ and by itself. Gibbs energies of ${{Li}
         <em>
          {x}C}
         </em>
         {6}$
and ${{Li}
         <em>
          {1 - x}CoO}
         </em>
         {2}$ need to be obtained as a function $x$ in
order to calculate the electric potential of the battery.
        </p>
        <p>
         LiFePO
         <sub>
          4
         </sub>
         uses metallic lithium as the anode with following
half-cell and net cell reactions
        </p>
        <p>
         Eq. 890 $xLi = x{Li}^{+} + xe^{-}$
        </p>
        <p>
         Eq. 891 $x{Li}^{+} + xe^{-} + {Li}
         <em>
          {1 - x}FePO
         </em>
         {4} = LiFePO_{4}$
        </p>
        <p>
         Eq. 892 $xLi + {Li}
         <em>
          {1 - x}FePO
         </em>
         {4} = LiFePO_{4}$.
        </p>
        <p>
         Its electric potential is also a function of $x$, i.e.
        </p>
        <p>
         <em>
          Eq. 893
         </em>
         $\varepsilon = - \frac{1}{xf}\left{
         <em>
          {\ }^{0}G^{LiFePO
         </em>
         {4}} - x\ ^{0}G^{Li} - G^{{Li}
         <em>
          {1 - x}FePO
         </em>
         {4}} \right} = - \frac{1}{f}\left{ \left( \mu_{Li}^{{Li}
         <em>
          {1 - x}FePO
         </em>
         {4}} - \ ^{0}\mu_{Li} \right) - \frac{1}{x}\left( \mu_{LiFePO_{4}}^{{Li}
         <em>
          {1 - x}FePO
         </em>
         {4}} -
         <em>
          {\ }^{0}G^{LiFePO
         </em>
         {4}} \right) \right}$
        </p>
        <p>
         The value in the first parenthesis in the above equation denotes the
chemical potential difference of Li between two electrodes, and the
value in the second parenthesis represents the chemical potential
difference of $LiFePO_{4}$ between the states in the solution phase of
${Li}
         <em>
          {1 - x}FePO
         </em>
         {4}$ and by itself. Consequently, Gibbs energy of
${Li}
         <em>
          {1 - x}FePO
         </em>
         {4}$ needs to be obtained as a function $x$ in order
to calculate the electric potential of the battery. It is known that
there are several miscibility gaps in the $FePO_{4}$ and $LiFePO_{4}$
psuedo-binary system, in which the chemical potentials are constants, so
is the electric potential, resulting in stable battery output.
        </p>
        <h2 id="electrolyte-reactions-and-electrochemical-reactions">
         <a href="#electrolyte-reactions-and-electrochemical-reactions">
          Electrolyte reactions and electrochemical reactions
         </a>
        </h2>
        <p>
         Electrolytes that dissolve in a polar solvent such as water to produce
ionic species do not necessarily exhibit valence changes. A simple
example is the strong electrolyte NaCl(s) dissolving in water to produce
solvated ions
        </p>
        <p>
         <em>
          Eq. 81
         </em>
         $NaCl(s)\ \  = \ \ {Na}^{+}(aq)\ \  + \ \ {Cl}^{&ndash;}(aq)$
        </p>
        <p>
         where the $(aq)$ indicates the ionic species in an aqueous solution. In
this system, the ion concentrations must become quite large before the
solution is saturated and can exist in equilibrium with $NaCl(s)$. Its
reaction constant, defined by , is shown as
$K_{e} = \ \ a_{{Na}^{+}}a_{{Cl}^{-}}$. If the product of the ion
activities is less than $K_{e}$, the solution is not saturated, and more
$NaCl(s)\ \ $ can be dissolved.
        </p>
        <p>
         The precipitation of $AgCl(s)$, a weak electrolyte, occurs quite readily
when ${Cl}^{&ndash;}$ ions are added to an aqueous solution containing
${Ag}^{+}(aq)$:
        </p>
        <p>
         <em>
          Eq. 82
         </em>
         ${Ag}^{+}(aq)\  + \ \ {Cl}^{&ndash;}(aq)\  = AgCl(s)$
        </p>
        <p>
         The equilibrium constant for this reaction,
$K_{e} = \ \frac{1}{\left( a_{{Ag}^{+}}a_{{Cl}^{-}} \right)}$ is quite
large, so the equilibrium product of the ion activities, proportional to
their concentrations, is quite small. In the laboratory, the above
reaction could occur as a result of adding hydrochloric acid to a silver
nitrate solution. The accompanying $H^{+}(aq)$ [or ${H_{3}O}^{+}(aq)$]
and ${NO_{3}}^{-}(aq)$ ions in solution are not directly involved in the
silver chloride precipitation reaction so are not shown in reaction
represented by .
        </p>
        <p>
         The above ionic equilibria in the $AgCl(s) - H_{2}O$ system is not only
important for understanding this electrolyte system, but also critical
in electrochemical systems in which
         <em>
          Ag(s)
         </em>
         undergoes a valence change
at one electrode and reacts with a ${Cl}^{&ndash;}(aq)$ ion to produce
         <em>
          AgCl(s)
         </em>
         , and an electron that is externally transported finite
distances to another electrode. The
         <em>
          oxidation
         </em>
         reaction occurs at the
Ag/AgCl electrode (
         <em>
          anode
         </em>
         half-cell reaction where electrons are
         <em>
          added
         </em>
         into the system)
        </p>
        <p>
         <em>
          Eq. 83
         </em>
         $Ag(s)\ \  + \ {Cl}^{-}(aq)\ \  = \ \ AgCl(s)\ \  + \ \ e^{-}$
        </p>
        <p>
         A
         <em>
          reduction
         </em>
         reaction occurs at the other electrode (
         <em>
          cathode
         </em>
         half-cell reaction where electrons are
         <em>
          consumed
         </em>
         by the reaction)
        </p>
        <p>
         <em>
          Eq. 84
         </em>
         $\frac{1}{2}{Cl}_{2}(g) + \ \ e^{-} = \ {Cl}^{-}(aq)\ \ $
        </p>
        <p>
         The
         <em>
          net cell reaction
         </em>
         results in the formation AgCl(s) from its
elements
        </p>
        <p>
         <em>
          Eq. 85
         </em>
         $Ag(s)\ \  + \frac{1}{2}{Cl}_{2}\ (g)\  = \ \ AgCl(s)$
        </p>
        <p>
         Without knowledge of the physical system under which the reaction is
occurring, it would not be possible to know if reaction of was a result
of chlorine gas reacting directly with Ag(s), or if the reaction was
part of an electrochemical cell with a transport of electrons and ions
over finite distances. The addition of the two half-cell reactions gives
the
         <em>
          net cell reaction
         </em>
         , which does not show electrons as either
reactant or product species and may or may not include ionic species in
the reaction*.* A schematic of an electrochemical cell for the above
system is shown in Figure 81.
        </p>
        <p>
         Figure : Schematic diagram of an electrochemical cell consisting of a
chlorine electrode and a silver-silver chloride electrode.
        </p>
        <p>
         Oxidation and reduction can occur in electrolyte reactions without
creating an electrochemical cell. This is the case when chlorine gas
reacts directly with silver on a Ag(s) surface. Reaction of above is the
net reaction for this process, but the electrons produced from the
oxidation of Ag(s) are not transported over finite distances before
combining with Cl
         <sub>
          2
         </sub>
         (g) in its reduction to Cl
         <sup>
          &ndash;
         </sup>
         (aq).
No anode or cathode half-cell reactions exist in this system. The
electrons and ions involved in the reaction move only over atomic-scale
distances.
        </p>
        <h3>
         <a href="#fuel-cells">
          Fuel cells
         </a>
        </h3>
        <p>
         Fuel cells are devices to convert chemical energy to electricity and
heat through electrochemical reactions with the fuel and oxygen supplied
to the anode and cathode, respectively. Typical ions migrating through
the electrolyte are $H^{+}$, ${OH}^{-}$, ${CO}_{3}^{2 -}$, and
$O^{2 -}$. In fuel cells with $H^{+}$ as migrating ions, H
         <sub>
          2
         </sub>
         molecules are dissociated into $H^{+}$ on the anode, which are combined
with O
         <sub>
          2
         </sub>
         on the cathode to form H
         <sub>
          2
         </sub>
         O and release
heat with the half cell and the net cell reactions in their simplest
form as shown by for the anode, for the cathode, and for the net cell,
respectively. Commonly used electrolytes are polymer and phosphoric
acid, and both anode and cathode reactions are facilitated by catalyst,
typically platinum. The thermodynamic limit of power which can be
generated by the fuel cell is represented by
        </p>
        <p>
         <em>
          Eq. 863
         </em>
         $w = - \mathrm{\Delta}G = - \mathrm{\Delta}
         <em>
          {\ }^{0}G
         </em>
         {cell} + RTln\left( P_{H_{2}}P_{O_{2}}^{1/2} \right)$
        </p>
        <p>
         For fuel cells with anions as migrating ions, the anions are generated
on the cathode with H
         <sub>
          2
         </sub>
         O formed and heat generated on the
anode. Their representative cathode reactions are
        </p>
        <p>
         <em>
          Eq. 864
         </em>
         $\frac{1}{2}O_{2} + H_{2}O + 2e^{-}{= 2OH}^{-}$
        </p>
        <p>
         <em>
          Eq. 865
         </em>
         ${\frac{1}{2}O}
         <em>
          {2} + CO
         </em>
         {2} + 2e^{-} = {CO}_{3}^{2 -}$
        </p>
        <p>
         <em>
          Eq. 866
         </em>
         $\frac{1}{2}O_{2} + 2e^{-} = O^{2 -}$.
        </p>
        <p>
         The anode reaction for is the reaction represented by , operating at low
temperatures and using catalyst for both electrodes. The anode reactions
for and are
        </p>
        <p>
         <em>
          Eq. 867
         </em>
         ${CO}
         <em>
          {3}^{2 -} + H
         </em>
         {2} = H_{2}O + CO_{2} + 2e^{-}$
        </p>
        <p>
         <em>
          Eq. 868
         </em>
         $O^{2 -} + H_{2} = H_{2}O + 2e^{-}$
        </p>
        <p>
         respectively. To enable the diffusion of ${CO}_{3}^{2 -}$ and $O^{2 -}$
through the cathode and the electrolyte, both fuel cells are operated at
relative high temperatures, with the former typically in molten
carbonate solutions and the latter through solid oxides. Due to the high
operating temperatures, fuels are converted to hydrogen within the fuel
cell itself by a process called internal reforming, removing the need
for precious-metal catalyst and enabling the use of a variety of fuels.
The net cell reaction for all three fuel cells is the same as in the
case of $H^{+}$, represented by .
        </p>
        <h3>
         <a href="#half-cell-potentials">
          Half cell potentials
         </a>
        </h3>
        <p>
         When electron current flows between electrodes, reactions are occurring
at the electrodes and concentration gradients causing polarization
develop around the electrodes. These gradients result in extraneous
potentials to occur at the electrodes. In such cases cell equilibrium is
not established and measured cell potentials are not those for true
partial equilibrium. If a cell is short-circuited with the electrodes
connected by a conductor, current will flow until the external potential
becomes zero, i.e. &epsilon;
         <sub>
          ext
         </sub>
         = 0, and equilibrium is established
with same conditions as non-electrochemical systems. If an external
potential, &epsilon;
         <sub>
          ext
         </sub>
         , is applied to the cell, chemical reactions
occur until the cell potential balances to &epsilon;
         <sub>
          ext
         </sub>
         , and no
current flows. This potential is called open-circuit voltage (OCV) in
the literature. It is important to realize that OCV includes all
reactions that occur on the electrode surface when the electrode is in
contact with the electrolyte, such as passivation discussed in Chapter .
Partial equilibrium in a cell is achieved when the cell potential is
balanced by an applied external potential. In such partial equilibrium
cases, equilibrium thermodynamic analyses can be used even though the
cell potential is not zero, i.e. &epsilon;
         <sub>
          cell
         </sub>
         &ne; 0. This
differentiates electrochemical systems from other equilibrium systems
discussed previously.
        </p>
        <p>
         The number of electrons involved in a net cell reaction is important in
relating cell potential and the Gibbs energy change for the cell
reaction. As will be illustrated later in this section, this number
denotes the number of electrons involved in the half-cell reactions that
were added to yield the net cell reaction. The electrical work achieved
by the transport of an electrical charge through a cell potential can be
written as
        </p>
        <p>
         <em>
          Eq. 820
         </em>
         $w = z\ f\ \varepsilon$
        </p>
        <p>
         where
         <em>
          z
         </em>
         represents the moles of electrons in cell reaction,
         <em>
          f
         </em>
         the
Faraday constant equal to 96,485 J/V/mole-electron, and
         <em>
          &epsilon;
         </em>
         the
potential difference, often referred as electromotive force (emf) in the
literature. For a system at constant temperature, pressure, and
composition, this work is the same as the Gibbs energy difference
between the two electrodes, i.e.
        </p>
        <p>
         <em>
          Eq. 821
         </em>
         $- \Delta G = w = zf\varepsilon$
        </p>
        <p>
         where the negative sign is because the system does work to the
surrounding when the Gibbs energy of the system is decreased. When the
applied external potential is larger than the cell potential, the
surrounding does work to the system, and a common example is the
charging of a battery. Thermodynamic relations discussed in previous
chapters can thus be directly applied to electrochemical systems with
some common equations shown in .
        </p>
        <p>
         Table : Thermodynamic Equations for Electrochemical Cells
        </p>
        <p>
         <em>
          G = -z f &epsilon;
         </em>
        </p>
        <p>
         <em>
          S = - (&part;G/&part;T)P = + z f (&part;&epsilon;/&part;T)P
         </em>
        </p>
        <p>
         <em>
          H = [&part;(G/T)/ &part;(1/T)]P = - z f [&part;(&epsilon;/T)/&part;(1/T)]P = z f [T(&part;&epsilon;/&part;T)P
&ndash; &epsilon;]
         </em>
        </p>
        <p>
         <em>
          CP = (&part;H/&part;T)P = T z f (&part;2&epsilon;/&part;T2)P
         </em>
        </p>
        <p>
         A half-cell reaction potential cannot be measured directly, only its
potential relative to another half-cell reaction. By convention, a
standard half-cell potential is measured relative to the standard
hydrogen half-cell reduction reaction at 25
         <sup>
          o
         </sup>
         C (298K) and 1
bar, which has a defined standard potential of zero volts,
        </p>
        <p>
         <em>
          Eq. 822
         </em>
         H
         <sup>
          +
         </sup>
         (aq, a=1) + e
         <sup>
          -
         </sup>
         = 1/2 H
         <sub>
          2
         </sub>
         (g,
1 bar)
        </p>
        <p>
         with &epsilon;
         <sup>
          o
         </sup>
         (H
         <sup>
          +
         </sup>
         /H
         <sub>
          2
         </sub>
         ,g) = 0.00 volts. The
standard half-cell reduction reactions of metals at 25
         <sup>
          o
         </sup>
         C are
for the general reaction
        </p>
        <p>
         <em>
          Eq. 823
         </em>
         M
         <sup>
          z+
         </sup>
         (aq, a=1) + z e
         <sup>
          -
         </sup>
         = M(s)
        </p>
        <p>
         with &epsilon;
         <sup>
          o
         </sup>
         (M
         <sup>
          z+
         </sup>
         /M) volts. Half-cell reactions with
the most positive standard electrode potentials have a tendency to
spontaneously proceed toward reduction (cathode reactions). Half-cell
reactions with the most negative standard electrode potentials have a
tendency to spontaneously proceed toward oxidation (anode reactions).
        </p>
        <p>
         Consider, for example, a cell made up of a standard hydrogen electrode
and a standard zinc electrode with &epsilon;
         <sup>
          o
         </sup>
         (H
         <sup>
          +
         </sup>
         /H
         <sub>
          2
         </sub>
         ,g) = 0.00 volts and &epsilon;
         <sup>
          o
         </sup>
         (Zn
         <sup>
          2+
         </sup>
         /Zn) = -0.762 volts. Thus, the H
         <sup>
          +
         </sup>
         would tend
to be reduced, and the zinc metal would tend to be oxidized, and the
spontaneous reaction if all species had unit activities would be
        </p>
        <p>
         <em>
          Eq. 824
         </em>
         2 H
         <sup>
          +
         </sup>
         (aq, a=1)+ Zn = H
         <sub>
          2
         </sub>
         (1 bar) +
Zn
         <sup>
          2+
         </sup>
         (aq, a=1)
        </p>
        <p>
         with &epsilon;
         <sup>
          o
         </sup>
         <sub>
          cell
         </sub>
         = 0.762 volts and
$\mathrm{\Delta}
         <em>
          {\ }^{0}G = - 2
          <em>
           96485
          </em>
          \varepsilon
         </em>
         {cell}^{0}\ $. The
cathode half-cell reaction would be the same as , while the anode
half-cell reaction would be
        </p>
        <p>
         <em>
          Eq. 825
         </em>
         Zn = Zn
         <sup>
          2+
         </sup>
         (aq, a=1) + 2 e
         <sup>
          -
         </sup>
        </p>
        <p>
         When ion concentrations and H
         <sub>
          2
         </sub>
         gas do not all have unit
activities, the Gibbs energy and cell potential of the cell reaction, ,
becomes
        </p>
        <p>
         <em>
          Eq. 826
         </em>
         $\mathrm{\Delta}G = \mathrm{\Delta}
         <em>
          {\ }^{0}G + RTln\frac{a
         </em>
         {{Zn}^{2 +}}P_{H_{2}}}{\left( a_{H^{+}} \right)^{2}}$
        </p>
        <p>
         <em>
          Eq. 827
         </em>
         $\varepsilon_{cell} = \varepsilon_{cell}^{0} - \frac{RT}{zf}\ln\frac{a_{{Zn}^{2 +}}P_{H_{2}}}{\left( a_{H^{+}} \right)^{2}}$
        </p>
        <p>
         The standard reduction potentials of some common metals at
25
         <sup>
          o
         </sup>
         C are given in .
        </p>
        <p>
         Table : Standard reduction potentials of some common metals
        </p>
        <p>
         A cell reaction can be established by different half-cell reactions. For
example, the following reaction can be derived from two different cells
        </p>
        <p>
         <em>
          Eq. 828
         </em>
         $3\ {Fe}^{2 + \ }\  = \ \ 2\ {Fe}^{3 +}\ \  + \ \ Fe(s)$
        </p>
        <p>
         cell A
        </p>
        <p>
         <em>
          Eq. 829
         </em>
         $3{Fe}^{2 +} + \ 6\ e - \  = \ \ 3Fe(s)$ &epsilon;o
         <sub>
          1
         </sub>
         =
-0.440 V
        </p>
        <p>
         <em>
          Eq. 830
         </em>
         $2\ Fe(s)\ \  = \ \ 2\ {Fe}^{3 +}\ \  + \ 6\ e -$
&epsilon;o
         <sub>
          2
         </sub>
         = +0.036 V
        </p>
        <p>
         cell B
        </p>
        <p>
         <em>
          Eq. 831
         </em>
         $2{Fe}^{2 +}\  = \ 2{Fe}^{3 + \ \ } + 2\ e^{-}$
         <em>
          &epsilon;o
          <sub>
           4
          </sub>
          = -0.772 V
         </em>
        </p>
        <p>
         <em>
          Eq. 832
         </em>
         ${Fe}^{2 + \ }\  + \ 2\ e - \ \  = \ \ Fe(s)$
         <em>
          &epsilon;o
          <sub>
           5
          </sub>
          = -0.440 V
         </em>
        </p>
        <p>
         Both give the same net reaction shown by , but with 6 and 2 electrons
and standard cell potentials being &epsilon;o
         <sub>
          cell A
         </sub>
         = -0.404 V and
&epsilon;o
         <sub>
          cell B
         </sub>
         = -1.212 V, respectively. However, the standard
Gibbs energies of both cells are the same, i.e.
        </p>
        <p>
         <em>
          Eq. 833
         </em>
         $\mathrm{\Delta}_{\ }^{0}G$
         <em>
          <sub>
           cell A
          </sub>
          = -6 f (-0.404)
= + 2.424 f
         </em>
        </p>
        <p>
         <em>
          Eq. 834
         </em>
         $\mathrm{\Delta}_{\ }^{0}G$
         <em>
          <sub>
           cell B
          </sub>
          = -2 f (-1.212)
= + 2.424 f
         </em>
        </p>
        <p>
         It is shown that $\mathrm{\Delta}_{\ }^{0}G$ values are independent of
half-cell reactions and depend only on the net reaction because the net
reaction is neutral in electron and balanced in mass.
        </p>
       </fieldset>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 14 cell-14-cell_type" class="cell markdown" data-index="14" data-loc="3" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a aria-describedby="nb-markdown-label nb-cell-label " aria-labelledby="nb-cell-label 14" class="nb-anchor visually-hidden" href="#14" id="14">
        14
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-14-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-14-exec-label">
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-14-cell_type">
        markdown
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-14-exec-label" class="nb-toolbar" hidden id="cell-14" name="cell-14">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-14-start" role="none">
      </td>
      <td class="nb-end" hidden id="cell-14-end" role="none">
      </td>
      <td class="nb-source" hidden role="none">
       <textarea aria-labelledby="cell-14-in-label cell-14-exec-label nb-source-label" class="nb-source" form="cell-14" id="cell-14-source" name="source" readonly rows="3">1. extra toc. this should be generated from our content. if we do our job then the two should match.
2. split the rest on headings
3. split out the references which are the last element</textarea>
       <div aria-labelledby="cell-14-in-label cell-14-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code><span class="k">1.</span> extra toc. this should be generated from our content. if we do our job then the two should match.
<span class="k">2.</span> split the rest on headings
<span class="k">3.</span> split out the references which are the last element
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-14-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-14" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-14-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {'data': {'text/html': '<ol>\n<li>extra toc. this should be generated from our content. if we do our job then the two should match.</li>\n<li>split the rest on headings</li>\n<li>split out the references which are the last element</li>\n</ol>\n'}}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-14-loc" role="none">
       3
      </td>
      <td class="nb-outputs" role="none">
       <ol>
        <li>
         extra toc. this should be generated from our content. if we do our job then the two should match.
        </li>
        <li>
         split the rest on headings
        </li>
        <li>
         split out the references which are the last element
        </li>
       </ol>
      </td>
     </tr>
     <tr aria-labelledby="nb-cell-label 15 cell-15-cell_type" class="cell code" data-index="15" data-loc="0" data-slide_type role="listitem">
      <th class="nb-anchor" role="none" scope="row">
       <a aria-describedby="nb-code-label nb-cell-label cell-15-loc nb-loc-label" aria-labelledby="nb-cell-label 15" class="nb-anchor visually-hidden" href="#15" id="15">
        15
       </a>
      </th>
      <td class="nb-execution_count" hidden role="none">
       <label class="nb-execution_count">
        <span id="cell-15-in-label">
         In
        </span>
        <span aria-hidden="true">
         [
        </span>
        <span id="cell-15-exec-label">
         None
        </span>
        <span aria-hidden="true">
         ]
        </span>
       </label>
      </td>
      <td class="nb-cell_type" hidden role="none">
       <label id="cell-15-cell_type">
        code
       </label>
      </td>
      <td class="nb-toolbar" hidden role="none">
       <form aria-labelledby="cell-15-exec-label" class="nb-toolbar" hidden id="cell-15" name="cell-15">
        <fieldset>
         <legend>
          actions
         </legend>
         <button type="submit">
          Run Cell
         </button>
        </fieldset>
       </form>
      </td>
      <td class="nb-start" hidden id="cell-15-start" role="none">
      </td>
      <td class="nb-end" hidden id="cell-15-end" role="none">
      </td>
      <td class="nb-source" role="none">
       <textarea aria-labelledby="cell-15-in-label cell-15-exec-label nb-source-label" class="nb-source" form="cell-15" id="cell-15-source" name="source" readonly rows="0"></textarea>
       <div aria-labelledby="cell-15-in-label cell-15-exec-label" aria-roledescription="highlighted" role="group">
        <div class="highlight">
         <pre><span></span><code>
</code></pre>
        </div>
       </div>
      </td>
      <td class="nb-metadata" hidden role="none">
       <button aria-controls="cell-15-metadata" aria-describedby="nb-metadata-desc" class="nb-metadata" form="cell-15" name="metadata" onclick="openDialog()">
        metadata
       </button>
       <dialog id="cell-15-metadata">
        <form>
         <button formmethod="dialog">
          Close
         </button>
         <pre><code>
        {}
        </code></pre>
        </form>
       </dialog>
      </td>
      <td class="nb-loc" hidden id="cell-15-loc" role="none">
       0
      </td>
      <td class="nb-outputs" hidden role="none">
       <fieldset class="nb-outputs" data-outputs="0">
        <legend aria-describedby="nb-outputs-desc" hidden id="cell-15-outputs-label">
         <span>
          Out
         </span>
         <span aria-hidden="true">
          [
         </span>
         <span>
          None
         </span>
         <span aria-hidden="true">
          ]
         </span>
        </legend>
       </fieldset>
      </td>
     </tr>
    </tbody>
   </table>
  </main>
  <footer>
   <a href="2024-01-20-colgroup-schema.html" rel="prev&gt;&lt;span aria-hidden=" true">
    &lt;semantic representation of columns based on schema
   </a>
   <br>
   <a href="../xxiii/2023-12-20-interactive-html-validation.html" rel="next">
    interactive w3c validation
    <span aria-hidden="true">
     &gt;
    </span>
   </a>
   <br>
   <form aria-labelledby="nb-notebook-label" hidden id="notebook" name="notebook">
    <label>
     <input id="nb-edit-mode" name="edit" type="checkbox">
     edit mode
    </label>
    <button type="submit">
     Run
    </button>
   </form>
   <button accesskey="-" aria-controls="nb-visibility-dialog" onclick="openDialog()">
    show/hide
   </button>
   <button accesskey="?" aria-controls="nb-help" onclick="openDialog()">
    help
   </button>
   <dialog id="nb-settings">
    <form name="settings">
     <h1 id="nb-accessibility-settings-label">
      <a href="#nb-accessibility-settings-label">
       accessibility settings
      </a>
     </h1>
     <button formmethod="dialog">
      Close
     </button>
     <ul aria-labelledby="nb-accessibility-settings-label">
      <li>
       <h2 id="nb-notebook-layout-label">
        <a href="#nb-notebook-layout-label">
         notebook layout
        </a>
       </h2>
       <ul aria-labelledby="nb-notebook-layout-label">
        <li>
         <label id="nb-color-scheme-select">
          color scheme
          <select name="color-scheme">
           <option selected value="light">
            light mode
           </option>
           <option value="dark">
            dark mode
           </option>
          </select>
         </label>
        </li>
        <li>
         <label>
          <input name="horizontal-scrolling" type="checkbox">
          horizontal scrolling
         </label>
        </li>
        <li>
         <label>
          line height
          <input max="3" min="0.5" name="line-height" step="0.1" type="number" value="1.5">
         </label>
        </li>
        <li>
         <label id="nb-cell-navigation-select">
          cell navigation
          <select name="cell-navigation">
           <option selected value="list">
            list
           </option>
           <option value="table">
            table
           </option>
           <option value="region">
            region
           </option>
           <option value="presentation">
            presentation
           </option>
           <option disabled value="grid">
            grid
           </option>
           <option disabled value="treegrid">
            treegrid
           </option>
           <option disabled value="tree">
            tree
           </option>
          </select>
         </label>
        </li>
        <li>
         <label id="nb-accessibility-priority-select">
          accessibility priority
          <select name="accessibility-priority">
           <option value="AAA">
            Triple A
           </option>
           <option value="AA">
            Double A
           </option>
           <option value="A">
            Single A
           </option>
          </select>
         </label>
        </li>
        <li>
         <label>
          margin
          <input max="40" min="0" name="margin" step="5" type="number" value="5">
          %
         </label>
        </li>
        <li>
         <label>
          <input checked name="accesskey-navigation" type="checkbox">
          accesskey navigation
         </label>
        </li>
       </ul>
      </li>
      <li>
       <h2 id="nb-font-settings-label">
        <a href="#nb-font-settings-label">
         font settings
        </a>
       </h2>
       <ul aria-labelledby="nb-font-settings-label">
        <li>
         <label id="nb-font-size-select">
          font size
          <select name="font-size">
           <option value="xx-small">
            xx-small
           </option>
           <option value="x-small">
            x-small
           </option>
           <option value="small">
            small
           </option>
           <option selected value="medium">
            medium
           </option>
           <option value="120%">
            large
           </option>
           <option value="150%">
            x-large
           </option>
           <option value="200%">
            xx-large
           </option>
           <option value="300%">
            xxx-large
           </option>
           <option value="400%">
            xxxx-large
           </option>
           <option value="500%">
            xxxxx-large
           </option>
          </select>
         </label>
        </li>
        <li>
         <label id="nb-font-family-select">
          font family
          <select name="font-family">
           <option selected value="serif">
            serif
           </option>
           <option value="sans-serif">
            sans-serif
           </option>
          </select>
         </label>
        </li>
       </ul>
      </li>
      <li>
       <h2 id="nb-sound-settings-label">
        <a href="#nb-sound-settings-label">
         sound settings
        </a>
       </h2>
       <ul aria-labelledby="nb-sound-settings-label">
        <li>
         <label>
          <input name="synthetic-speech" type="checkbox">
          synthetic speech
         </label>
        </li>
        <li>
         <label>
          <input checked name="aria-live" type="checkbox">
          aria live
         </label>
        </li>
       </ul>
      </li>
     </ul>
     <details class="log">
      <summary>
       <span>
        activity log
       </span>
      </summary>
     </details>
     <table aria-labelledby="nb-activity-log-label" aria-live="polite">
      <tbody>
       <tr>
        <th hidden>
         time
        </th>
        <td>
         message
        </td>
       </tr>
      </tbody>
     </table>
    </form>
   </dialog>
   <dialog id="nb-visibility-dialog">
    <form name="visibility">
     <button formmethod="dialog">
      Close
     </button>
     <label>
      <input name="visually-hide" type="checkbox">
      visually hide
     </label>
     <fieldset disabled>
      <legend>
       visibility
      </legend>
      <table aria-label="notebook cell visibility" role="grid">
       <tbody>
        <tr>
         <th>
         </th>
         <th>
          index
         </th>
         <th>
          execution_count
         </th>
         <th>
          cell_type
         </th>
         <th>
          source
         </th>
         <th>
          outputs
         </th>
         <th>
          metadata
         </th>
         <th>
          toolbar
         </th>
         <th>
          loc
         </th>
        </tr>
        <tr class="code">
         <td>
          code
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-index-label" checked name="index" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-execution_count-label" checked name="execution_count" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-cell_type-label" name="cell_type" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-source-label" checked name="source" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-outputs-label" checked name="outputs" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-metadata-label" name="metadata" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-toolbar-label" name="toolbar" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-loc-label" name="loc" type="checkbox">
         </td>
        </tr>
        <tr class="markdown">
         <td>
          markdown
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-index-label" checked name="index" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-execution_count-label" checked name="execution_count" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-cell_type-label" name="cell_type" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-source-label" checked name="source" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-outputs-label" checked name="outputs" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-metadata-label" name="metadata" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-toolbar-label" name="toolbar" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-loc-label" name="loc" type="checkbox">
         </td>
        </tr>
        <tr class="raw">
         <td>
          raw
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-index-label" checked name="index" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-execution_count-label" checked name="execution_count" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-cell_type-label" name="cell_type" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-source-label" checked name="source" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-outputs-label" checked name="outputs" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-metadata-label" name="metadata" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-toolbar-label" name="toolbar" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-loc-label" name="loc" type="checkbox">
         </td>
        </tr>
       </tbody>
      </table>
     </fieldset>
    </form>
    <form name="expanded">
     <fieldset disabled>
      <legend>
       expand/collapse
      </legend>
      <table role="grid">
       <tbody>
        <tr>
         <th>
         </th>
         <th>
          cell
         </th>
         <th>
          source
         </th>
         <th>
          outputs
         </th>
        </tr>
        <tr class="code">
         <td>
          code
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-cell-label" checked name="cell" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-source-label" checked name="source" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-code-label nb-outputs-label" checked name="outputs" type="checkbox">
         </td>
        </tr>
        <tr class="markdown">
         <td>
          markdown
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-cell-label" checked name="cell" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-source-label" checked name="source" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-markdown-label nb-outputs-label" checked name="outputs" type="checkbox">
         </td>
        </tr>
        <tr class="raw">
         <td>
          raw
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-cell-label" checked name="cell" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-source-label" checked name="source" type="checkbox">
         </td>
         <td>
          <input aria-labelledby="nb-raw-label nb-outputs-label" checked name="outputs" type="checkbox">
         </td>
        </tr>
       </tbody>
      </table>
     </fieldset>
    </form>
    <details class="log">
     <summary>
      <span>
       activity log
      </span>
     </summary>
    </details>
    <table aria-labelledby="nb-activity-log-label" aria-live="polite">
     <tbody>
      <tr>
       <th hidden>
        time
       </th>
       <td>
        message
       </td>
      </tr>
     </tbody>
    </table>
   </dialog>
   <dialog id="nb-help">
    <h1>
     <a href="#notebook-help">
      notebook help
     </a>
    </h1>
    <form>
     <button formmethod="dialog">
      close
     </button>
     <h2 id="nb-defs-label">
      <a href="#nb-defs-label">
       definitions
      </a>
     </h2>
     <dl aria-labelledby="nb-defs-label">
      <dt id="nb-notebook-label">
       notebook
      </dt>
      <dd>
       a collections of
       <a href="#nb-cells-label">
        cells
       </a>
      </dd>
      <dd>
       <dl aria-labelledby="nb-notebook-label nb-defs-label">
        <dt id="nb-root-metadata-label">
         metadata
        </dt>
        <dd id="nb-root-metadata-desc">
         Notebook root-level metadata.
        </dd>
        <dd>
         <dl>
          <dt id="nb-kernelspec-label">
           kernelspec
          </dt>
          <dd>
           Kernel information.
          </dd>
          <dd>
           <dl aria-labelledby="nb-kernelspec-label">
            <dt>
             kernel name
            </dt>
            <dd>
             Name of the kernel specification.
            </dd>
            <dt>
             display name
            </dt>
            <dd>
             Name to display in UI.
            </dd>
           </dl>
          </dd>
          <dt id="nb-language_info-label">
           language info
          </dt>
          <dd>
           Kernel information.
          </dd>
          <dd>
           <dl aria-labelledby="nb-language_info-label">
            <dt>
             programming language
            </dt>
            <dd>
             The programming language which this kernel runs.
            </dd>
            <dt>
             <a>
              codemirror mode
             </a>
            </dt>
            <dd>
             The codemirror mode to use for code in this language.
            </dd>
            <dt>
             file extension
            </dt>
            <dd>
             The file extension for files in this language.
            </dd>
            <dt>
             mimetype
            </dt>
            <dd>
             The mimetype corresponding to files in this language.
            </dd>
            <dt>
             pygments lexer
            </dt>
            <dd>
             The pygments lexer to use for code in this language.
            </dd>
           </dl>
          </dd>
          <dt>
           title
          </dt>
          <dd>
           The title of the notebook document
          </dd>
          <dt>
           authors
          </dt>
          <dd>
           The author(s) of the notebook document
          </dd>
         </dl>
        </dd>
        <dt id="nb-cells-label">
         cells
        </dt>
        <dd id="nb-cells-desc">
         Array of cells of the current notebook.
        </dd>
       </dl>
      </dd>
      <dt id="nb-cell-label">
       cell
      </dt>
      <dd>
       <dl aria-labelledby="nb-cell-label nb-defs-label">
        <dt id="nb-index-label">
         index
        </dt>
        <dd id="nb-index-desc">
         the ordinal location of the cell in the notebook, counting begins from 1.
        </dd>
        <dt id="nb-source-label">
         source
        </dt>
        <dd id="nb-source-desc">
         Contents of the cell, represented as an array of lines.
        </dd>
        <dt id="nb-metadata-label">
         metadata
        </dt>
        <dd id="nb-metadata-desc">
         Cell-level metadata.
        </dd>
        <dd>
         <dl aria-labelledby="nb-metadata-label">
          <dt>
           name
          </dt>
          <dd>
          </dd>
          <dt>
           tags
          </dt>
          <dd>
          </dd>
          <dt id="nb-jupyter-label">
           jupyter
          </dt>
          <dd id="nb-jupyter-desc">
           Official Jupyter Metadata for Raw Cells
          </dd>
          <dd>
           <dl>
            <dt>
             source hidden
            </dt>
            <dd>
             Whether the source is hidden.
            </dd>
            <dt>
             outputs hidden
            </dt>
            <dd>
             Whether the outputs are hidden.
            </dd>
            <dt id="nb-execution-label">
             execution
            </dt>
            <dd id="nb-execution-desc">
             Execution time for the code in the cell. This tracks time at which messages are received from iopub or shell channels
            </dd>
            <dd>
             <dl aria-labelledby="nb-execution-label">
              <dt>
               execute input
              </dt>
              <dd>
               {'description': "header.date (in ISO 8601 format) of iopub channel's execute_input message. It indicates the time at which the kernel broadcasts an execute_input message to connected frontends", 'type': 'string'}
              </dd>
              <dt>
               execute reply
              </dt>
              <dd>
              </dd>
             </dl>
            </dd>
            <dt>
             collapsed
            </dt>
            <dd>
             Whether the cell's output is collapsed/expanded.
            </dd>
            <dt>
             scrolled
            </dt>
            <dd>
             Whether the cell's output is scrolled, unscrolled, or autoscrolled.
            </dd>
           </dl>
          </dd>
         </dl>
        </dd>
        <dt id="nb-cell_type-label">
         cell type
        </dt>
        <dd>
         the are three kinds of cells
         <dl aria-labelledby="nb-cell_type-label">
          <dt id="nb-code-label">
           code
          </dt>
          <dd id="nb-code-desc">
           Notebook code cell.
          </dd>
          <dt id="nb-markdown-label">
           markdown
          </dt>
          <dd id="nb-markdown-desc">
           Notebook markdown cell.
          </dd>
          <dt id="nb-raw-label">
           raw
          </dt>
          <dd id="nb-raw-desc">
           Notebook raw nbconvert cell.
          </dd>
         </dl>
        </dd>
        <dd id="nb-cell_type-desc">
         String identifying the type of cell.
        </dd>
        <dt id="nb-execution_count-label">
         execution count
        </dt>
        <dd id="nb-execution_count-desc">
         The code cell's prompt number. Will be null if the cell has not been run.
        </dd>
        <dt id="nb-outputs-label">
         outputs
        </dt>
        <dd id="nb-outputs-desc">
         Execution, display, or stream outputs.
        </dd>
        <dt id="nb-attachments-label">
         attachments
        </dt>
        <dd id="nb-attachments-desc">
         Media attachments (e.g. inline images), stored as mimebundle keyed by filename.
        </dd>
        <dt>
         lines of code
        </dt>
        <dd>
         lines of code in the cell, including whitespace.
        </dd>
       </dl>
      </dd>
      <dt id="nb-toolbar-label">
       toolbar
      </dt>
      <dd>
       composite widgets that allow for arrow key navigation
      </dd>
     </dl>
    </form>
   </dialog>
   <details class="log">
    <summary>
     <span id="nb-activity-log-label">
      activity log
     </span>
    </summary>
   </details>
   <table aria-labelledby="nb-activity-log-label" aria-live="polite">
    <tbody>
     <tr>
      <th hidden>
       time
      </th>
      <td>
       message
      </td>
     </tr>
    </tbody>
   </table>
   <a accesskey="0" href="#TOP">
    skip to top
   </a>
  </footer>
  <script>
   const BODY = document.querySelector("body"), SELECTORS = {
    "table": "table#cells",
    "body": "table#cells>tbody",
    "row": "table#cells>tbody>tr",
    "header": "table#cells>tbody>tr>th",
    "cell": "table#cells>tbody>tr>td",
}, ROLES = {
    "list": {
        "table": "presentation",
        "body": "list",
        "row": "listitem",
        "header": "none",
        "cell": "none",
    }, "table": {
        "table": "table",
        "body": "rowgroup",
        "row": "row",
        "header": "rowheader",
        "cell": "cell",
    }, "region": {
        "table": "presentation",
        "body": "presentation",
        "row": "region",
        "header": "none",
        "cell": "none",
    }, "presentation": {
        "table": "presentation",
        "body": "none",
        "row": "none",
        "header": "none",
        "cell": "none",
    }
};

function toggleColorScheme(value = null) {
    value = value === null ? document.forms.settings.elements["color-scheme"].value : value;
    let DARK = value == "dark";
    let opposite = DARK ? "light" : "dark";
    document.getElementById(`nb-${value}-highlight`).removeAttribute("media", "screen");
    document.getElementById(`nb-${opposite}-highlight`).setAttribute("media", "not screen");
    document.querySelector(`head > meta[name="color-scheme"]`).setAttribute("content", value);
    BODY.classList.toggle("dark", DARK);
    activityLog(`${value} mode activated`)
}
function toggleRole() {
    let value = document.forms.settings["cell-navigation"].value;
    for (const [k, selector] of Object.entries(SELECTORS)) {
        document.querySelectorAll(selector).forEach(
            (x) => {
                if (ROLES[value][k] == null) {
                    x.removeAttribute("role")
                } else {
                    x.setAttribute("role", ROLES[value][k])
                }
            }
        );
    }
    activityLog(`notebook cell navigation set to ${event.target.value}.`);
}
function flattenCss(x) {
    return Object.entries(x).map(x => x.join(": ")).join("; ");
}
function getStyle() {
    return {
        "--nb-font-size": document.forms.settings["font-size"].value,
        "--nb-font-family": document.forms.settings["font-family"].value,
        "--nb-margin": `${document.forms.settings.elements.margin.value}%`,
        "--nb-line-height": `${document.forms.settings.elements["line-height"].value}`,
    }
}
function setStyle(msg) {
    BODY.setAttribute("style", flattenCss(getStyle()));
    setWCAG(); toggleColorScheme(); toggleColorScheme();
    activityLog(msg);
}
function changeFont() {
    document.forms.settings["font-size"].value;
    setStyle(`font size change`);
}
function changeFontFamily() {
    let value = document.forms.settings["font-family"].value;
    setStyle(value == "serif" ? `serifs included` : `serifs removed`)
}
function activityLog(msg, silent = false, first = false) {
    document.querySelectorAll("details.log+table").forEach(
        (body, i) => {
            let tr = document.createElement("tr"),
                th = document.createElement("th"),
                time = document.createElement("time"),
                td = document.createElement("td"),
                out = document.createElement("output"),
                now = Date.now();
            time.setAttribute("datetime", now), th.setAttribute("aria-live", "off"), th.setAttribute("hidden", null);
            time.textContent = now;
            body.append(tr), th.append(time), tr.append(th), tr.append(td), td.append(out);
            silent ? out.setAttribute("aria-live", "off") : null;
            out.textContent = msg;
            if (!i && document.forms.settings.elements["synthetic-speech"].checked) {
                // a non-screen reader solution for audible activity.
                speechSynthesis.speak(new SpeechSynthesisUtterance(msg));
            }
        }
    );
};
function openDialog() {
    event.preventDefault();
    document.getElementById(event.target.getAttribute("aria-controls")).showModal();
};
const L = 37, U = 38, R = 39, D = 40;
document.querySelectorAll("table[role=grid]").forEach(
    (x) => {
        x.addEventListener("keydown", (e) => {
            let target = document.activeElement;
            let i = Array.prototype.indexOf.call(target.parentElement.parentElement.childNodes, target.parentElement);
            switch (e.code) {
                case L:
                    break
                case U:
                    break
                case R:
                    break
                case D:
                    break
            };
        })
    }
);
document.forms.settings.elements["cell-navigation"].addEventListener("change", toggleRole)

document.forms.settings.elements["color-scheme"].addEventListener("change", toggleColorScheme);
document.forms.settings.elements["font-size"].addEventListener("change", (x) => {
    setStyle("change font size");
});
document.forms.settings.elements["font-family"].addEventListener("change", changeFontFamily);
document.forms.settings.elements["synthetic-speech"].addEventListener("change", (x) => {
    activityLog("speech on")
});
document.forms.settings.elements.margin.addEventListener("change", (x) => {
    setStyle("margin changed");
});
document.forms.settings.elements["line-height"].addEventListener("change", (x) => {
    setStyle("line height changed");
});
function setWCAG() {
    var priority = document.forms.settings["accessibility-priority"].value.toLowerCase();
    ["a", "aa", "aaa"].forEach(
        (x) => {
            if (x == priority) {
                BODY.classList.add(`wcag-${x}`)
            } else {
                BODY.classList.remove(`wcag-${x}`)
            }
        }
    );
}
document.forms.settings.elements["accessibility-priority"].addEventListener("change", setWCAG);
function toggleActive() {
    if (document.forms.notebook.elements.edit.checked) {
        document.querySelectorAll("tr.cell>td>details>summary[inert]").forEach(
            x => x.removeAttribute("inert")
        );
        document.querySelectorAll("tr.cell>td>details>textarea[readonly]").forEach(
            x => x.removeAttribute("readonly")
        );
        document.querySelectorAll("tr.cell>td>form").forEach(
            x => x.removeAttribute("hidden")
        );
        activityLog("entering edit mode");
    } else {
        document.querySelectorAll("tr.cell>td>details>summary").forEach(
            x => x.setAttribute("inert", null)
        );
        document.querySelectorAll("tr.cell>td>details>textarea").forEach(
            x => x.setAttribute("readonly", null)
        );
        document.querySelectorAll("tr.cell>td>form").forEach(
            x => x.setAttribute("hidden", null)
        );
        activityLog("entering reading mode");
    }
}


document.forms.notebook.elements.edit.addEventListener("change", () => toggleActive())

function openDialogs() {
    let trigger = document.querySelector("#nb-dialogs > details");
    Array.from(
        document.querySelectorAll("#nb-dialogs dialog:not(.log)")
    ).reverse().forEach(
        x => {
            trigger.getAttribute("open") === null ? x.show() : x.close();
        }
    );
    event.target.focus();
}

document.forms.visibility['visually-hide'].addEventListener("change",
    (x) => {
        document.querySelector("main").classList.toggle("visually-hide");
        activityLog(`${event.target.checked ? "hiding" : "showing"} main content`);
    });

document.forms.settings['horizontal-scrolling'].addEventListener("change",
    (x) => {
        BODY.classList.toggle("horiz-overflow", event.target.checked);
        if (!event.target.checked) {
            document.querySelectorAll("textarea").forEach(
                (x) => {
                    x.style.width = "";
                    x.style.height = "";
                }
            )
        };
        // activityLog(`${event.target.checked ? "overflow scrol" : "showing"} main content`);
    });


function fullScreen() {
    if (!document.fullscreenElement) {
        document.querySelector("main").requestFullscreen();
    } else {
        document.exitFullscreen();
    }
}

// resizing hits the width before the height.
// width resizes trigger height resizes and height resizes need to be computed from scratch.
// we handle that logic with boolean flags when sets the width/height.
function setTextareaWidth(entry, set = null) {
    if (set === null) { return }
    if (set) {
        entry.target.style.width = "";
        let props = getComputedStyle(entry.target);
        let width = entry.target.scrollWidth,
            left = Number(props.borderLeftWidth.slice(0, -2)),
            right = Number(props.borderRightWidth.slice(0, -2));
        entry.target.style.width = `${Math.ceil(width) + Math.ceil(left) + Math.ceil(right) + 1}px`
        setTextareaHeight(entry, true);
    }
}

function setTextareaHeight(entry, reset = null) {
    if (reset === null) { return }
    let props = getComputedStyle(entry.target);
    if (reset) {
        entry.target.style.height = ""
        return setTextareaHeight(entry, false)
    } else {
        let height = entry.target.scrollHeight;
        let top = Number(props.borderTopWidth.slice(0, -2));
        let bottom = Number(props.borderBottomWidth.slice(0, -2));
        entry.target.style.height = `${Math.ceil(height) + Math.ceil(top) + Math.ceil(bottom) + 1}px`;
    }

}
let observer = new ResizeObserver(
    (entries) => {
        entries.forEach((entry) => {
            (BODY.matches(".horiz-overflow") ? setTextareaWidth : setTextareaHeight)(entry, true);
        });
    }
);

document.querySelectorAll("textarea").forEach(
    (x) => {
        observer.observe(x);
    }
);

if (!document.fullscreenEnabled) {
    document.getElementById("nb-fullscreen").setAttribute("hidden", "");
}

setStyle("initialize saved settings.")
// async function runSource(target) {
//     {
//         let pyodide = await loadPyodide();
//         pyodide.runPython(target.elements.source.value).then(
//             (x) => {
//                 console.log(x)
//             }, (x) => {
//                 console.log(x)
//             }
//         )
//         return false;
//     }
// }
// document.querySelectorAll("form.nb-toolbar").forEach((x) => {
//     x.addEventListener("submit", (event) => {
//         event.preventDefault();
//     })
// });
// document.querySelectorAll("textarea[name=source]").forEach(
//     (x) => {
//         x.addEventListener("keydown", (event) => {
//             if (event.ctrlKey && event.key === 'Enter') {
//                 runSource(event.target.form);
//             }
//         })
//     }
// );
  </script>
  <script type="application/vnd.jupyter.widget-state+json">
   {"state": {}, "version_major": 2, "version_minor": 0}
  </script>
 </body>
</html>

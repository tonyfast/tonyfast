
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="tonyfast's stuff">
      
      
      
        <link rel="canonical" href="https://tonyfast.github.io/tonyfast/xxiv/2024-01-25-mast-a11y-notebooks.html">
      
      
        <link rel="prev" href="../index.html">
      
      
        <link rel="next" href="2024-01-20-colgroup-schema.html">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../feed_rss_updated.xml">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.5">
    
    
      
        <title>transforming mast notebooks into nbconvert tempaltes. - tonyfast</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../style.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="transforming mast notebooks into nbconvert tempaltes. - tonyfast" >
      
        <meta  property="og:description"  content="tonyfast's stuff" >
      
        <meta  property="og:image"  content="https://tonyfast.github.io/tonyfast/assets/images/social/xxiv/2024-01-25-mast-a11y-notebooks.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://tonyfast.github.io/tonyfast/xxiv/2024-01-25-mast-a11y-notebooks.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="transforming mast notebooks into nbconvert tempaltes. - tonyfast" >
      
        <meta  name="twitter:description"  content="tonyfast's stuff" >
      
        <meta  name="twitter:image"  content="https://tonyfast.github.io/tonyfast/assets/images/social/xxiv/2024-01-25-mast-a11y-notebooks.png" >
      
    
    
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        
        var widgetRendererSrc = 'https://unpkg.com/@jupyter-js-widgets@*/dist/embed.js';
        
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#transforming-mast-notebooks-into-nbconvert-tempaltes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="tonyfast" class="md-header__button md-logo" aria-label="tonyfast" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            tonyfast
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              transforming mast notebooks into nbconvert tempaltes.
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/tonyfast/tonyfast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    tonyfast/tonyfast
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="tonyfast" class="md-nav__button md-logo" aria-label="tonyfast" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    tonyfast
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tonyfast/tonyfast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    tonyfast/tonyfast
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="/tonyfast/run/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run in jupyterlite
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    transforming mast notebooks into nbconvert tempaltes.
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="2024-01-25-mast-a11y-notebooks.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    transforming mast notebooks into nbconvert tempaltes.
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#closing-thoughts" class="md-nav__link">
    <span class="md-ellipsis">
      closing thoughts
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2024-01-20-colgroup-schema.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semantic representation of columns based on schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2024-01-05-docx-to-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    convertin a docx into a structured dataframe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-12-20-interactive-html-validation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    interactive w3c validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-12-15-a11y-testing-dimensions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slicing and dicing accessibility violations with exception groups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-12-13-jupyter-community-call.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    It's the Community Call Y'all
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-12-08-vnu-validator-exceptions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    generating higher resolution exceptions for the vnu validator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-12-03-axe-rules-topology.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    axe testing codes as dataframes and exceptions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-11-14-w3c-validator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    running the w3c validator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-08-24-semantically-meaningful-displays.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semantically meaningful display outputs for notebooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-08-23-semantic-lits.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semantically meaningful lists
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-08-10-semantic-code-blocks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accessibile semantics for python code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-08-03-pandas-accessors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code>pandas</code> accessors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-07-17-accessible-string-representations.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    the string is a samp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-06-26-dataframe-diagrams-figure-semantics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    a semantic dataframe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-06-21-v7-aom.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jupyter notebook v7 remediations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-03-18-pycascades-ally-talk.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A Crash Course in Digital Accessibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-03-18-ally-talk.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A Crash Course in Digital Accessibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-03-04-computational-notebooks-history.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    a sprint through history toward computional notebooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-02-28-community-demo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code>pidgy</code> literate computing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-02-19-semantic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semantic notebook structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2023-02-05-pipings.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pipes are common sugar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-24-lite-build.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    including development builds in jupyter lite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-24-system-dependency-graphs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    extracting a dependency graph from <code>importlib_metadata</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-24-whoosh-search.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    use <code>whoosh</code> to search cells/articles on disk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-18-voila-pidgy-integration.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cleaner integration of <code>pidgy</code> &amp; <code>voila</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-16-inspector-hack.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    customizing the <code>IPython</code> contextual help
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-14-links-in-markdown-tokens.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    where do all the good links go?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-12-tree-sitter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getting start with tree sitter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-12-giscus-comments.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    adding giscus comments to this blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-11-duckdb-search.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    full text search for notebooks and files using duckdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-11-extensible-metadata.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    extensible metadata in the notebook format
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-10-rara-gtfo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    restart and run all or it didn't happen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-09-notebooks-states.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    three states of python in a notebook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-07-pidgy-voila.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    running <code>pidgy</code> in <code>voila</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-04-using-diagrams.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    diagrams in jupyter and mkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-04-tfoot-dataframe.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    using <code>tfoot</code> in dataframes for more information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-02-accessible-dataframes-basic-indexes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rendering dataframes for screen readers with <code>pandas</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxiii/2023-01-01-strawberry-server.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WIP: strawberry jupyter server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-31-jupyter-config-files.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    configuration files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-31-markdownish-notebook.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    a template for exporting markdownish notebooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-30-typer-magic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    using <code>typer</code> in ipython magics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-23-mkdocs-plugin.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code>mkdocs</code> plugin for jupyter notebooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-22-pyproject-analysis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    analyzing <code>pyproject.toml</code> configurations of popular projects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-21-lite-build.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code>jupyterlite</code> blog integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-20-pyscript-nbconvert.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rendering a notebook with <code>pyscript</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-19-integrating-typer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    integrating <code>typer</code> into the blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-18-mkdocs-task.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code>doit</code> integration - a <code>mkdocs</code> example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-17-find-dependencies-in-content.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    automating blog posts to work with jupyter-lite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-16-issue-activity-graphql.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    retreiving my issue activity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-15-html-tags-study.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    all the tags i could be using
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-13-github-api-stats.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    extracting info from the github statistics api
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-09-pyproject-analysis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exploring many <code>pyproject.toml configs</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-12-05-markdown-to-doctest.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    formatting markdown it tokens as python <code>doctests</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-11-26-package-mimic-and-rel-imports.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    making <code>__main__</code> a <code>__package__</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-11-23-better-dask-shape.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unravel directories of notebooks with <code>dask</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-11-17-assignment-expression-display.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    using assignment expressions to display and assign in <code>IPython</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-11-17-assignment-expression-display.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    using assignment expressions to display and assign in <code>IPython</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-11-12-pluggy-experiments.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fumbling around with <code>pluggy</code>
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/2022-11-12-async-import.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asynchronous imports in python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-10-29-metadata-formatter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    inferring linked data from <code>IPython</code> run times.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-10-27-axe-core-playwright-python.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    invoking axe-core from python playwright
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-10-25-static-notebook-tags.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    post processing html accessibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-10-21-markdown-future.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    when markdown and python collide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-10-21-pidgy-displays.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    literate computing - interactive literate programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-10-20-meeting-link-widgets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    making meeting links
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-10-19-mobius-text.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    turn some text into a mobius surface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/2022-10-05-dask-search.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    searching notebooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxii/oct/colormap-dataframes/2021-10-11-colorizing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    what do we learn when we <em>make colormaps from dataframes</em><!-- TEASER_END -->
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  
  
  <a href="https://github.com/tonyfast/tonyfast/edit/master/docs/xxiv/2024-01-25-mast-a11y-notebooks.ipynb" title="edit.link.title" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
  </a>
  <a href="https://raw.githubusercontent.com/tonyfast/tonyfast/master/docs/xxiv/2024-01-25-mast-a11y-notebooks.ipynb" title="View source of this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
  </a>
  <a href="/tonyfast/run/lab/index.html?path=xxiv/2024-01-25-mast-a11y-notebooks.ipynb" title="Run in jupyter lite" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8l-6-6m4 18H6V4h7v5h5v11m-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26-2.09 2.09m7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26L17 15.65Z"/></svg>
  </a>


<h1 id="transforming-mast-notebooks-into-nbconvert-tempaltes">transforming mast notebooks into nbconvert tempaltes.<a class="headerlink" href="#transforming-mast-notebooks-into-nbconvert-tempaltes" title="Permanent link">¤</a></h1>
<p>this is rough, first pass of an end-to-end sketch of the MAST notebooks using dataframes and nbconvert a11y templates.</p>
<p>to build docs or a book from nbconvert templates we need to either shim into mkdocs
or build our own thing. sphinx can't because of how <code>docutils</code> is used.</p>
<p>its just easier to build our own thing. hubris, eh? lets find out.</p>
<div class="highlight"><pre><span></span><code>    <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">midgy</span><span class="o">,</span> <span class="nn">pandas</span><span class="o">,</span> <span class="nn">utils</span>
    <span class="kn">import</span> <span class="nn">nbconvert</span><span class="o">,</span> <span class="nn">html</span><span class="o">,</span> <span class="nn">nbformat</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">toolz.curried</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>culling sys module...
</pre>
</div>

<div class="highlight"><pre><span></span><code><span class="o">%%</span>
<span class="n">start</span> <span class="k">with</span> <span class="n">a</span> <span class="n">string</span> <span class="n">mapping</span> <span class="n">the</span> <span class="n">github</span> <span class="n">repository</span> <span class="n">to</span> <span class="n">disc</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">({(</span><span class="n">repo</span> <span class="o">:=</span> <span class="s2">&quot;https://github.com/spacetelescope/mast_notebooks&quot;</span><span class="p">):</span> <span class="s2">&quot;mast_notebooks&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">path</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<span class="n">the</span> <span class="n">whole</span> <span class="n">repository</span> <span class="ow">is</span> <span class="n">pretty</span> <span class="n">tedious</span> <span class="n">to</span> <span class="n">clone</span><span class="o">.</span> <span class="n">lots</span> <span class="n">of</span> <span class="n">pictures</span><span class="err">?</span> <span class="n">do</span> <span class="n">notebooks</span> <span class="n">suck</span> <span class="n">that</span> <span class="n">bad</span> <span class="n">over</span> <span class="n">a</span> <span class="n">long</span> <span class="n">time</span><span class="err">?</span>
<span class="n">better</span> <span class="n">to</span> <span class="n">use</span> <span class="n">the</span> <span class="err">`</span><span class="o">--</span><span class="n">depth</span><span class="err">`</span> <span class="n">arg</span> <span class="k">for</span> <span class="n">control</span>

        <span class="err">!</span><span class="n">git</span> <span class="n">clone</span> <span class="err">$</span><span class="n">repo</span> <span class="o">--</span><span class="n">depth</span> <span class="mi">1</span>
</code></pre></div>
<p>start with a string mapping the github repository to disc</p>
<pre><code>s = pandas.Series({(repo := "https://github.com/spacetelescope/mast_notebooks"): "mast_notebooks"}).path()
if not s.path.exists().any():
</code></pre>
<p>the whole repository is pretty tedious to clone. lots of pictures? do notebooks suck that bad over a long time?
better to use the <code>--depth</code> arg for control</p>
<pre><code>    !git clone $repo --depth 1
</code></pre>
<div class="highlight"><pre><span></span><code><span class="o">%%</span>
<span class="n">we</span> <span class="n">then</span> <span class="n">read</span> <span class="n">our</span> <span class="n">notebooks</span> <span class="n">into</span> <span class="n">the</span> <span class="err">`</span><span class="n">nbformat</span><span class="err">`</span>

    <span class="n">notebooks</span> <span class="o">=</span> <span class="p">(</span>
         <span class="k">await</span> <span class="n">s</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*.ipynb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apath</span><span class="p">()</span><span class="o">.</span><span class="n">apath</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
    <span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">nbformat</span><span class="o">.</span><span class="n">reads</span><span class="p">,</span> <span class="n">as_version</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">notebooks</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s2">&quot;nb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</code></pre></div>
<p>we then read our notebooks into the <code>nbformat</code></p>
<pre><code>notebooks = (
     await s.path.rglob("*.ipynb").apath().apath.read_text()
).apply(nbformat.reads, as_version=4)
notebooks.to_frame("nb").T
</code></pre>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/tbone/Documents/tonyfast/tonyfast/xxiv/utils.py:74: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if isinstance(s[0], (AsyncGenerator, AsyncIterable, AsyncIterator)):
/home/tbone/Documents/tonyfast/tonyfast/xxiv/utils.py:76: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if isinstance(s[0], Coroutine):
</pre>
</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>...</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
</tr>
</thead>
<tbody>
<tr>
<th>nb</th>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
<td>{'cells': [{'cell_type': 'markdown', 'id': '92...</td>
<td>{'cells': [{'cell_type': 'markdown', 'id': '57...</td>
<td>{'cells': [{'cell_type': 'markdown', 'metadata...</td>
</tr>
</tbody>
</table>
<p>1 rows × 66 columns</p>
</div></div>

<div class="highlight"><pre><span></span><code><span class="o">%%</span>
<span class="n">generating</span> <span class="n">the</span> <span class="n">html</span> <span class="n">versions</span> <span class="n">of</span> <span class="n">the</span> <span class="n">noteboosk</span> <span class="n">causes</span> <span class="n">some</span> <span class="n">errors</span> <span class="ow">in</span> <span class="n">the</span> <span class="err">`</span><span class="n">PythonLexer</span><span class="err">`</span><span class="o">.</span> 
<span class="n">these</span> <span class="n">are</span> <span class="n">new</span> <span class="n">issues</span> <span class="ow">and</span> <span class="n">i</span> <span class="n">need</span> <span class="n">to</span> <span class="n">investigate</span> <span class="n">them</span><span class="o">.</span>
<span class="err">`</span><span class="n">nbconvert</span><span class="err">`</span> <span class="ow">is</span> <span class="n">really</span> <span class="n">sluggish</span><span class="o">.</span> <span class="n">it</span> <span class="n">would</span> <span class="n">be</span> <span class="n">sooooo</span> <span class="n">much</span> <span class="n">to</span> <span class="n">invoke</span> <span class="k">async</span> <span class="err">`</span><span class="n">jinja2</span><span class="err">`</span> <span class="n">templates</span> <span class="n">ourselves</span> <span class="n">so</span> <span class="n">we</span> <span class="n">don</span><span class="s1">&#39;t die of boredom.</span>

    <span class="n">htmls</span> <span class="o">=</span> <span class="n">notebooks</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">nbconvert</span><span class="o">.</span><span class="n">get_exporter</span><span class="p">(</span><span class="s2">&quot;a11y&quot;</span><span class="p">)()</span><span class="o">.</span><span class="n">from_notebook_node</span><span class="p">)</span>
    <span class="n">htmls</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</code></pre></div>
<p>generating the html versions of the noteboosk causes some errors in the <code>PythonLexer</code>. 
these are new issues and i need to investigate them.
<code>nbconvert</code> is really sluggish. it would be sooooo much to invoke async <code>jinja2</code> templates ourselves so we don't die of boredom.</p>
<pre><code>htmls = notebooks.apply(nbconvert.get_exporter("a11y")().from_notebook_node)
htmls.to_frame("html").T
</code></pre>
<div class="output_subarea output_stream output_stdout output_text">
<pre>pip install mastcasjobs
 'PythonLexer' object has no attribute 'lower'
pip install mastcasjobs
 'PythonLexer' object has no attribute 'lower'
By the end of this tutorial, you will:

- Understand how to use aperture photometry to turn a series of two-dimensional
  images into a one-dimensional time series.
- Be able to determine the most useful aperture for photometry on a *Kepler/K2*
  target.
- Create your own light curve for a single quarter/campaign of *Kepler/K2* data.
 'PythonLexer' object has no attribute 'lower'
## Section 1

Intro to Section 1

### Subsection 1a

More detailed info about Section 1

## Section 2

A complete thought that's as important as Section 1 but doesn't need subsections.

 'PythonLexer' object has no attribute 'lower'
- No. 0 (Primary): This HDU contains metadata related to the entire file.
- No. 1 (Light curve): This HDU contains a binary table that holds data like
  flux measurements and times. We will extract information from here when we
  define the parameters for the light curve plot.
- No. 2 (Aperture): This HDU contains the image extension with data collected
  from the aperture. We will also use this to display a bitmask plot that
  visually represents the optimal aperture used to create the SAP_FLUX column in
  HDU1.

 'PythonLexer' object has no attribute 'lower'
If you use `astropy` or `lightkurve` for published research, please cite the
authors. Follow these links for more information about citing `astropy` and
`lightkurve`:

* [Citing `astropy`](https://www.astropy.org/acknowledging.html)
* [Citing `lightkurve`](http://docs.lightkurve.org/about/citing.html)

 'PythonLexer' object has no attribute 'lower'
</pre>
</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>...</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
<th>https://github.com/spacetelescope/mast_notebooks</th>
</tr>
</thead>
<tbody>
<tr>
<th>html</th>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
<td>(&lt;!DOCTYPE html&gt;\n&lt;html lang="en"&gt;\n &lt;head&gt;\n ...</td>
</tr>
</tbody>
</table>
<p>1 rows × 66 columns</p>
</div></div>

<div class="highlight"><pre><span></span><code><span class="o">%%</span> 
<span class="n">make</span> <span class="n">iframes</span> <span class="n">to</span> <span class="n">view</span> <span class="n">examples</span> <span class="n">here</span><span class="o">.</span> <span class="n">i</span><span class="s1">&#39;ll post like 5 for example.</span>

    <span class="n">iframe</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;iframe height=&quot;600&quot; srcdoc=&quot;</span><span class="si">{}</span><span class="s2">&quot; width=&quot;100%&quot;&gt;&lt;/iframe&gt;&quot;&quot;&quot;</span>
    <span class="n">iframes</span> <span class="o">=</span> <span class="n">htmls</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compose_left</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">,</span> <span class="n">iframe</span><span class="o">.</span><span class="n">format</span><span class="p">))</span>

    <span class="n">display</span><span class="p">(</span><span class="o">*</span><span class="n">iframes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">HTML</span><span class="p">))</span>
</code></pre></div>
<p>make iframes to view examples here. i'll post like 5 for example.</p>
<pre><code>iframe = """&lt;iframe height="600" srcdoc="{}" width="100%"&gt;&lt;/iframe&gt;"""
iframes = htmls.apply(compose_left(first, html.escape, iframe.format))

display(*iframes.iloc[:5].apply(HTML))
</code></pre>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/tbone/mambaforge/envs/p311/lib/python3.11/site-packages/IPython/core/display.py:431: UserWarning: Consider using IPython.display.IFrame instead
  warnings.warn("Consider using IPython.display.IFrame instead")
</pre>
</div>
<div class="output_html rendered_html output_subarea"><iframe height="600" srcdoc="&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
 &lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; name=&quot;viewport&quot;&gt;
  &lt;title&gt;
   Notebook
  &lt;/title&gt;
  &lt;meta content=&quot;light&quot; name=&quot;color-scheme&quot;&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js&quot;&gt;
  &lt;/script&gt;
  &lt;style type=&quot;text/css&quot;&gt;
   /* # accessible css configurations

we define these high level variables to allow for configuration during use and testing.
we are not sure what the preferred default values are for these any accessible notebooks features.
the variables specify critical degrees of freedom in the notebook style.

## notebook interface specific css variables

*/

:root {
    --nb-focus-width: 3px;
    --nb-accent-color: auto;
    --nb-background-color-dark: #2b2a33;
    --nb-background-color-light: #FFFFFF;
    --nb-margin: 5%;
    --nb-font-size: 16px;
    --nb-font-family: serif;
    --nb-line-height: 1.5;
}

/* map css variables to css properties on the `body` elements.
this mapping turns out css variables into user interfaces. */

body {
    font-size: var(--nb-font-size);
    font-family: var(--nb-font-family);
    accent-color: var(--nb-accent-color);
    margin-left: var(--nb-margin);
    margin-right: var(--nb-margin);
    line-height: var(--nb-line-height);
    width: calc(100% - 2*var(--nb-margin));
}

/* ## notebook settings

the notebook settings interface connects configurable css features to the user.
we use dialog elements to represents an element that should be hidden by default.
it turns out there are two ways to layout `dialog` elements. 
they can be used as modals or block elements.
we extract this dual purpose to provide both configurations to the user.

*/

dialog form&gt;* {
    display: block;
}

#nb-dialogs details[open]~dialog {
    position: relative;
}


/* ## wcag accessibility guidelines as a feature

flexibility is the future of assistive interfaces.
it is not in the purvey of privileged developers and inaccessible systems to decide what priority accessibility is.
it is the fucking priority.

in this implementation, we want to satisfy broad user needs by making a lot of features configurable.
one configurable feature is the accessibility priority. 
experienced developers may need less assistive features as they spend more time with an interface.

### buttons sizes

WCAG 2.1 defines a huge stinking AAA hit size for buttons. its beautiful.

/* satisfy AAA 2.5.5 */

.wcag-aaa button,
.wcag-aaa input[type=checkbox] {
    min-height: 44px;
    min-width: 44px;
}

.wcag-aaa a {
    font-size: max(44px, var(--nb-font-size));
}


/* WCAG 2.2 clarified a AA button size that is used to style checkboxes and buttons. */
/* satisfy AA 2.5.8 minimum target requirement */
.wcag-aa button,
.wcag-aa input[type=checkbox] {
    min-height: 24px;
    min-width: 24px;
}

.wcag-aa a {
    font-size: max(24px, var(--nb-font-size));
}

/* ### native textareas for AAA priority.

our AAA priority choices often ensure that third party libraries can not compromise the accessibility of notebook.
the design decisions are focused native elements so that the assistive technology users have consistent expectations and outcomes.

*/

.wcag-a textarea[name=source],
.wcag-aa textarea[name=source],
.wcag-aaa textarea[name=source]~* {
    display: none;
}


/* ## notebook components layout */

td[role=&quot;none&quot;]:not([hidden]) {
    display: unset;
}

#cells tr.cell,
#cells tbody {
    display: flex;
    flex-direction: column;
}

[reversed]#cells tbody {
    flex-direction: column-reverse;
}

/* hide the visual output area when there are no outputs. 
assistive technologies will recieve an audible notification that there are not outputs. */

fieldset[data-outputs=&quot;0&quot;] {
    display: none;
}

/* ## modifications to html defaults 

### focus 

there nothing to be said about this topic that [sara soueidan](https://www.sarasoueidan.com/blog/focus-indicators/) hasn't said.
we start with her [universal focus recommendation](https://www.sarasoueidan.com/blog/focus-indicators/#a-%E2%80%98universal%E2%80%99-focus-indicator).

*/



.cell:focus-within,
:focus-visible {
    outline: max(var(--nb-focus-width), 1px) solid;
    box-shadow: 0 0 0 calc(2 * max(var(--nb-focus-width), 1px));
}


/* on firefox, the input and output become interactive when there is overflow. chrome fixed this recently find reference.*/
textarea[name=source],
.cell&gt;td&gt;details {
    overflow: auto;
    min-width: 0;
}

#nb-settings li::marker,
summary[inert]::marker {
    content: &quot;&quot;;
}

/* ### inheriting styles */

input,
select,
button {
    font-family: inherit;
    font-size: inherit;
}

textarea {
    font-family: monospace;
    font-size: inherit;
    line-height: inherit;
    overflow: auto;
    color: unset;
}

textarea[name=source] {
    box-sizing: border-box;
    width: 100%;
    resize: vertical;
}


/* align checkboxes with buttons */
input[type=&quot;checkbox&quot;] {
    vertical-align: middle;
}

/* ## custom class selectors */

#nb-dialogs details:not([open])~dialog:not([open]):not(:focus-within):not(:active),
/* legend:not(:focus-within):not(:active), */
details.log:not([open])+table,
.visually-hidden:not(:focus-within):not(:active) {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 1px;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}
  &lt;/style&gt;
  &lt;style id=&quot;nb-light-theme&quot; media=&quot;screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-light-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #0969da4a }
.c { color: #66707b } /* Comment */
.err { color: #a0111f } /* Error */
.k { color: #a0111f } /* Keyword */
.l { color: #702c00 } /* Literal */
.n { color: #622cbc } /* Name */
.o { color: #024c1a } /* Operator */
.p { color: #24292f } /* Punctuation */
.ch { color: #66707b } /* Comment.Hashbang */
.cm { color: #66707b } /* Comment.Multiline */
.cp { color: #66707b } /* Comment.Preproc */
.cpf { color: #66707b } /* Comment.PreprocFile */
.c1 { color: #66707b } /* Comment.Single */
.cs { color: #66707b } /* Comment.Special */
.gd { color: #023b95 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #a0111f } /* Generic.Error */
.gh { color: #023b95 } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #023b95 } /* Generic.Subheading */
.kc { color: #023b95 } /* Keyword.Constant */
.kd { color: #a0111f } /* Keyword.Declaration */
.kn { color: #a0111f } /* Keyword.Namespace */
.kp { color: #a0111f } /* Keyword.Pseudo */
.kr { color: #a0111f } /* Keyword.Reserved */
.kt { color: #a0111f } /* Keyword.Type */
.ld { color: #702c00 } /* Literal.Date */
.m { color: #702c00 } /* Literal.Number */
.s { color: #023b95 } /* Literal.String */
.na { color: #702c00 } /* Name.Attribute */
.nb { color: #702c00 } /* Name.Builtin */
.nc { color: #023b95 } /* Name.Class */
.no { color: #023b95 } /* Name.Constant */
.nd { color: #702c00 } /* Name.Decorator */
.ni { color: #024c1a } /* Name.Entity */
.ne { color: #622cbc } /* Name.Exception */
.nf { color: #023b95 } /* Name.Function */
.nl { color: #702c00 } /* Name.Label */
.nn { color: #24292f } /* Name.Namespace */
.nx { color: #622cbc } /* Name.Other */
.py { color: #023b95 } /* Name.Property */
.nt { color: #024c1a } /* Name.Tag */
.nv { color: #702c00 } /* Name.Variable */
.ow { color: #622cbc } /* Operator.Word */
.pm { color: #24292f } /* Punctuation.Marker */
.w { color: #24292f } /* Text.Whitespace */
.mb { color: #702c00 } /* Literal.Number.Bin */
.mf { color: #702c00 } /* Literal.Number.Float */
.mh { color: #702c00 } /* Literal.Number.Hex */
.mi { color: #702c00 } /* Literal.Number.Integer */
.mo { color: #702c00 } /* Literal.Number.Oct */
.sa { color: #023b95 } /* Literal.String.Affix */
.sb { color: #023b95 } /* Literal.String.Backtick */
.sc { color: #023b95 } /* Literal.String.Char */
.dl { color: #023b95 } /* Literal.String.Delimiter */
.sd { color: #023b95 } /* Literal.String.Doc */
.s2 { color: #023b95 } /* Literal.String.Double */
.se { color: #023b95 } /* Literal.String.Escape */
.sh { color: #023b95 } /* Literal.String.Heredoc */
.si { color: #023b95 } /* Literal.String.Interpol */
.sx { color: #023b95 } /* Literal.String.Other */
.sr { color: #023b95 } /* Literal.String.Regex */
.s1 { color: #023b95 } /* Literal.String.Single */
.ss { color: #023b95 } /* Literal.String.Symbol */
.bp { color: #702c00 } /* Name.Builtin.Pseudo */
.fm { color: #023b95 } /* Name.Function.Magic */
.vc { color: #702c00 } /* Name.Variable.Class */
.vg { color: #702c00 } /* Name.Variable.Global */
.vi { color: #702c00 } /* Name.Variable.Instance */
.vm { color: #702c00 } /* Name.Variable.Magic */
.il { color: #702c00 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;style id=&quot;nb-dark-theme&quot; media=&quot;not  screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-dark-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #58a6ff70 }
.c { color: #d9dee3 } /* Comment */
.err { color: #ff9492 } /* Error */
.k { color: #ff9492 } /* Keyword */
.l { color: #ffb757 } /* Literal */
.n { color: #dbb7ff } /* Name */
.o { color: #72f088 } /* Operator */
.p { color: #C9D1D9 } /* Punctuation */
.ch { color: #d9dee3 } /* Comment.Hashbang */
.cm { color: #d9dee3 } /* Comment.Multiline */
.cp { color: #d9dee3 } /* Comment.Preproc */
.cpf { color: #d9dee3 } /* Comment.PreprocFile */
.c1 { color: #d9dee3 } /* Comment.Single */
.cs { color: #d9dee3 } /* Comment.Special */
.gd { color: #91cbff } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #ff9492 } /* Generic.Error */
.gh { color: #91cbff } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #91cbff } /* Generic.Subheading */
.kc { color: #91cbff } /* Keyword.Constant */
.kd { color: #ff9492 } /* Keyword.Declaration */
.kn { color: #ff9492 } /* Keyword.Namespace */
.kp { color: #ff9492 } /* Keyword.Pseudo */
.kr { color: #ff9492 } /* Keyword.Reserved */
.kt { color: #ff9492 } /* Keyword.Type */
.ld { color: #ffb757 } /* Literal.Date */
.m { color: #ffb757 } /* Literal.Number */
.s { color: #91cbff } /* Literal.String */
.na { color: #ffb757 } /* Name.Attribute */
.nb { color: #ffb757 } /* Name.Builtin */
.nc { color: #91cbff } /* Name.Class */
.no { color: #91cbff } /* Name.Constant */
.nd { color: #ffb757 } /* Name.Decorator */
.ni { color: #72f088 } /* Name.Entity */
.ne { color: #dbb7ff } /* Name.Exception */
.nf { color: #91cbff } /* Name.Function */
.nl { color: #ffb757 } /* Name.Label */
.nn { color: #C9D1D9 } /* Name.Namespace */
.nx { color: #dbb7ff } /* Name.Other */
.py { color: #91cbff } /* Name.Property */
.nt { color: #72f088 } /* Name.Tag */
.nv { color: #ffb757 } /* Name.Variable */
.ow { color: #dbb7ff } /* Operator.Word */
.pm { color: #C9D1D9 } /* Punctuation.Marker */
.w { color: #C9D1D9 } /* Text.Whitespace */
.mb { color: #ffb757 } /* Literal.Number.Bin */
.mf { color: #ffb757 } /* Literal.Number.Float */
.mh { color: #ffb757 } /* Literal.Number.Hex */
.mi { color: #ffb757 } /* Literal.Number.Integer */
.mo { color: #ffb757 } /* Literal.Number.Oct */
.sa { color: #91cbff } /* Literal.String.Affix */
.sb { color: #91cbff } /* Literal.String.Backtick */
.sc { color: #91cbff } /* Literal.String.Char */
.dl { color: #91cbff } /* Literal.String.Delimiter */
.sd { color: #91cbff } /* Literal.String.Doc */
.s2 { color: #91cbff } /* Literal.String.Double */
.se { color: #91cbff } /* Literal.String.Escape */
.sh { color: #91cbff } /* Literal.String.Heredoc */
.si { color: #91cbff } /* Literal.String.Interpol */
.sx { color: #91cbff } /* Literal.String.Other */
.sr { color: #91cbff } /* Literal.String.Regex */
.s1 { color: #91cbff } /* Literal.String.Single */
.ss { color: #91cbff } /* Literal.String.Symbol */
.bp { color: #ffb757 } /* Name.Builtin.Pseudo */
.fm { color: #91cbff } /* Name.Function.Magic */
.vc { color: #ffb757 } /* Name.Variable.Class */
.vg { color: #ffb757 } /* Name.Variable.Global */
.vi { color: #ffb757 } /* Name.Variable.Instance */
.vm { color: #ffb757 } /* Name.Variable.Magic */
.il { color: #ffb757 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;!-- Load mathjax --&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe&quot;&gt;
  &lt;/script&gt;
  &lt;!-- MathJax configuration --&gt;
  &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
   init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: &quot;AMS&quot;,
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], [&quot;\\(&quot;,&quot;\\)&quot;] ],
                    displayMath: [ ['$$','$$'], [&quot;\\[&quot;,&quot;\\]&quot;] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue([&quot;Typeset&quot;, MathJax.Hub]);
        }
    }
    init_mathjax();
  &lt;/script&gt;
  &lt;!-- End of mathjax configuration --&gt;
  &lt;script type=&quot;module&quot;&gt;
   document.addEventListener(&quot;DOMContentLoaded&quot;, async () =&gt; {
    const diagrams = document.querySelectorAll(&quot;.jp-Mermaid &gt; pre.mermaid&quot;);
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import(&quot;https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.5.0/mermaid.esm.min.mjs&quot;)).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue(&quot;--jp-ui-font-family&quot;),
      theme: document.querySelector(&quot;body[data-jp-theme-light='true']&quot;)
        ? &quot;default&quot;
        : &quot;dark&quot;,
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement(&quot;img&quot;);
      const doc = parser.parseFromString(svg, &quot;image/svg+xml&quot;);
      const svgEl = doc.querySelector(&quot;svg&quot;);
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector(&quot;title&quot;);
      const firstDesc = doc.querySelector(&quot;desc&quot;);

      img.setAttribute(&quot;src&quot;, `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute(&quot;alt&quot;, firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement(&quot;figcaption&quot;);
        caption.className = &quot;sr-only&quot;;
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = &quot;&quot;;
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement(&quot;details&quot;);
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement(&quot;summary&quot;);
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement(&quot;pre&quot;);
      const code = document.createElement(&quot;code&quot;);
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement(&quot;pre&quot;);
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement(&quot;div&quot;);
      el.style.visibility = &quot;hidden&quot;;
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        const { svg } = await mermaid.render(id, raw, el);
        results = makeMermaidImage(svg);
        output = document.createElement(&quot;figure&quot;);
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add(&quot;jp-mod-warning&quot;);
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add(&quot;jp-RenderedMermaid&quot;);
      parent.appendChild(output);
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
  &lt;/script&gt;
  &lt;style&gt;
   .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details &gt; pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary &gt; pre {
    display: inline-block;
    white-space: normal;
  }
  &lt;/style&gt;
  &lt;!-- End of mermaid configuration --&gt;
 &lt;/head&gt;
 &lt;body class=&quot;wcag-aa&quot;&gt;
  &lt;header aria-label=&quot;site header&quot;&gt;
   &lt;a href=&quot;#1&quot; id=&quot;TOP&quot;&gt;
    skip to main content
   &lt;/a&gt;
  &lt;/header&gt;
  &lt;main aria-labelledby=&quot;nb-notebook-label&quot;&gt;
   &lt;section aria-labelledby=&quot;nb-toc&quot;&gt;
    &lt;details open&gt;
     &lt;summary id=&quot;toc&quot;&gt;
      &lt;span id=&quot;nb-toc&quot;&gt;
       table of contents
      &lt;/span&gt;
     &lt;/summary&gt;
     &lt;a id=&quot;nb-toc-start&quot;&gt;
     &lt;/a&gt;
     &lt;ol aria-labelledby=&quot;nb-toc&quot;&gt;
     &lt;/ol&gt;
     &lt;ol&gt;
      &lt;li&gt;
       &lt;a href=&quot;#intermediate-retrieve-tess-pixel-response-function-images&quot;&gt;
        Intermediate: Retrieve TESS Pixel Response Function Images
       &lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;
         &lt;a href=&quot;#description-of-the-prf-retrieval-code&quot;&gt;
          Description of the PRF retrieval code
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#required-software&quot;&gt;
          Required Software
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#code-to-retrieve-a-tess-prf-image&quot;&gt;
          Code to retrieve a TESS PRF image
         &lt;/a&gt;
         &lt;ol&gt;
          &lt;li&gt;
           &lt;a href=&quot;#determine-the-name-of-the-prf-based-on-ccd-camera-and-sector&quot;&gt;
            Determine the name of the PRF based on ccd camera and sector
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#read-in-one-prf-fits-file&quot;&gt;
            Read in one PRF FITS File
           &lt;/a&gt;
          &lt;/li&gt;
         &lt;/ol&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#the-main-functions&quot;&gt;
          The main functions
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#obtain-a-prf-at-a-particular-image-location&quot;&gt;
          Obtain a PRF at a particular image location
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#sample-of-prfs-across-the-chip&quot;&gt;
          Sample of PRFs across the chip
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#sample-the-prf-at-sub-pixel-locations&quot;&gt;
          Sample the PRF at sub-pixel locations.
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#compare-the-prf-to-an-image&quot;&gt;
          Compare the PRF to an Image
         &lt;/a&gt;
         &lt;ol&gt;
          &lt;li&gt;
           &lt;a href=&quot;#use-tesscut-to-retrieve-a-13x13-square-image-from-a-calibrated-ffi&quot;&gt;
            Use Tesscut to retrieve a 13x13 square image from a calibrated FFI
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#determine-the-column-and-row-of-the-central-pixel&quot;&gt;
            Determine the column and row of the central pixel
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#determine-the-location-of-the-star&quot;&gt;
            Determine the location of the star
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#look-up-sector-camera-and-ccd&quot;&gt;
            Look up Sector, Camera, and CCD
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#plot-the-sub-pixel-prfs&quot;&gt;
            Plot the sub-pixel PRFs
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#compare-prf-and-ffi-cutout&quot;&gt;
            Compare PRF and FFI cutout
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#residuals&quot;&gt;
            Residuals
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#summary&quot;&gt;
            Summary
           &lt;/a&gt;
          &lt;/li&gt;
         &lt;/ol&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#about-this-notebook&quot;&gt;
          About this Notebook
         &lt;/a&gt;
         &lt;ol&gt;
          &lt;li&gt;
           &lt;a href=&quot;#assert-statements&quot;&gt;
            Assert Statements
           &lt;/a&gt;
          &lt;/li&gt;
         &lt;/ol&gt;
        &lt;/li&gt;
       &lt;/ol&gt;
      &lt;/li&gt;
     &lt;/ol&gt;
    &lt;/details&gt;
   &lt;/section&gt;
   &lt;table id=&quot;cells&quot; role=&quot;presentation&quot;&gt;
    &lt;tbody aria-labelledby=&quot;nb-notebook-label nb-cells-label&quot; role=&quot;list&quot;&gt;
     &lt;tr hidden&gt;
      &lt;th scope=&quot;col&quot;&gt;
       index
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       execution_count
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       cell_type
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       toolbar
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       started_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       completed_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       source
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       loc
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       metadata
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       outputs
      &lt;/th&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 1 cell-1-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;1&quot; data-loc=&quot;20&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;1&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-1-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 1&quot; href=&quot;#1&quot; id=&quot;1&quot;&gt;
        1
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-1-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-1-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-1&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-1-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-1-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-1&quot; name=&quot;cell-1&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-1-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-1-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-1-source-label nb-source-label&quot; form=&quot;cell-1&quot; id=&quot;cell-1-source&quot; name=&quot;source&quot; readonly rows=&quot;20&quot;&gt;# Intermediate: Retrieve TESS Pixel Response Function Images
The Transiting Exoplanet Survey Satelite (TESS) takes time series data with 4 cameras across much of the sky.  The mission provides a product called the Pixel Response Function (PRF). The PRF is a model that describes the image of a point source and how it varies depending on where it lands on the detector. The shape of the image comes from the optical point spread function, jitter during observations, as well as the intra-pixel location of where the light lands.  These PRFs can be used to fit the data to obtain precise locations or brightness of stars. This notebook shows you how to open the FITS-formatted PRF images and calculate a PRF model for a specific location on a detector. 

More information about the PRF can be found in the [TESS Archive Manual.](https://outerspace.stsci.edu/display/TESS/TESS+Archive+Manual) The PRF models were created by the mission by fitting to micro-dithered data taken during PRF commissioning exercises. See the Instrument Handbook for details on the data collection. 

The pixel response functions in FITS or Matlab format and are available from the [models/prf_fitsfiles](https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/) directory at MAST. There are 25 sub-pixel sampled PRF image for an evenly spaced grid across each of the 16 CCDs and cameras. Each CCD/camera combination is in its own subdirectory at MAST. The column and row information is specified in the file name.  A 13x13 PRF image is provided for 9x9 subpixel locations, allowing you a tenth of pixel precision without having to interpolate.  The 9x9 grid of 13x13 images are interwoven into one 117x117 image, making retrieving the exact sub-pixel location a bit tricky.

There is no package to retrieve or work with the PRFs. So this tutorial starts by defining some functions to make it easier to parse the files and retrieve the PRF we are looking for. Each function is documented, but a quick overview is given below.   

If you just want to understand the shapes of the PRFs, skip ahead to the section [Obtain PRF at an image location](#obtain_PRF).


### Description of the PRF retrieval code
The primary function (`getPrfAtColRowFits`) takes a column, row, ccd, camera and sector and returns a 13x13 image of the best PRF interpolated from the grid of PRFs provided in the files.  It uses the ccd, camera and sector information to determine the name of the relevant PRF file in `pathLookup`. Then `determineClosestTessColRow` uses the requested row and column, finds the 4 nearest positions on the detector for which the mission provided a PRF file. Open those files and pull out the appropriate sub-pixel image. Once the four 13x13 sub-pixel PRF images are extracted, `interpolatePrf` interpolates them to the specfied pixel location. The main function then returns this interpolated PRF image.

### Required Software
- astropy.io
- numpy
- matplotlib
- astroquery.mast&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gh&quot; title=&quot;Generic.Heading&quot;&gt;# Intermediate: Retrieve TESS Pixel Response Function Images&lt;/span&gt;
The Transiting Exoplanet Survey Satelite (TESS) takes time series data with 4 cameras across much of the sky.  The mission provides a product called the Pixel Response Function (PRF). The PRF is a model that describes the image of a point source and how it varies depending on where it lands on the detector. The shape of the image comes from the optical point spread function, jitter during observations, as well as the intra-pixel location of where the light lands.  These PRFs can be used to fit the data to obtain precise locations or brightness of stars. This notebook shows you how to open the FITS-formatted PRF images and calculate a PRF model for a specific location on a detector. 

More information about the PRF can be found in the [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;TESS Archive Manual.&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://outerspace.stsci.edu/display/TESS/TESS+Archive+Manual&lt;/span&gt;) The PRF models were created by the mission by fitting to micro-dithered data taken during PRF commissioning exercises. See the Instrument Handbook for details on the data collection. 

The pixel response functions in FITS or Matlab format and are available from the [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;models/prf_fitsfiles&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&lt;/span&gt;) directory at MAST. There are 25 sub-pixel sampled PRF image for an evenly spaced grid across each of the 16 CCDs and cameras. Each CCD/camera combination is in its own subdirectory at MAST. The column and row information is specified in the file name.  A 13x13 PRF image is provided for 9x9 subpixel locations, allowing you a tenth of pixel precision without having to interpolate.  The 9x9 grid of 13x13 images are interwoven into one 117x117 image, making retrieving the exact sub-pixel location a bit tricky.

There is no package to retrieve or work with the PRFs. So this tutorial starts by defining some functions to make it easier to parse the files and retrieve the PRF we are looking for. Each function is documented, but a quick overview is given below.   

If you just want to understand the shapes of the PRFs, skip ahead to the section [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Obtain PRF at an image location&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#obtain_PRF&lt;/span&gt;).


&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Description of the PRF retrieval code&lt;/span&gt;
The primary function (&lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`getPrfAtColRowFits`&lt;/span&gt;) takes a column, row, ccd, camera and sector and returns a 13x13 image of the best PRF interpolated from the grid of PRFs provided in the files.  It uses the ccd, camera and sector information to determine the name of the relevant PRF file in &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`pathLookup`&lt;/span&gt;. Then &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`determineClosestTessColRow`&lt;/span&gt; uses the requested row and column, finds the 4 nearest positions on the detector for which the mission provided a PRF file. Open those files and pull out the appropriate sub-pixel image. Once the four 13x13 sub-pixel PRF images are extracted, &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`interpolatePrf`&lt;/span&gt; interpolates them to the specfied pixel location. The main function then returns this interpolated PRF image.

&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Required Software&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;astropy.io
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;numpy
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;matplotlib
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;astroquery.mast
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-1-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-1&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-1-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-1-loc&quot; role=&quot;none&quot;&gt;
       20
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h1 id=&quot;intermediate-retrieve-tess-pixel-response-function-images&quot;&gt;
        &lt;a href=&quot;#intermediate-retrieve-tess-pixel-response-function-images&quot;&gt;
         Intermediate: Retrieve TESS Pixel Response Function Images
        &lt;/a&gt;
       &lt;/h1&gt;
       &lt;p&gt;
        The Transiting Exoplanet Survey Satelite (TESS) takes time series data with 4 cameras across much of the sky.  The mission provides a product called the Pixel Response Function (PRF). The PRF is a model that describes the image of a point source and how it varies depending on where it lands on the detector. The shape of the image comes from the optical point spread function, jitter during observations, as well as the intra-pixel location of where the light lands.  These PRFs can be used to fit the data to obtain precise locations or brightness of stars. This notebook shows you how to open the FITS-formatted PRF images and calculate a PRF model for a specific location on a detector.
       &lt;/p&gt;
       &lt;p&gt;
        More information about the PRF can be found in the
        &lt;a href=&quot;https://outerspace.stsci.edu/display/TESS/TESS+Archive+Manual&quot;&gt;
         TESS Archive Manual.
        &lt;/a&gt;
        The PRF models were created by the mission by fitting to micro-dithered data taken during PRF commissioning exercises. See the Instrument Handbook for details on the data collection.
       &lt;/p&gt;
       &lt;p&gt;
        The pixel response functions in FITS or Matlab format and are available from the
        &lt;a href=&quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;&gt;
         models/prf_fitsfiles
        &lt;/a&gt;
        directory at MAST. There are 25 sub-pixel sampled PRF image for an evenly spaced grid across each of the 16 CCDs and cameras. Each CCD/camera combination is in its own subdirectory at MAST. The column and row information is specified in the file name.  A 13x13 PRF image is provided for 9x9 subpixel locations, allowing you a tenth of pixel precision without having to interpolate.  The 9x9 grid of 13x13 images are interwoven into one 117x117 image, making retrieving the exact sub-pixel location a bit tricky.
       &lt;/p&gt;
       &lt;p&gt;
        There is no package to retrieve or work with the PRFs. So this tutorial starts by defining some functions to make it easier to parse the files and retrieve the PRF we are looking for. Each function is documented, but a quick overview is given below.
       &lt;/p&gt;
       &lt;p&gt;
        If you just want to understand the shapes of the PRFs, skip ahead to the section
        &lt;a href=&quot;#obtain_PRF&quot;&gt;
         Obtain PRF at an image location
        &lt;/a&gt;
        .
       &lt;/p&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#description-of-the-prf-retrieval-code&quot;&gt;
         Description of the PRF retrieval code
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        The primary function (
        &lt;code&gt;
         getPrfAtColRowFits
        &lt;/code&gt;
        ) takes a column, row, ccd, camera and sector and returns a 13x13 image of the best PRF interpolated from the grid of PRFs provided in the files.  It uses the ccd, camera and sector information to determine the name of the relevant PRF file in
        &lt;code&gt;
         pathLookup
        &lt;/code&gt;
        . Then
        &lt;code&gt;
         determineClosestTessColRow
        &lt;/code&gt;
        uses the requested row and column, finds the 4 nearest positions on the detector for which the mission provided a PRF file. Open those files and pull out the appropriate sub-pixel image. Once the four 13x13 sub-pixel PRF images are extracted,
        &lt;code&gt;
         interpolatePrf
        &lt;/code&gt;
        interpolates them to the specfied pixel location. The main function then returns this interpolated PRF image.
       &lt;/p&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#required-software&quot;&gt;
         Required Software
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;ul&gt;
        &lt;li&gt;
         &lt;a href=&quot;http://astropy.io&quot;&gt;
          astropy.io
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         numpy
        &lt;/li&gt;
        &lt;li&gt;
         matplotlib
        &lt;/li&gt;
        &lt;li&gt;
         astroquery.mast
        &lt;/li&gt;
       &lt;/ul&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 2 cell-2-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;2&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;2&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-2-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 2&quot; href=&quot;#2&quot; id=&quot;2&quot;&gt;
        2
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-2-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-2-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-2&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-2-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-2-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-2&quot; name=&quot;cell-2&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-2-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-2-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-2-source-label nb-source-label&quot; form=&quot;cell-2&quot; id=&quot;cell-2-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;----&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;----
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-2-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-2&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-2-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-2-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 3 cell-3-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;3&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;3&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-3-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 3&quot; href=&quot;#3&quot; id=&quot;3&quot;&gt;
        3
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-3-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-3-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-3&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-3-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-3-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-3&quot; name=&quot;cell-3&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-3-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-3-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-3-source-label nb-source-label&quot; form=&quot;cell-3&quot; id=&quot;cell-3-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;## Code to retrieve a TESS PRF image&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Code to retrieve a TESS PRF image&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-3-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-3&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-3-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-3-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;code-to-retrieve-a-tess-prf-image&quot;&gt;
        &lt;a href=&quot;#code-to-retrieve-a-tess-prf-image&quot;&gt;
         Code to retrieve a TESS PRF image
        &lt;/a&gt;
       &lt;/h2&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 4 cell-4-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;4&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;4&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-4-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 4&quot; href=&quot;#4&quot; id=&quot;4&quot;&gt;
        4
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-4-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-4-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-4&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-4-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-4-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-4&quot; name=&quot;cell-4&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-4-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-4-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-4-source-label nb-source-label&quot; form=&quot;cell-4&quot; id=&quot;cell-4-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;from astropy.io import fits
import numpy as np
import os
import matplotlib.pyplot as plt&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astropy.io&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;plt&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-4-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-4&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-4-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-4-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-4-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 5 cell-5-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;5&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;5&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-5-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 5&quot; href=&quot;#5&quot; id=&quot;5&quot;&gt;
        5
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-5-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-5-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-5&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-5-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-5-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-5&quot; name=&quot;cell-5&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-5-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-5-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-5-source-label nb-source-label&quot; form=&quot;cell-5&quot; id=&quot;cell-5-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;### Determine the name of the PRF based on ccd camera and sector&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Determine the name of the PRF based on ccd camera and sector&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-5-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-5&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-5-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-5-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#determine-the-name-of-the-prf-based-on-ccd-camera-and-sector&quot;&gt;
         Determine the name of the PRF based on ccd camera and sector
        &lt;/a&gt;
       &lt;/h3&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 6 cell-6-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;6&quot; data-loc=&quot;48&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;6&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-6-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 6&quot; href=&quot;#6&quot; id=&quot;6&quot;&gt;
        6
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-6-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-6-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-6&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-6-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-6-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-6&quot; name=&quot;cell-6&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-6-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-6-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-6-source-label nb-source-label&quot; form=&quot;cell-6&quot; id=&quot;cell-6-source&quot; name=&quot;source&quot; readonly rows=&quot;48&quot;&gt;def pathLookup(ccd, camera, sector):
    &quot;&quot;&quot;
    Gets the datestring and the subdirectory for the specified PRF. 
    The datestring and directory name can be found from the ccd, camera and sector.

    Inputs
    -------
    ccd
        (int) number of the TESS ccd. Accepts values from 1-4.
    camera
        (int) number of the TESS camera. Accepts values from 1-4
    sector
        (int) number of the TESS sector. Accepts values of 1 and above.

    Returns
    -------
    datestring
        (str) Date string used in the TESS prf files name.
    add_path
        (str) Directory name where the TESS PRF is stored. (e.g. &quot;/start_s0001/&quot;)
    &quot;&quot;&quot; 
    if sector &amp;lt; 1:
        raise ValueError(&quot;Sector must be greater than 0.&quot;)
    if (camera &amp;gt; 4) | (ccd &amp;gt; 4):
        raise ValueError(&quot;Camera or CCD is larger than 4.&quot;)

    if sector &amp;lt;= 3:
        add_path = &quot;/start_s0001/&quot;
        datestring = &quot;2018243163600&quot;

        if camera &amp;gt;= 3:
            datestring = &quot;2018243163601&quot;
        elif (camera == 2) &amp;amp; (ccd == 4):
            datestring = &quot;2018243163601&quot;

    else:
        add_path = &quot;/start_s0004/&quot;
        datestring = &quot;2019107181900&quot;
        if (camera == 1) &amp;amp; (ccd &amp;gt;= 2):
            datestring = &quot;2019107181901&quot;
        elif (camera == 2):
            datestring = &quot;2019107181901&quot;
        elif (camera == 3) &amp;amp; (ccd &amp;gt;= 2) :
            datestring = &quot;2019107181902&quot;
        elif (camera == 4):
            datestring = &quot;2019107181902&quot;

    return datestring, add_path&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;pathLookup&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Gets the datestring and the subdirectory for the specified PRF. &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    The datestring and directory name can be found from the ccd, camera and sector.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Inputs&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    -------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ccd&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) number of the TESS ccd. Accepts values from 1-4.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    camera&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) number of the TESS camera. Accepts values from 1-4&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    sector&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) number of the TESS sector. Accepts values of 1 and above.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    -------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    datestring&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (str) Date string used in the TESS prf files name.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    add_path&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (str) Directory name where the TESS PRF is stored. (e.g. &quot;/start_s0001/&quot;)&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt; 
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot; title=&quot;Name.Exception&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;Sector must be greater than 0.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot; title=&quot;Name.Exception&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;Camera or CCD is larger than 4.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;add_path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;/start_s0001/&quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;2018243163600&quot;&lt;/span&gt;

        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;2018243163601&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;2018243163601&quot;&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;add_path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;/start_s0004/&quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;2019107181900&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;2019107181901&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;2019107181901&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;2019107181902&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;2019107181902&quot;&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;add_path&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-6-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-6&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-6-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-6-loc&quot; role=&quot;none&quot;&gt;
       48
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-6-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 7 cell-7-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;7&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;7&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-7-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 7&quot; href=&quot;#7&quot; id=&quot;7&quot;&gt;
        7
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-7-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-7-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-7&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-7-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-7-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-7&quot; name=&quot;cell-7&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-7-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-7-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-7-source-label nb-source-label&quot; form=&quot;cell-7&quot; id=&quot;cell-7-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;### Read in one PRF FITS File&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Read in one PRF FITS File&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-7-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-7&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-7-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-7-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#read-in-one-prf-fits-file&quot;&gt;
         Read in one PRF FITS File
        &lt;/a&gt;
       &lt;/h3&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 8 cell-8-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;8&quot; data-loc=&quot;63&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;8&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-8-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 8&quot; href=&quot;#8&quot; id=&quot;8&quot;&gt;
        8
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-8-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-8-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-8&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-8-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-8-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-8&quot; name=&quot;cell-8&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-8-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-8-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-8-source-label nb-source-label&quot; form=&quot;cell-8&quot; id=&quot;cell-8-source&quot; name=&quot;source&quot; readonly rows=&quot;63&quot;&gt;def readOnePrfFitsFile(ccd, camera, col, row, path, datestring):
    &quot;&quot;&quot;
    reads in the full, interleaved prf Array for a single row,col,ccd,camera location.

    Inputs
    -------
    ccd
        (int) CCD number
    camera
        (int) Camera number
    col
        (float) Specific column where the PRF was sampled.
    row
        (float) Specific row where the PRF was sampled.
    path
        (string) The full path of the data file. Can be the MAST Web address

    Returns
    ------
    prfArray
        (np array) Full 117 x 117 interleaved prf Array for the requested file.      
    &quot;&quot;&quot;

    fn = &quot;cam%u_ccd%u/tess%13s-prf-%1u-%1u-row%04u-col%04u.fits&quot; % \
        (camera, ccd, datestring, camera, ccd, row, col)

    filepath = os.path.join(path, fn)
    hdulistObj = fits.open(filepath)
    prfArray = hdulistObj[0].data

    return prfArray

def determineFourClosestPrfLoc(col, row):
    &quot;&quot;&quot;
    Determine the four pairs of col,row positions of your target. 
    These are specific to TESS and where they chose to report their PRFs.
    Inputs
    ------
    col
        (float) Column position
    row
        (float) Row position.

    Returns
    -------
    imagePos
        (list) A list of (col,row) pairs.
    &quot;&quot;&quot;

    posRows = np.array([1, 513, 1025, 1536, 2048])
    posCols = np.array([45, 557, 1069, 1580,2092])

    difcol = np.abs(posCols - col)
    difrow = np.abs(posRows - row)

    # Expand out to the four image position to interpolate between,
    # Return as a list of tuples.
    imagePos = []
    for r in posRows[np.argsort(difrow)[0:2]]:
        for c in posCols[np.argsort(difcol)[0:2]]:
            imagePos.append((c,r))

    return imagePos&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;readOnePrfFitsFile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    reads in the full, interleaved prf Array for a single row,col,ccd,camera location.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Inputs&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    -------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ccd&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) CCD number&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    camera&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) Camera number&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    col&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (float) Specific column where the PRF was sampled.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    row&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (float) Specific row where the PRF was sampled.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    path&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (string) The full path of the data file. Can be the MAST Web address&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    prfArray&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (np array) Full 117 x 117 interleaved prf Array for the requested file.      &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;cam&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%u&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;_ccd&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%u&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;/tess&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%13s&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;-prf-&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%1u&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%1u&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;-row&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%04u&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;-col&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%04u&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;.fits&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; \
        &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;filepath&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulistObj&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;filepath&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulistObj&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt;

&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;determineFourClosestPrfLoc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Determine the four pairs of col,row positions of your target. &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    These are specific to TESS and where they chose to report their PRFs.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Inputs&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    col&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (float) Column position&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    row&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (float) Row position.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    -------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    imagePos&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (list) A list of (col,row) pairs.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;posRows&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;513&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1025&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1536&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2048&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;posCols&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;557&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1069&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1580&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2092&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;difcol&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;posCols&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;difrow&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;posRows&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Expand out to the four image position to interpolate between,&lt;/span&gt;
    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Return as a list of tuples.&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;posRows&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;argsort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;difrow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]]:&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;posCols&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;argsort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;difcol&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]]:&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-8-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-8&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-8-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-8-loc&quot; role=&quot;none&quot;&gt;
       63
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-8-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 9 cell-9-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;9&quot; data-loc=&quot;73&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;9&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-9-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 9&quot; href=&quot;#9&quot; id=&quot;9&quot;&gt;
        9
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-9-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-9-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-9&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-9-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-9-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-9&quot; name=&quot;cell-9&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-9-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-9-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-9-source-label nb-source-label&quot; form=&quot;cell-9&quot; id=&quot;cell-9-source&quot; name=&quot;source&quot; readonly rows=&quot;73&quot;&gt;def getOffsetsFromPixelFractions(col, row):
    &quot;&quot;&quot;
    Determine just the fractional part (the intra-pixel part) of the col,row position.  
    For example, if (col, row) = (123.4, 987.6), then
    (colFrac, rowFrac) = (.4, .6). 

    Function then returns the offset necessary for addressing the interleaved PRF array.
    to ensure you get the location appropriate for your sub-pixel values.

    Inputs
    ------
    col
        (float) Column position
    row
        (float) Row position.

    Returns
    ------
    (colFrac, rowFrac)
       (int, int) offset necessary for addressing the interleaved PRF array.
    &quot;&quot;&quot;
    gridSize = 9

    colFrac = np.remainder(float(col), 1)
    rowFrac = np.remainder(float(row), 1)

    colOffset = gridSize - np.round(gridSize * colFrac) - 1
    rowOffset = gridSize - np.round(gridSize * rowFrac) - 1

    return int(colOffset), int(rowOffset)

def getRegSampledPrfFitsByOffset(prfArray, colOffset, rowOffset):
    &quot;&quot;&quot;
    The 13x13 pixel PRFs on at each grid location are sampled at a 9x9 intra-pixel grid, to
    describe how the PRF changes as the star moves by a fraction of a pixel in row or column.
    To extract out a single PRF, you need to address the 117x117 array in a funny way
    (117 = 13x9). Essentially you need to pull out every 9th element in the array, i.e.

    .. code-block:: python

        img = array[ [colOffset, colOffset+9, colOffset+18, ...],
                     [rowOffset, rowOffset+9, ...] ]

    Inputs
    ------
    prfArray
        117x117 interleaved PRF array
    colOffset, rowOffset
        The offset used to address the column and row in the interleaved PRF

    Returns
    ------
    prf
        13x13 PRF image for the specified column and row offset

    &quot;&quot;&quot;
    gridSize = 9

    assert colOffset &amp;lt; gridSize
    assert rowOffset &amp;lt; gridSize

    # Number of pixels in regularly sampled PRF. Should be 13x13
    nColOut, nRowOut = prfArray.shape
    nColOut /= float(gridSize)
    nRowOut /= float(gridSize)

    iCol = colOffset + (np.arange(nColOut) * gridSize).astype(int)
    iRow = rowOffset + (np.arange(nRowOut) * gridSize).astype(int)

    tmp = prfArray[iRow, :]
    prf = tmp[:,iCol]

    return prf
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;getOffsetsFromPixelFractions&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Determine just the fractional part (the intra-pixel part) of the col,row position.  &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    For example, if (col, row) = (123.4, 987.6), then&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    (colFrac, rowFrac) = (.4, .6). &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Function then returns the offset necessary for addressing the interleaved PRF array.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    to ensure you get the location appropriate for your sub-pixel values.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Inputs&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    col&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (float) Column position&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    row&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (float) Row position.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    (colFrac, rowFrac)&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;       (int, int) offset necessary for addressing the interleaved PRF array.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;9&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colFrac&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;remainder&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowFrac&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;remainder&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colFrac&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowFrac&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;getRegSampledPrfFitsByOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    The 13x13 pixel PRFs on at each grid location are sampled at a 9x9 intra-pixel grid, to&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    describe how the PRF changes as the star moves by a fraction of a pixel in row or column.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    To extract out a single PRF, you need to address the 117x117 array in a funny way&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    (117 = 13x9). Essentially you need to pull out every 9th element in the array, i.e.&lt;/span&gt;

&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    .. code-block:: python&lt;/span&gt;

&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        img = array[ [colOffset, colOffset+9, colOffset+18, ...],&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;                     [rowOffset, rowOffset+9, ...] ]&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Inputs&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    prfArray&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        117x117 interleaved PRF array&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    colOffset, rowOffset&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        The offset used to address the column and row in the interleaved PRF&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    prf&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        13x13 PRF image for the specified column and row offset&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;9&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Number of pixels in regularly sampled PRF. Should be 13x13&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nColOut&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nRowOut&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;shape&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nColOut&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nRowOut&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;iCol&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nColOut&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;iRow&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nRowOut&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;gridSize&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;iRow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;iCol&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-9-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-9&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-9-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-9-loc&quot; role=&quot;none&quot;&gt;
       73
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-9-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 10 cell-10-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;10&quot; data-loc=&quot;39&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-10-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 10&quot; href=&quot;#10&quot; id=&quot;10&quot;&gt;
        10
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-10-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-10-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-10&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-10-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-10-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-10&quot; name=&quot;cell-10&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-10-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-10-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-10-source-label nb-source-label&quot; form=&quot;cell-10&quot; id=&quot;cell-10-source&quot; name=&quot;source&quot; readonly rows=&quot;39&quot;&gt;def interpolatePrf(regPrfArray, col, row, imagePos):
    &quot;&quot;&quot;
    Interpolate between 4 images to find the best PRF at the specified column and row.
    This is a simple linear interpolation.

    Inputs
    -------
    regPrfArray 
        13x13x4 prf image array of the four nearby locations.

    col and row 
        (float) the location to interpolate to.

    imagePos
        (list) 4 floating point (col, row) locations

    Returns
    ----
    Single interpolated PRF image.
    &quot;&quot;&quot;
    p11, p21, p12, p22 = regPrfArray
    c0 = imagePos[0][0]
    c1 = imagePos[1][0]
    r0 = imagePos[0][1]
    r1 = imagePos[2][1]

    assert c0 != c1
    assert r0 != r1

    dCol = (col-c0) / (c1-c0)
    dRow = (row-r0) / (r1 - r0)

    # Intpolate across the rows
    tmp1 = p11 + (p21 - p11) * dCol
    tmp2 = p12 + (p22 - p12) * dCol

    # Interpolate across the columns
    out = tmp1 + (tmp2-tmp1) * dRow
    return out&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;interpolatePrf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;regPrfArray&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Interpolate between 4 images to find the best PRF at the specified column and row.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    This is a simple linear interpolation.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Inputs&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    -------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    regPrfArray &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        13x13x4 prf image array of the four nearby locations.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    col and row &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (float) the location to interpolate to.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    imagePos&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (list) 4 floating point (col, row) locations&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ----&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Single interpolated PRF image.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p11&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p21&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p12&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p22&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;regPrfArray&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c0&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r0&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c0&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c1&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r0&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r1&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dCol&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c1&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dRow&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;r0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Intpolate across the rows&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p11&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p21&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p11&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dCol&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p12&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p22&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;p12&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dCol&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Interpolate across the columns&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tmp2&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tmp1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dRow&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;out&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-10-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-10&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-10-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-10-loc&quot; role=&quot;none&quot;&gt;
       39
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-10-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 11 cell-11-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;11&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-11-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 11&quot; href=&quot;#11&quot; id=&quot;11&quot;&gt;
        11
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-11-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-11-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-11&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-11-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-11-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-11&quot; name=&quot;cell-11&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-11-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-11-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-11-source-label nb-source-label&quot; form=&quot;cell-11&quot; id=&quot;cell-11-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;## The main functions
We define two main functions.  The first, `getNearestPrfFits`, returns only the PRF in the grid of 25x25 PRF locations provided by the mission that is nearest to the (column, row) location specified.  The second, `getPrfAtColRowFits`, does a linear interpolation between the four PRFs nearest to the location specified and returns that PRF.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## The main functions&lt;/span&gt;
We define two main functions.  The first, &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`getNearestPrfFits`&lt;/span&gt;, returns only the PRF in the grid of 25x25 PRF locations provided by the mission that is nearest to the (column, row) location specified.  The second, &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`getPrfAtColRowFits`&lt;/span&gt;, does a linear interpolation between the four PRFs nearest to the location specified and returns that PRF.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-11-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-11&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-11-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-11-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;the-main-functions&quot;&gt;
        &lt;a href=&quot;#the-main-functions&quot;&gt;
         The main functions
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        We define two main functions.  The first,
        &lt;code&gt;
         getNearestPrfFits
        &lt;/code&gt;
        , returns only the PRF in the grid of 25x25 PRF locations provided by the mission that is nearest to the (column, row) location specified.  The second,
        &lt;code&gt;
         getPrfAtColRowFits
        &lt;/code&gt;
        , does a linear interpolation between the four PRFs nearest to the location specified and returns that PRF.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 12 cell-12-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;12&quot; data-loc=&quot;43&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-12-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 12&quot; href=&quot;#12&quot; id=&quot;12&quot;&gt;
        12
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-12-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-12-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-12&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-12-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-12-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-12&quot; name=&quot;cell-12&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-12-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-12-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-12-source-label nb-source-label&quot; form=&quot;cell-12&quot; id=&quot;cell-12-source&quot; name=&quot;source&quot; readonly rows=&quot;43&quot;&gt;def getNearestPrfFits(col, row, ccd, camera, sector, path):
    &quot;&quot;&quot;
    Main Function
    Return a 13x13 PRF image for a single location. No interpolation

    This function is identical to getPrfAtColRowFits except it does not perform the interpolation step.

    Inputs
    ---------
    col, row
        (floats) Location on CCD to lookup. The origin of the CCD is the bottom left.
        Increasing column increases the &quot;x-direction&quot;, and row increases the &quot;y-direction&quot;
        The column coordinate system starts at column 45.
    ccd
        (int) CCD number. There are 4 CCDs per camera
    camera
        (int) Camera number. The instrument has 4 cameras
    sector
        (int)  Sector number, greater than or equal to 1.

    Returns
    ---------
    A 13x13 numpy image array of the nearest PRF to the specifed column and row.
    &quot;&quot;&quot;
    col = float(col)
    row = float(row)
    prfImages = []

    # Determine a datestring in the file name and the path based on ccd/camer/sector
    datestring, addPath = pathLookup(ccd, camera, sector)
    path = path + addPath

    # Convert the fractional pixels to the offset required for the interleaved pixels.
    colOffset, rowOffset = getOffsetsFromPixelFractions(col, row)

    # Determine the 4 (col,row) locations with exact PRF measurements.
    imagePos = determineFourClosestPrfLoc(col, row)
    bestPos = imagePos[0]
    prfArray = readOnePrfFitsFile(ccd, camera, bestPos[0], bestPos[1], path, datestring)

    prfImage = getRegSampledPrfFitsByOffset(prfArray, colOffset, rowOffset)       

    return prfImage&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;getNearestPrfFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Main Function&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Return a 13x13 PRF image for a single location. No interpolation&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    This function is identical to getPrfAtColRowFits except it does not perform the interpolation step.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Inputs&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ---------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    col, row&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (floats) Location on CCD to lookup. The origin of the CCD is the bottom left.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        Increasing column increases the &quot;x-direction&quot;, and row increases the &quot;y-direction&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        The column coordinate system starts at column 45.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ccd&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) CCD number. There are 4 CCDs per camera&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    camera&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) Camera number. The instrument has 4 cameras&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    sector&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int)  Sector number, greater than or equal to 1.&lt;/span&gt;

&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ---------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    A 13x13 numpy image array of the nearest PRF to the specifed column and row.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfImages&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[]&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Determine a datestring in the file name and the path based on ccd/camer/sector&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;addPath&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pathLookup&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;addPath&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Convert the fractional pixels to the offset required for the interleaved pixels.&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getOffsetsFromPixelFractions&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Determine the 4 (col,row) locations with exact PRF measurements.&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;determineFourClosestPrfLoc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bestPos&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;readOnePrfFitsFile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bestPos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bestPos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfImage&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getRegSampledPrfFitsByOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;       

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfImage&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-12-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-12&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-12-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-12-loc&quot; role=&quot;none&quot;&gt;
       43
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-12-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 13 cell-13-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;13&quot; data-loc=&quot;49&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-13-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 13&quot; href=&quot;#13&quot; id=&quot;13&quot;&gt;
        13
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-13-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-13-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-13&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-13-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-13-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-13&quot; name=&quot;cell-13&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-13-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-13-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-13-source-label nb-source-label&quot; form=&quot;cell-13&quot; id=&quot;cell-13-source&quot; name=&quot;source&quot; readonly rows=&quot;49&quot;&gt;def getPrfAtColRowFits(col, row, ccd, camera, sector, path):
    &quot;&quot;&quot;
    Main Function
    Lookup a 13x13 PRF image for a single location

    Inputs
    ---------
    col, row
        (floats) Location on CCD to lookup. The origin of the CCD is the bottom left.
        Increasing column increases the &quot;x-direction&quot;, and row increases the &quot;y-direction&quot;
        The column coordinate system starts at column 45.
    ccd
        (int) CCD number. There are 4 CCDs per camera
    camera
        (int) Camera number. The instrument has 4 cameras
    sector
        (int)  Sector number, greater than or equal to 1.
    path
        (str) Directory or URL where the PRF fits files are located

    Returns
    ---------
    A 13x13 numpy image array of the interpolated PRF.
    &quot;&quot;&quot;
    col = float(col)
    row = float(row)
    prfImages = []

    # Determine a datestring in the file name and the path based on ccd/camera/sector
    datestring, subDirectory = pathLookup(ccd, camera, sector)
    path = path + subDirectory

    # Convert the fractional pixels to the offset required for the interleaved pixels.
    colOffset, rowOffset = getOffsetsFromPixelFractions(col, row)

    # Determine the 4 (col,row) locations with exact PRF measurements.
    imagePos = determineFourClosestPrfLoc(col, row)

    # Loop over the 4 locations and read in each file and extract the sub-pixel location.
    for pos in imagePos:
            prfArray = readOnePrfFitsFile(ccd, camera, pos[0], pos[1], path, datestring)

            img = getRegSampledPrfFitsByOffset(prfArray, colOffset, rowOffset)       
            prfImages.append(img)

    # Simple linear interpolate across the 4 locations.
    interpolatedPrf = interpolatePrf(prfImages, col, row, imagePos)

    return interpolatedPrf&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Main Function&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Lookup a 13x13 PRF image for a single location&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Inputs&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ---------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    col, row&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (floats) Location on CCD to lookup. The origin of the CCD is the bottom left.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        Increasing column increases the &quot;x-direction&quot;, and row increases the &quot;y-direction&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        The column coordinate system starts at column 45.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ccd&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) CCD number. There are 4 CCDs per camera&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    camera&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int) Camera number. The instrument has 4 cameras&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    sector&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (int)  Sector number, greater than or equal to 1.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    path&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;        (str) Directory or URL where the PRF fits files are located&lt;/span&gt;

&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    ---------&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    A 13x13 numpy image array of the interpolated PRF.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfImages&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[]&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Determine a datestring in the file name and the path based on ccd/camera/sector&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subDirectory&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pathLookup&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subDirectory&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Convert the fractional pixels to the offset required for the interleaved pixels.&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getOffsetsFromPixelFractions&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Determine the 4 (col,row) locations with exact PRF measurements.&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;determineFourClosestPrfLoc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Loop over the 4 locations and read in each file and extract the sub-pixel location.&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;readOnePrfFitsFile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;datestring&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getRegSampledPrfFitsByOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfArray&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rowOffset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;       
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfImages&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Simple linear interpolate across the 4 locations.&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;interpolatedPrf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;interpolatePrf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prfImages&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imagePos&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;interpolatedPrf&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-13-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-13&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-13-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-13-loc&quot; role=&quot;none&quot;&gt;
       49
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-13-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 14 cell-14-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;14&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-14-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 14&quot; href=&quot;#14&quot; id=&quot;14&quot;&gt;
        14
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-14-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-14-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-14&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-14-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-14-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-14&quot; name=&quot;cell-14&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-14-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-14-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-14-source-label nb-source-label&quot; form=&quot;cell-14&quot; id=&quot;cell-14-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;----&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;----
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-14-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-14&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-14-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-14-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 15 cell-15-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;15&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-15-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 15&quot; href=&quot;#15&quot; id=&quot;15&quot;&gt;
        15
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-15-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-15-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-15&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-15-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-15-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-15&quot; name=&quot;cell-15&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-15-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-15-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-15-source-label nb-source-label&quot; form=&quot;cell-15&quot; id=&quot;cell-15-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;&amp;lt;a id=&quot;obtain_PRF&quot;&amp;gt;&amp;lt;/a&amp;gt;
## Obtain a PRF at a particular image location
Notice that both of our main functions can accept either a path to the location on your local machine where the PRF fits files are stored, or a URL pointing to the same directory at MAST.  We recommend downloading the PRF fits files if you expect to use them frequently. Here we use the URL for the PRFs.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;obtain_PRF&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Obtain a PRF at a particular image location&lt;/span&gt;
Notice that both of our main functions can accept either a path to the location on your local machine where the PRF fits files are stored, or a URL pointing to the same directory at MAST.  We recommend downloading the PRF fits files if you expect to use them frequently. Here we use the URL for the PRFs.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-15-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-15&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-15-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-15-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;obtain_PRF&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;obtain-a-prf-at-a-particular-image-location&quot;&gt;
        &lt;a href=&quot;#obtain-a-prf-at-a-particular-image-location&quot;&gt;
         Obtain a PRF at a particular image location
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Notice that both of our main functions can accept either a path to the location on your local machine where the PRF fits files are stored, or a URL pointing to the same directory at MAST.  We recommend downloading the PRF fits files if you expect to use them frequently. Here we use the URL for the PRFs.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 16 cell-16-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;16&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-16-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 16&quot; href=&quot;#16&quot; id=&quot;16&quot;&gt;
        16
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-16-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-16-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-16&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-16-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-16-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-16&quot; name=&quot;cell-16&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-16-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-16-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-16-source-label nb-source-label&quot; form=&quot;cell-16&quot; id=&quot;cell-16-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;# Define the location for which we want to retrieve the PRF.
col = 125.2
row = 544.1
ccd = 2
camera = 2
sector = 1

# This is the directory where MAST stores the prf FITS files.
path = &quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;

prf = getPrfAtColRowFits(col, row, ccd, camera, sector, path)
closestPrf = getNearestPrfFits(col, row, ccd, camera, sector, path)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Define the location for which we want to retrieve the PRF.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;125.2&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;544.1&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# This is the directory where MAST stores the prf FITS files.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;closestPrf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getNearestPrfFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-16-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-16&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-16-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-16-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-16-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 17 cell-17-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;17&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-17-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 17&quot; href=&quot;#17&quot; id=&quot;17&quot;&gt;
        17
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-17-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-17-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-17&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-17-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-17-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-17&quot; name=&quot;cell-17&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-17-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-17-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-17-source-label nb-source-label&quot; form=&quot;cell-17&quot; id=&quot;cell-17-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Below is the code to plot both the closest PRF and a PRF derived from a linear interpolation between the 4 nearest PRFs provided in the file.  They are plotted with a log scale in order to let you really see the full extent of the PRFs.  Also, we show the difference between the two.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Below is the code to plot both the closest PRF and a PRF derived from a linear interpolation between the 4 nearest PRFs provided in the file.  They are plotted with a log scale in order to let you really see the full extent of the PRFs.  Also, we show the difference between the two.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-17-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-17&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-17-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-17-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Below is the code to plot both the closest PRF and a PRF derived from a linear interpolation between the 4 nearest PRFs provided in the file.  They are plotted with a log scale in order to let you really see the full extent of the PRFs.  Also, we show the difference between the two.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 18 cell-18-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;18&quot; data-loc=&quot;20&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-18-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 18&quot; href=&quot;#18&quot; id=&quot;18&quot;&gt;
        18
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-18-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-18-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-18&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-18-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-18-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-18&quot; name=&quot;cell-18&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-18-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-18-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-18-source-label nb-source-label&quot; form=&quot;cell-18&quot; id=&quot;cell-18-source&quot; name=&quot;source&quot; readonly rows=&quot;20&quot;&gt;# Commands to make the plots looks a bit nicer.
kwargs = {'origin':'lower', 'interpolation':'nearest', 'cmap':plt.cm.YlGnBu_r}

plt.figure(figsize=(14,3.5))
plt.subplot(131)
plt.imshow(np.log10(closestPrf), **kwargs)
plt.colorbar()
plt.title('Closest PRF')
plt.subplot(132)
plt.imshow(np.log10(prf), **kwargs)
plt.colorbar()
plt.title('Interpolated PRF')
plt.subplot(133)

diff = closestPrf - prf
plt.imshow(diff, **kwargs)
mx = max( np.max(diff), np.fabs(np.min(diff)) )
plt.clim(-mx, mx)
plt.title('Difference')
plt.colorbar()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Commands to make the plots looks a bit nicer.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'origin'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'lower'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'interpolation'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'nearest'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'cmap'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;YlGnBu_r&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;3.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;131&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;closestPrf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Closest PRF'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;132&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Interpolated PRF'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;133&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;closestPrf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diff&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;mx&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diff&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fabs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diff&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;clim&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;mx&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;mx&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Difference'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-18-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-18&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-18-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-18-loc&quot; role=&quot;none&quot;&gt;
       20
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-18-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 19 cell-19-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;19&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-19-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 19&quot; href=&quot;#19&quot; id=&quot;19&quot;&gt;
        19
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-19-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-19-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-19&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-19-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-19-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-19&quot; name=&quot;cell-19&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-19-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-19-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-19-source-label nb-source-label&quot; form=&quot;cell-19&quot; id=&quot;cell-19-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;## Sample of PRFs across the chip
Let's plot the PRF across a single CCD to show how it varies. The PRF images are plotted using a log scale to see the difference in the wings of the PRF. 

Notice that the nice round PRF shape is in the corner of our grid, near (1850,1850).  This is because there are 4 CCDs for each camera and so this location is nearest to the center of the focal plane and has the least optical distortion.  Note that the read-out direction of the CCDs is different for each CCD. See Figure 2.6 of the [Instrument Manual](http://archive.stsci.edu/files/live/sites/mast/files/home/missions-and-data/active-missions/tess/_documents/TESS_Instrument_Handbook_v0.1.pdf#page=16) to determine the actual orientation of each CCD. 

As an experiment you should change the ccd value see how it varies from one CCD to another across the TESS field-of-view. 
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Sample of PRFs across the chip&lt;/span&gt;
Let's plot the PRF across a single CCD to show how it varies. The PRF images are plotted using a log scale to see the difference in the wings of the PRF. 

Notice that the nice round PRF shape is in the corner of our grid, near (1850,1850).  This is because there are 4 CCDs for each camera and so this location is nearest to the center of the focal plane and has the least optical distortion.  Note that the read-out direction of the CCDs is different for each CCD. See Figure 2.6 of the [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Instrument Manual&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;http://archive.stsci.edu/files/live/sites/mast/files/home/missions-and-data/active-missions/tess/_documents/TESS_Instrument_Handbook_v0.1.pdf#page=16&lt;/span&gt;) to determine the actual orientation of each CCD. 

As an experiment you should change the ccd value see how it varies from one CCD to another across the TESS field-of-view. 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-19-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-19&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-19-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-19-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;sample-of-prfs-across-the-chip&quot;&gt;
        &lt;a href=&quot;#sample-of-prfs-across-the-chip&quot;&gt;
         Sample of PRFs across the chip
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Let's plot the PRF across a single CCD to show how it varies. The PRF images are plotted using a log scale to see the difference in the wings of the PRF.
       &lt;/p&gt;
       &lt;p&gt;
        Notice that the nice round PRF shape is in the corner of our grid, near (1850,1850).  This is because there are 4 CCDs for each camera and so this location is nearest to the center of the focal plane and has the least optical distortion.  Note that the read-out direction of the CCDs is different for each CCD. See Figure 2.6 of the
        &lt;a href=&quot;http://archive.stsci.edu/files/live/sites/mast/files/home/missions-and-data/active-missions/tess/_documents/TESS_Instrument_Handbook_v0.1.pdf#page=16&quot;&gt;
         Instrument Manual
        &lt;/a&gt;
        to determine the actual orientation of each CCD.
       &lt;/p&gt;
       &lt;p&gt;
        As an experiment you should change the ccd value see how it varies from one CCD to another across the TESS field-of-view.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 20 cell-20-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;20&quot; data-loc=&quot;18&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-20-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 20&quot; href=&quot;#20&quot; id=&quot;20&quot;&gt;
        20
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-20-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-20-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-20&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-20-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-20-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-20&quot; name=&quot;cell-20&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-20-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-20-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-20-source-label nb-source-label&quot; form=&quot;cell-20&quot; id=&quot;cell-20-source&quot; name=&quot;source&quot; readonly rows=&quot;18&quot;&gt;# Define the CCD for which we want to retrieve the PRFs
sector = 1   #Values 1 - 13
camera = 3   #values 1 - 4
ccd = 1      #Values 1 - 4

# Create plot
plt.figure(figsize=(14, 14))
plt.title(&quot;Intra Pixel PRF&quot;)

# Loop over the 25 different locations
nplot=0
for row in np.arange(50, 1851, 600):
    for col in np.arange(50, 1851, 600):
        nplot=nplot + 1
        plt.subplot(4, 4, nplot)
        prf = getPrfAtColRowFits(col + .5, row + .5, ccd, camera, sector, path)
        plt.imshow(np.log10(prf), **kwargs)
        plt.annotate(&quot;%.1f, %.1f&quot; % (col, row), (7, 11), color='w')&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Define the CCD for which we want to retrieve the PRFs&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;   &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;#Values 1 - 13&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;3&lt;/span&gt;   &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;#values 1 - 4&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;#Values 1 - 4&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Create plot&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;Intra Pixel PRF&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Loop over the 25 different locations&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1851&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;600&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1851&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;600&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;annotate&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%.1f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%.1f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'w'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-20-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-20&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-20-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-20-loc&quot; role=&quot;none&quot;&gt;
       18
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-20-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 21 cell-21-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;21&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-21-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 21&quot; href=&quot;#21&quot; id=&quot;21&quot;&gt;
        21
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-21-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-21-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-21&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-21-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-21-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-21&quot; name=&quot;cell-21&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-21-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-21-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-21-source-label nb-source-label&quot; form=&quot;cell-21&quot; id=&quot;cell-21-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;## Sample the PRF at sub-pixel locations. 
The PRF varies quite a bit depending on where on the pixel the star's light falls.  As a result it is instructive to plot the PRF for one pixel at various intrapixel locations.  In the following we show a 5x5 grid of the prf above. Note that there are actually 9 different intra-pixel locations provided in the TESS Mission PRFs.  Here we plot them on a linear scale because most of the variation is in the brightest pixels of the PRF.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Sample the PRF at sub-pixel locations. &lt;/span&gt;
The PRF varies quite a bit depending on where on the pixel the star's light falls.  As a result it is instructive to plot the PRF for one pixel at various intrapixel locations.  In the following we show a 5x5 grid of the prf above. Note that there are actually 9 different intra-pixel locations provided in the TESS Mission PRFs.  Here we plot them on a linear scale because most of the variation is in the brightest pixels of the PRF.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-21-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-21&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-21-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-21-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;sample-the-prf-at-sub-pixel-locations&quot;&gt;
        &lt;a href=&quot;#sample-the-prf-at-sub-pixel-locations&quot;&gt;
         Sample the PRF at sub-pixel locations.
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        The PRF varies quite a bit depending on where on the pixel the star's light falls.  As a result it is instructive to plot the PRF for one pixel at various intrapixel locations.  In the following we show a 5x5 grid of the prf above. Note that there are actually 9 different intra-pixel locations provided in the TESS Mission PRFs.  Here we plot them on a linear scale because most of the variation is in the brightest pixels of the PRF.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 22 cell-22-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;22&quot; data-loc=&quot;24&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-22-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 22&quot; href=&quot;#22&quot; id=&quot;22&quot;&gt;
        22
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-22-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-22-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-22&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-22-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-22-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-22&quot; name=&quot;cell-22&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-22-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-22-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-22-source-label nb-source-label&quot; form=&quot;cell-22&quot; id=&quot;cell-22-source&quot; name=&quot;source&quot; readonly rows=&quot;24&quot;&gt;# Define the location for which we want to retrieve the PRF.
col = 125.0
row = 1044.0
ccd = 2
camera = 2
sector = 1

# This is the directory where MAST stores the prf FITS files.
path = &quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;

kwargs['vmax'] = .2  
plt.figure(figsize = (14, 14))

# Loop over the 5 different locations
nplot=0
for row_add in np.arange(0.9, 0, -.2):
    for col_add in np.arange(0.1, 1, .2):
        nplot=nplot+1
        plt.subplot(5,5,nplot)
        prf = getPrfAtColRowFits(col + col_add, row + row_add, ccd, camera, sector, path)
        plt.imshow(prf, **kwargs)
        plt.annotate(&quot;%.1f, %.1f&quot; % (col_add, row_add), (8, 11), color='w')

_ = kwargs.pop('vmax')  #unset vmax
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Define the location for which we want to retrieve the PRF.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;125.0&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1044.0&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# This is the directory where MAST stores the prf FITS files.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'vmax'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.2&lt;/span&gt;  
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Loop over the 5 different locations&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_add&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_add&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_add&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_add&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;annotate&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%.1f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%.1f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_add&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_add&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'w'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'vmax'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;#unset vmax&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-22-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-22&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-22-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-22-loc&quot; role=&quot;none&quot;&gt;
       24
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-22-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 23 cell-23-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;23&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-23-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 23&quot; href=&quot;#23&quot; id=&quot;23&quot;&gt;
        23
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-23-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-23-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-23&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-23-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-23-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-23&quot; name=&quot;cell-23&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-23-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-23-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-23-source-label nb-source-label&quot; form=&quot;cell-23&quot; id=&quot;cell-23-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;## Compare the PRF to an Image
In the following we pull down the image of a star observed by TESS. We do this using TessCut and Catalogs, both are packages available through astroquery.mast. MAST maintains a separate tutorial on how to use these tools. Tesscut cuts out a timeseries of a subsection of the TESS FFIs.  We plot that image and attmept to estimate a PRF for that star. This examples is done for TIC 307214209. It is chosen because it is relatively isolated in the field, making it easier to match the PRFs.
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Compare the PRF to an Image&lt;/span&gt;
In the following we pull down the image of a star observed by TESS. We do this using TessCut and Catalogs, both are packages available through astroquery.mast. MAST maintains a separate tutorial on how to use these tools. Tesscut cuts out a timeseries of a subsection of the TESS FFIs.  We plot that image and attmept to estimate a PRF for that star. This examples is done for TIC 307214209. It is chosen because it is relatively isolated in the field, making it easier to match the PRFs.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-23-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-23&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-23-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-23-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;compare-the-prf-to-an-image&quot;&gt;
        &lt;a href=&quot;#compare-the-prf-to-an-image&quot;&gt;
         Compare the PRF to an Image
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        In the following we pull down the image of a star observed by TESS. We do this using TessCut and Catalogs, both are packages available through astroquery.mast. MAST maintains a separate tutorial on how to use these tools. Tesscut cuts out a timeseries of a subsection of the TESS FFIs.  We plot that image and attmept to estimate a PRF for that star. This examples is done for TIC 307214209. It is chosen because it is relatively isolated in the field, making it easier to match the PRFs.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 24 cell-24-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;24&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-24-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 24&quot; href=&quot;#24&quot; id=&quot;24&quot;&gt;
        24
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-24-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-24-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-24&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-24-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-24-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-24&quot; name=&quot;cell-24&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-24-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-24-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-24-source-label nb-source-label&quot; form=&quot;cell-24&quot; id=&quot;cell-24-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;from astroquery.mast import Tesscut
from astroquery.mast import Catalogs

ticid = 307214209
target = &quot;TIC %u&quot; % ticid
size = 13

catalogData = Catalogs.query_criteria(catalog = &quot;Tic&quot;, ID = ticid)
ra = catalogData['ra']
dec = catalogData['dec']

coord=&quot;%f, %f&quot; % (ra,dec)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astroquery.mast&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Tesscut&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astroquery.mast&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Catalogs&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ticid&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;307214209&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;TIC &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%u&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ticid&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;13&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Catalogs&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;query_criteria&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalog&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;Tic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ID&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ticid&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ra&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'ra'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dec&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'dec'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;coord&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ra&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-24-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-24&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-24-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-24-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-24-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 25 cell-25-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;25&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-25-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 25&quot; href=&quot;#25&quot; id=&quot;25&quot;&gt;
        25
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-25-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-25-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-25&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-25-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-25-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-25&quot; name=&quot;cell-25&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-25-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-25-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-25-source-label nb-source-label&quot; form=&quot;cell-25&quot; id=&quot;cell-25-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Use Tesscut to retrieve a 13x13 square image from a calibrated FFI
TESScut requires a string containing the RA and Dec of the location and a size for how big the cutout should be. I then take the median of all the images in the stack for comparison to the PRF.  The Header contains information about the location of the pixels on the original calibrated FFI. 1CRV4P and 2CRV4P provide the column and row of the center of the cutout in the original physical coordinate system of the FFI.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Use Tesscut to retrieve a 13x13 square image from a calibrated FFI&lt;/span&gt;
TESScut requires a string containing the RA and Dec of the location and a size for how big the cutout should be. I then take the median of all the images in the stack for comparison to the PRF.  The Header contains information about the location of the pixels on the original calibrated FFI. 1CRV4P and 2CRV4P provide the column and row of the center of the cutout in the original physical coordinate system of the FFI.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-25-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-25&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-25-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-25-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#use-tesscut-to-retrieve-a-13x13-square-image-from-a-calibrated-ffi&quot;&gt;
         Use Tesscut to retrieve a 13x13 square image from a calibrated FFI
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        TESScut requires a string containing the RA and Dec of the location and a size for how big the cutout should be. I then take the median of all the images in the stack for comparison to the PRF.  The Header contains information about the location of the pixels on the original calibrated FFI. 1CRV4P and 2CRV4P provide the column and row of the center of the cutout in the original physical coordinate system of the FFI.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 26 cell-26-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;26&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-26-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 26&quot; href=&quot;#26&quot; id=&quot;26&quot;&gt;
        26
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-26-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-26-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-26&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-26-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-26-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-26&quot; name=&quot;cell-26&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-26-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-26-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-26-source-label nb-source-label&quot; form=&quot;cell-26&quot; id=&quot;cell-26-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;hdulist = Tesscut.get_cutouts(coordinates=coord, size=size)
n = 1 # There is more than one sector, we chose the second one&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Tesscut&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;get_cutouts&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;coordinates&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;coord&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# There is more than one sector, we chose the second one&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-26-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-26&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-26-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-26-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-26-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 27 cell-27-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;27&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-27-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 27&quot; href=&quot;#27&quot; id=&quot;27&quot;&gt;
        27
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-27-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-27-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-27&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-27-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-27-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-27&quot; name=&quot;cell-27&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-27-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-27-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-27-source-label nb-source-label&quot; form=&quot;cell-27&quot; id=&quot;cell-27-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;### Determine the column and row of the central pixel&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Determine the column and row of the central pixel&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-27-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-27&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-27-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-27-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#determine-the-column-and-row-of-the-central-pixel&quot;&gt;
         Determine the column and row of the central pixel
        &lt;/a&gt;
       &lt;/h3&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 28 cell-28-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;28&quot; data-loc=&quot;7&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-28-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 28&quot; href=&quot;#28&quot; id=&quot;28&quot;&gt;
        28
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-28-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-28-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-28&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-28-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-28-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-28&quot; name=&quot;cell-28&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-28-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-28-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-28-source-label nb-source-label&quot; form=&quot;cell-28&quot; id=&quot;cell-28-source&quot; name=&quot;source&quot; readonly rows=&quot;7&quot;&gt;# Pull out the location of the middle of the CCD from the Physics WCS in the header.
image_head = hdulist[n][1].header
prime_head = hdulist[n][0].header
ap_head = hdulist[n][2].header
col_center = image_head['1CRV4P']
row_center = image_head['2CRV4P']
print(&quot;Header col,row: %f, %f&quot; % (col_center, row_center))&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Pull out the location of the middle of the CCD from the Physics WCS in the header.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_head&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;header&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prime_head&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;header&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ap_head&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;header&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_center&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_head&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'1CRV4P'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_center&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_head&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'2CRV4P'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;Header col,row: &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_center&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_center&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-28-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-28&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-28-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-28-loc&quot; role=&quot;none&quot;&gt;
       7
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-28-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 29 cell-29-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;29&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-29-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 29&quot; href=&quot;#29&quot; id=&quot;29&quot;&gt;
        29
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-29-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-29-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-29&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-29-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-29-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-29&quot; name=&quot;cell-29&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-29-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-29-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-29-source-label nb-source-label&quot; form=&quot;cell-29&quot; id=&quot;cell-29-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Determine the location of the star
Usually, if the TIC is accurate, the location of the star will be right in the center. In case it is not, we look for the brightest pixel in the median of our time series of images and request our PRF for that location. In this case, we end up with the central pixel.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Determine the location of the star&lt;/span&gt;
Usually, if the TIC is accurate, the location of the star will be right in the center. In case it is not, we look for the brightest pixel in the median of our time series of images and request our PRF for that location. In this case, we end up with the central pixel.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-29-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-29&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-29-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-29-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#determine-the-location-of-the-star&quot;&gt;
         Determine the location of the star
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        Usually, if the TIC is accurate, the location of the star will be right in the center. In case it is not, we look for the brightest pixel in the median of our time series of images and request our PRF for that location. In this case, we end up with the central pixel.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 30 cell-30-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;30&quot; data-loc=&quot;10&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-30-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 30&quot; href=&quot;#30&quot; id=&quot;30&quot;&gt;
        30
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-30-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-30-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-30&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-30-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-30-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-30&quot; name=&quot;cell-30&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-30-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-30-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-30-source-label nb-source-label&quot; form=&quot;cell-30&quot; id=&quot;cell-30-source&quot; name=&quot;source&quot; readonly rows=&quot;10&quot;&gt;# Get the image of the median of the time series.
image_array = hdulist[n][1].data['FLUX']
image_stack = np.median(image_array,axis=0)

sortedindex=np.dstack(np.unravel_index(np.argsort(image_stack.ravel()), (13, 13)))
brightest = sortedindex[-1][-1]
bright_col = brightest[0] - 6 + col_center
bright_row = brightest[1] - 6 + row_center

print(&quot;Bright star col,row: %f, %f&quot; % (bright_col, bright_row))&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Get the image of the median of the time series.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_array&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'FLUX'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_stack&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_array&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sortedindex&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dstack&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;unravel_index&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;argsort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_stack&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ravel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;brightest&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sortedindex&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright_col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;brightest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_center&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright_row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;brightest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_center&lt;/span&gt;

&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;Bright star col,row: &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright_col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright_row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-30-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-30&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-30-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-30-loc&quot; role=&quot;none&quot;&gt;
       10
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-30-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 31 cell-31-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;31&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-31-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 31&quot; href=&quot;#31&quot; id=&quot;31&quot;&gt;
        31
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-31-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-31-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-31&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-31-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-31-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-31&quot; name=&quot;cell-31&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-31-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-31-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-31-source-label nb-source-label&quot; form=&quot;cell-31&quot; id=&quot;cell-31-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Look up Sector, Camera, and CCD
Use the TessCut header to determine the sector, camera, and ccd of the image.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Look up Sector, Camera, and CCD&lt;/span&gt;
Use the TessCut header to determine the sector, camera, and ccd of the image.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-31-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-31&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-31-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-31-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#look-up-sector-camera-and-ccd&quot;&gt;
         Look up Sector, Camera, and CCD
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        Use the TessCut header to determine the sector, camera, and ccd of the image.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 32 cell-32-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;32&quot; data-loc=&quot;5&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-32-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 32&quot; href=&quot;#32&quot; id=&quot;32&quot;&gt;
        32
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-32-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-32-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-32&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-32-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-32-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-32&quot; name=&quot;cell-32&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-32-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-32-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-32-source-label nb-source-label&quot; form=&quot;cell-32&quot; id=&quot;cell-32-source&quot; name=&quot;source&quot; readonly rows=&quot;5&quot;&gt;camera = prime_head['CAMERA']
ccd = prime_head['CCD']
sector = prime_head['SECTOR']
path = &quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;
prf_col_offset = 44&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prime_head&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'CAMERA'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prime_head&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'CCD'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prime_head&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'SECTOR'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf_col_offset&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;44&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-32-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-32&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-32-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-32-loc&quot; role=&quot;none&quot;&gt;
       5
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-32-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 33 cell-33-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;33&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-33-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 33&quot; href=&quot;#33&quot; id=&quot;33&quot;&gt;
        33
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-33-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-33-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-33&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-33-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-33-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-33&quot; name=&quot;cell-33&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-33-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-33-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-33-source-label nb-source-label&quot; form=&quot;cell-33&quot; id=&quot;cell-33-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;### Plot the sub-pixel PRFs
Below we compare the image from the FFI to the various sub-pixel locations to choose the one that looks most like the image. For most use cases, you would most likely want to perform a fit, but for our purposes of understanding the PRFs, this will be sufficient.

Notice we define an arbitrary offset above, prf_col_offset. We need to add a 44 pixel offset to the column in the PRF request.  This is because the PRF request uses a different physical coordinate system than our calibrated FFIs. They use 45 as their first column but the calibrated FFIs use 1 as the first column. 

First we plot an image of the median of all the images in the pixel time series returned by TESScut.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Plot the sub-pixel PRFs&lt;/span&gt;
Below we compare the image from the FFI to the various sub-pixel locations to choose the one that looks most like the image. For most use cases, you would most likely want to perform a fit, but for our purposes of understanding the PRFs, this will be sufficient.

Notice we define an arbitrary offset above, prf_col_offset. We need to add a 44 pixel offset to the column in the PRF request.  This is because the PRF request uses a different physical coordinate system than our calibrated FFIs. They use 45 as their first column but the calibrated FFIs use 1 as the first column. 

First we plot an image of the median of all the images in the pixel time series returned by TESScut.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-33-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-33&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-33-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-33-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#plot-the-sub-pixel-prfs&quot;&gt;
         Plot the sub-pixel PRFs
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        Below we compare the image from the FFI to the various sub-pixel locations to choose the one that looks most like the image. For most use cases, you would most likely want to perform a fit, but for our purposes of understanding the PRFs, this will be sufficient.
       &lt;/p&gt;
       &lt;p&gt;
        Notice we define an arbitrary offset above, prf_col_offset. We need to add a 44 pixel offset to the column in the PRF request.  This is because the PRF request uses a different physical coordinate system than our calibrated FFIs. They use 45 as their first column but the calibrated FFIs use 1 as the first column.
       &lt;/p&gt;
       &lt;p&gt;
        First we plot an image of the median of all the images in the pixel time series returned by TESScut.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 34 cell-34-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;34&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-34-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 34&quot; href=&quot;#34&quot; id=&quot;34&quot;&gt;
        34
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-34-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-34-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-34&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-34-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-34-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-34&quot; name=&quot;cell-34&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-34-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-34-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-34-source-label nb-source-label&quot; form=&quot;cell-34&quot; id=&quot;cell-34-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;plt.imshow(image_stack, **kwargs)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_stack&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-34-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-34&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-34-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-34-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-34-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 35 cell-35-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;35&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-35-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 35&quot; href=&quot;#35&quot; id=&quot;35&quot;&gt;
        35
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-35-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-35-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-35&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-35-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-35-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-35&quot; name=&quot;cell-35&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-35-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-35-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-35-source-label nb-source-label&quot; form=&quot;cell-35&quot; id=&quot;cell-35-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Here is a 5x5 grid showing the PRF as it would look if it fell on different parts of the pixel. A quick chi-by-eye tells me that (0.7,0.9) is a pretty good match.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Here is a 5x5 grid showing the PRF as it would look if it fell on different parts of the pixel. A quick chi-by-eye tells me that (0.7,0.9) is a pretty good match.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-35-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-35&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-35-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-35-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Here is a 5x5 grid showing the PRF as it would look if it fell on different parts of the pixel. A quick chi-by-eye tells me that (0.7,0.9) is a pretty good match.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 36 cell-36-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;36&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-36-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 36&quot; href=&quot;#36&quot; id=&quot;36&quot;&gt;
        36
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-36-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-36-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-36&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-36-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-36-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-36&quot; name=&quot;cell-36&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-36-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-36-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-36-source-label nb-source-label&quot; form=&quot;cell-36&quot; id=&quot;cell-36-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;# Loop over the 5 different locations
plt.figure(figsize = (14, 14))
nplot = 0
for row_add in np.arange(0.9, 0, -.2):
    for col_add in np.arange(0.1,1,.2):
        nplot=nplot+1
        plt.subplot(5,5,nplot)
        col = bright_col + col_add + prf_col_offset
        row = bright_row + row_add
        prf = getPrfAtColRowFits(col, row, ccd, camera, sector, path)
        plt.imshow(prf, **kwargs)
        plt.annotate(&quot;%.1f, %.1f&quot; % (col_add, row_add), (8,11), color='w')&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Loop over the 5 different locations&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_add&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_add&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright_col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_add&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf_col_offset&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright_row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_add&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;annotate&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%.1f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%.1f&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;col_add&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row_add&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'w'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-36-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-36&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-36-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-36-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-36-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 37 cell-37-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;37&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-37-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 37&quot; href=&quot;#37&quot; id=&quot;37&quot;&gt;
        37
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-37-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-37-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-37&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-37-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-37-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-37&quot; name=&quot;cell-37&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-37-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-37-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-37-source-label nb-source-label&quot; form=&quot;cell-37&quot; id=&quot;cell-37-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Here we obtain the interpolated PRF for our image given the column and row we determinted, including the subpixel information. &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Here we obtain the interpolated PRF for our image given the column and row we determinted, including the subpixel information. 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-37-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-37&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-37-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-37-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Here we obtain the interpolated PRF for our image given the column and row we determinted, including the subpixel information.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 38 cell-38-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;38&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-38-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 38&quot; href=&quot;#38&quot; id=&quot;38&quot;&gt;
        38
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-38-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-38-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-38&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-38-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-38-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-38&quot; name=&quot;cell-38&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-38-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-38-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-38-source-label nb-source-label&quot; form=&quot;cell-38&quot; id=&quot;cell-38-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;# offsets from the corner of the pixel.
offcol = .7
offrow = .9

# Retrieve the PRF using our functions above.
prf = getPrfAtColRowFits(bright_col + offcol + prf_col_offset, bright_row + offrow, ccd, camera, sector, path)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# offsets from the corner of the pixel.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;offcol&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.7&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;offrow&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.9&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Retrieve the PRF using our functions above.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright_col&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;offcol&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf_col_offset&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright_row&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;offrow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ccd&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;camera&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-38-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-38&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-38-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-38-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-38-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 39 cell-39-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;39&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-39-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 39&quot; href=&quot;#39&quot; id=&quot;39&quot;&gt;
        39
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-39-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-39-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-39&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-39-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-39-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-39&quot; name=&quot;cell-39&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-39-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-39-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-39-source-label nb-source-label&quot; form=&quot;cell-39&quot; id=&quot;cell-39-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Compare PRF and FFI cutout
Here we look at the difference between our actual image and the PRF we requested. To do this well we need to subtact the background from the image and then we need to scale up the PRF to match the flux of our star. We finish by plotting the background subtracted image, the flux-scaled PRF, and the significance of the difference (assuming Poisson statistics in the image). &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Compare PRF and FFI cutout&lt;/span&gt;
Here we look at the difference between our actual image and the PRF we requested. To do this well we need to subtact the background from the image and then we need to scale up the PRF to match the flux of our star. We finish by plotting the background subtracted image, the flux-scaled PRF, and the significance of the difference (assuming Poisson statistics in the image). 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-39-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-39&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-39-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-39-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#compare-prf-and-ffi-cutout&quot;&gt;
         Compare PRF and FFI cutout
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        Here we look at the difference between our actual image and the PRF we requested. To do this well we need to subtact the background from the image and then we need to scale up the PRF to match the flux of our star. We finish by plotting the background subtracted image, the flux-scaled PRF, and the significance of the difference (assuming Poisson statistics in the image).
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 40 cell-40-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;40&quot; data-loc=&quot;27&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-40-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 40&quot; href=&quot;#40&quot; id=&quot;40&quot;&gt;
        40
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-40-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-40-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-40&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-40-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-40-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-40&quot; name=&quot;cell-40&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-40-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-40-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-40-source-label nb-source-label&quot; form=&quot;cell-40&quot; id=&quot;cell-40-source&quot; name=&quot;source&quot; readonly rows=&quot;27&quot;&gt;# estimate background using median
image_subbkg =  image_stack - np.median(image_stack)
# Scaling based on brightest pixels.
scale = np.max(image_subbkg)/np.max(prf)
# Take the difference
diff =  image_subbkg - prf * scale 

# Estimate the signficance of the residuals
sigma = diff / (np.sqrt(np.abs(image_subbkg)) + .05)

# Plot
vm = np.max(image_subbkg)
plt.figure(figsize = (14, 4))
plt.subplot(131)
plt.imshow(image_stack, **kwargs, vmax=vm)
plt.title('Target Pixel File')
plt.colorbar()

plt.subplot(132)
plt.imshow(prf * scale, **kwargs, vmax = vm)
plt.title('PRF')
plt.colorbar()

plt.subplot(133)
plt.imshow(sigma, origin = &quot;lower&quot;, interpolation = 'nearest', cmap = 'RdBu', vmin = -50, vmax = 50)
plt.title('Significance of Residuals')
plt.colorbar()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# estimate background using median&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_subbkg&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_stack&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_stack&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Scaling based on brightest pixels.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;scale&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_subbkg&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Take the difference&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_subbkg&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;scale&lt;/span&gt; 

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Estimate the signficance of the residuals&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sigma&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_subbkg&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.05&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Plot&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vm&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_subbkg&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;131&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image_stack&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vmax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Target Pixel File'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;132&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vmax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'PRF'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;133&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;origin&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;lower&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;interpolation&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'nearest'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cmap&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'RdBu'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vmin&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vmax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Significance of Residuals'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-40-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-40&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-40-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-40-loc&quot; role=&quot;none&quot;&gt;
       27
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-40-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 41 cell-41-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;41&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-41-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 41&quot; href=&quot;#41&quot; id=&quot;41&quot;&gt;
        41
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-41-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-41-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-41&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-41-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-41-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-41&quot; name=&quot;cell-41&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-41-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-41-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-41-source-label nb-source-label&quot; form=&quot;cell-41&quot; id=&quot;cell-41-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;### Residuals
This is not an optimal fit. By playing around with `offcol` and `offrow` above, you will be able to find a slightly better fit than the one shown above.  (Hint, try (0.8, 0.9) for the column and row offsets.)

We also did not account for all the stars in our image. We picked a rather isolated, 8th magnitude star, but there is still another 10th magnitude star about 7 pixels away, and a 15th magnitude star about 5 pixels away from our star (both are towards the upper left in our image). A good PRF fit will include all of this information. Both of these can be seen clearly in the residuals. We also see some residual signal from our primary star that hopefully a better fit that properly scales the PRF to the flux of the star will remove more cleanly.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Residuals&lt;/span&gt;
This is not an optimal fit. By playing around with &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`offcol`&lt;/span&gt; and &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`offrow`&lt;/span&gt; above, you will be able to find a slightly better fit than the one shown above.  (Hint, try (0.8, 0.9) for the column and row offsets.)

We also did not account for all the stars in our image. We picked a rather isolated, 8th magnitude star, but there is still another 10th magnitude star about 7 pixels away, and a 15th magnitude star about 5 pixels away from our star (both are towards the upper left in our image). A good PRF fit will include all of this information. Both of these can be seen clearly in the residuals. We also see some residual signal from our primary star that hopefully a better fit that properly scales the PRF to the flux of the star will remove more cleanly.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-41-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-41&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-41-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-41-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#residuals&quot;&gt;
         Residuals
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        This is not an optimal fit. By playing around with
        &lt;code&gt;
         offcol
        &lt;/code&gt;
        and
        &lt;code&gt;
         offrow
        &lt;/code&gt;
        above, you will be able to find a slightly better fit than the one shown above.  (Hint, try (0.8, 0.9) for the column and row offsets.)
       &lt;/p&gt;
       &lt;p&gt;
        We also did not account for all the stars in our image. We picked a rather isolated, 8th magnitude star, but there is still another 10th magnitude star about 7 pixels away, and a 15th magnitude star about 5 pixels away from our star (both are towards the upper left in our image). A good PRF fit will include all of this information. Both of these can be seen clearly in the residuals. We also see some residual signal from our primary star that hopefully a better fit that properly scales the PRF to the flux of the star will remove more cleanly.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 42 cell-42-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;42&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-42-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 42&quot; href=&quot;#42&quot; id=&quot;42&quot;&gt;
        42
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-42-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-42-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-42&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-42-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-42-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-42&quot; name=&quot;cell-42&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-42-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-42-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-42-source-label nb-source-label&quot; form=&quot;cell-42&quot; id=&quot;cell-42-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Summary
This notebook provided you with code to open the PRFs and retrieve one that matches the physical location of a star on a real TESS image.  You learned that the PRF depends not only on the location of the star on the chip, but also varies significantly by the sub-pixel location.  The wings of the PRFs depend strongly on the location of the star on the chip with the most circular shapes near the center of the image. The shape of the bright central peak of the PRF depends strongly on the sub-pixel location.  &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Summary&lt;/span&gt;
This notebook provided you with code to open the PRFs and retrieve one that matches the physical location of a star on a real TESS image.  You learned that the PRF depends not only on the location of the star on the chip, but also varies significantly by the sub-pixel location.  The wings of the PRFs depend strongly on the location of the star on the chip with the most circular shapes near the center of the image. The shape of the bright central peak of the PRF depends strongly on the sub-pixel location.  
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-42-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-42&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-42-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-42-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#summary&quot;&gt;
         Summary
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        This notebook provided you with code to open the PRFs and retrieve one that matches the physical location of a star on a real TESS image.  You learned that the PRF depends not only on the location of the star on the chip, but also varies significantly by the sub-pixel location.  The wings of the PRFs depend strongly on the location of the star on the chip with the most circular shapes near the center of the image. The shape of the bright central peak of the PRF depends strongly on the sub-pixel location.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 43 cell-43-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;43&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-43-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 43&quot; href=&quot;#43&quot; id=&quot;43&quot;&gt;
        43
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-43-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-43-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-43&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-43-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-43-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-43&quot; name=&quot;cell-43&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-43-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-43-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-43-source-label nb-source-label&quot; form=&quot;cell-43&quot; id=&quot;cell-43-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;&amp;lt;a id=&quot;about_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
## About this Notebook
**Authors:** 
&amp;lt;br/&amp;gt;Susan E. Mullally, STScI 
&amp;lt;br/&amp;gt;Fergal Mullally
&amp;lt;br/&amp;gt;**Updated On:** 2019-06-13&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;about_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## About this Notebook&lt;/span&gt;
&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Authors:**&lt;/span&gt; 
&amp;lt;br&amp;gt;Susan E. Mullally, STScI 
&amp;lt;br&amp;gt;Fergal Mullally
&amp;lt;br&amp;gt;**Updated On:** 2019-06-13
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-43-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-43&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-43-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-43-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;about_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;about-this-notebook&quot;&gt;
        &lt;a href=&quot;#about-this-notebook&quot;&gt;
         About this Notebook
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Authors:
        &lt;/strong&gt;
        &lt;br&gt;
        Susan E. Mullally, STScI
        &lt;br&gt;
        Fergal Mullally
        &lt;br&gt;
        &lt;strong&gt;
         Updated On:
        &lt;/strong&gt;
        2019-06-13
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 44 cell-44-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;44&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-44-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 44&quot; href=&quot;#44&quot; id=&quot;44&quot;&gt;
        44
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-44-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-44-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-44&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-44-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-44-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-44&quot; name=&quot;cell-44&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-44-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-44-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-44-source-label nb-source-label&quot; form=&quot;cell-44&quot; id=&quot;cell-44-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;[Top of Page](#title_ID)
&amp;lt;img alt=&quot;STScI logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;/&amp;gt; &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Top of Page&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#title_ID&lt;/span&gt;)
&amp;lt;img style=&quot;float: right;&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; alt=&quot;STScI logo&quot; width=&quot;200px&quot;/&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-44-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-44&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-44-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-44-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a href=&quot;#title_ID&quot;&gt;
         Top of Page
        &lt;/a&gt;
        &lt;img alt=&quot;STScI logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 45 cell-45-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;45&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-45-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 45&quot; href=&quot;#45&quot; id=&quot;45&quot;&gt;
        45
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-45-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-45-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-45&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-45-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-45-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-45&quot; name=&quot;cell-45&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-45-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-45-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-45-source-label nb-source-label&quot; form=&quot;cell-45&quot; id=&quot;cell-45-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Assert Statements
Test to check that the code is returning the correct PRFs. Do not edit the following lines.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Assert Statements&lt;/span&gt;
Test to check that the code is returning the correct PRFs. Do not edit the following lines.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-45-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-45&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-45-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-45-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#assert-statements&quot;&gt;
         Assert Statements
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        Test to check that the code is returning the correct PRFs. Do not edit the following lines.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 46 cell-46-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;46&quot; data-loc=&quot;10&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-46-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 46&quot; href=&quot;#46&quot; id=&quot;46&quot;&gt;
        46
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-46-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-46-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-46&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-46-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-46-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-46&quot; name=&quot;cell-46&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-46-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-46-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-46-source-label nb-source-label&quot; form=&quot;cell-46&quot; id=&quot;cell-46-source&quot; name=&quot;source&quot; readonly rows=&quot;10&quot;&gt;# Assert statements to ensure that the PRFs are being calculated correctly
prf = getPrfAtColRowFits(120.1, 500.0, 1, 2, 1, &quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;)
assert np.abs(prf[0,0] - 0.00023311895) &amp;lt; 2e-10

prf = getPrfAtColRowFits(1000.1, 1500.0, 1, 2, 1, &quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;)
assert np.abs(prf[0,0] - 0.0001082187719) &amp;lt; 2e-10
assert np.abs(prf[12,12] - 0.00013416155932937155) &amp;lt; 2e-10

prf = getPrfAtColRowFits(1000.1, 1500.0, 3, 1, 8, &quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;)
assert np.abs(prf[0,0] - 0.00019209127583606498) &amp;lt; 2e-10&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Assert statements to ensure that the PRFs are being calculated correctly&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;120.1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;500.0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.00023311895&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;2e-10&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1000.1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1500.0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.0001082187719&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;2e-10&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.00013416155932937155&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;2e-10&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getPrfAtColRowFits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1000.1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1500.0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;https://archive.stsci.edu/missions/tess/models/prf_fitsfiles/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;prf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.00019209127583606498&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;2e-10&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-46-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-46&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-46-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-46-loc&quot; role=&quot;none&quot;&gt;
       10
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-46-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;table class=&quot;nb-cells-footer&quot; hidden&gt;
    &lt;tbody&gt;
     &lt;tr class=&quot;total&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       all cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       46
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       466
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;code&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       code cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       46
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       466
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;markdown&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       markdown cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       46
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       466
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;dialog id=&quot;nb-metadata&quot;&gt;
    &lt;form method=&quot;dialog&quot;&gt;
     &lt;button formmethod=&quot;dialog&quot;&gt;
      Close
     &lt;/button&gt;
     {&quot;kernelspec&quot;: {&quot;display_name&quot;: &quot;Python 3 (ipykernel)&quot;, &quot;language&quot;: &quot;python&quot;, &quot;name&quot;: &quot;python3&quot;}, &quot;language_info&quot;: {&quot;codemirror_mode&quot;: {&quot;name&quot;: &quot;ipython&quot;, &quot;version&quot;: 3}, &quot;file_extension&quot;: &quot;.py&quot;, &quot;mimetype&quot;: &quot;text/x-python&quot;, &quot;name&quot;: &quot;python&quot;, &quot;nbconvert_exporter&quot;: &quot;python&quot;, &quot;pygments_lexer&quot;: &quot;ipython3&quot;, &quot;version&quot;: &quot;3.8.16&quot;}}
    &lt;/form&gt;
   &lt;/dialog&gt;
   &lt;form aria-labelledby=&quot;nb-notebook-label&quot; id=&quot;notebook&quot; name=&quot;notebook&quot;&gt;
    &lt;label&gt;
     &lt;input id=&quot;nb-edit-mode&quot; name=&quot;edit&quot; type=&quot;checkbox&quot;&gt;
     edit mode
    &lt;/label&gt;
    &lt;button aria-controls=&quot;nb-metadata&quot; onclick=&quot;openDialog()&quot;&gt;
     metadata
    &lt;/button&gt;
    &lt;button type=&quot;submit&quot;&gt;
     Run
    &lt;/button&gt;
   &lt;/form&gt;
  &lt;/main&gt;
  &lt;section id=&quot;nb-dialogs&quot;&gt;
   &lt;details&gt;
    &lt;summary onclick=&quot;openDialogs()&quot;&gt;
     settings, help, &amp;amp; diagnostics
    &lt;/summary&gt;
   &lt;/details&gt;
  &lt;/section&gt;
  &lt;footer&gt;
   &lt;details class=&quot;log&quot;&gt;
    &lt;summary&gt;
     &lt;span&gt;
      activity log
     &lt;/span&gt;
    &lt;/summary&gt;
   &lt;/details&gt;
   &lt;table aria-live=&quot;polite&quot;&gt;
    &lt;tbody&gt;
     &lt;tr&gt;
      &lt;th hidden&gt;
       time
      &lt;/th&gt;
      &lt;td&gt;
       message
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;a accesskey=&quot;0&quot; href=&quot;#TOP&quot;&gt;
    skip to top
   &lt;/a&gt;
  &lt;/footer&gt;
 &lt;/body&gt;
&lt;/html&gt;
" width="100%"></iframe></div>
<div class="output_html rendered_html output_subarea"><iframe height="600" srcdoc="&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
 &lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; name=&quot;viewport&quot;&gt;
  &lt;title&gt;
   Notebook
  &lt;/title&gt;
  &lt;meta content=&quot;light&quot; name=&quot;color-scheme&quot;&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js&quot;&gt;
  &lt;/script&gt;
  &lt;style type=&quot;text/css&quot;&gt;
   /* # accessible css configurations

we define these high level variables to allow for configuration during use and testing.
we are not sure what the preferred default values are for these any accessible notebooks features.
the variables specify critical degrees of freedom in the notebook style.

## notebook interface specific css variables

*/

:root {
    --nb-focus-width: 3px;
    --nb-accent-color: auto;
    --nb-background-color-dark: #2b2a33;
    --nb-background-color-light: #FFFFFF;
    --nb-margin: 5%;
    --nb-font-size: 16px;
    --nb-font-family: serif;
    --nb-line-height: 1.5;
}

/* map css variables to css properties on the `body` elements.
this mapping turns out css variables into user interfaces. */

body {
    font-size: var(--nb-font-size);
    font-family: var(--nb-font-family);
    accent-color: var(--nb-accent-color);
    margin-left: var(--nb-margin);
    margin-right: var(--nb-margin);
    line-height: var(--nb-line-height);
    width: calc(100% - 2*var(--nb-margin));
}

/* ## notebook settings

the notebook settings interface connects configurable css features to the user.
we use dialog elements to represents an element that should be hidden by default.
it turns out there are two ways to layout `dialog` elements. 
they can be used as modals or block elements.
we extract this dual purpose to provide both configurations to the user.

*/

dialog form&gt;* {
    display: block;
}

#nb-dialogs details[open]~dialog {
    position: relative;
}


/* ## wcag accessibility guidelines as a feature

flexibility is the future of assistive interfaces.
it is not in the purvey of privileged developers and inaccessible systems to decide what priority accessibility is.
it is the fucking priority.

in this implementation, we want to satisfy broad user needs by making a lot of features configurable.
one configurable feature is the accessibility priority. 
experienced developers may need less assistive features as they spend more time with an interface.

### buttons sizes

WCAG 2.1 defines a huge stinking AAA hit size for buttons. its beautiful.

/* satisfy AAA 2.5.5 */

.wcag-aaa button,
.wcag-aaa input[type=checkbox] {
    min-height: 44px;
    min-width: 44px;
}

.wcag-aaa a {
    font-size: max(44px, var(--nb-font-size));
}


/* WCAG 2.2 clarified a AA button size that is used to style checkboxes and buttons. */
/* satisfy AA 2.5.8 minimum target requirement */
.wcag-aa button,
.wcag-aa input[type=checkbox] {
    min-height: 24px;
    min-width: 24px;
}

.wcag-aa a {
    font-size: max(24px, var(--nb-font-size));
}

/* ### native textareas for AAA priority.

our AAA priority choices often ensure that third party libraries can not compromise the accessibility of notebook.
the design decisions are focused native elements so that the assistive technology users have consistent expectations and outcomes.

*/

.wcag-a textarea[name=source],
.wcag-aa textarea[name=source],
.wcag-aaa textarea[name=source]~* {
    display: none;
}


/* ## notebook components layout */

td[role=&quot;none&quot;]:not([hidden]) {
    display: unset;
}

#cells tr.cell,
#cells tbody {
    display: flex;
    flex-direction: column;
}

[reversed]#cells tbody {
    flex-direction: column-reverse;
}

/* hide the visual output area when there are no outputs. 
assistive technologies will recieve an audible notification that there are not outputs. */

fieldset[data-outputs=&quot;0&quot;] {
    display: none;
}

/* ## modifications to html defaults 

### focus 

there nothing to be said about this topic that [sara soueidan](https://www.sarasoueidan.com/blog/focus-indicators/) hasn't said.
we start with her [universal focus recommendation](https://www.sarasoueidan.com/blog/focus-indicators/#a-%E2%80%98universal%E2%80%99-focus-indicator).

*/



.cell:focus-within,
:focus-visible {
    outline: max(var(--nb-focus-width), 1px) solid;
    box-shadow: 0 0 0 calc(2 * max(var(--nb-focus-width), 1px));
}


/* on firefox, the input and output become interactive when there is overflow. chrome fixed this recently find reference.*/
textarea[name=source],
.cell&gt;td&gt;details {
    overflow: auto;
    min-width: 0;
}

#nb-settings li::marker,
summary[inert]::marker {
    content: &quot;&quot;;
}

/* ### inheriting styles */

input,
select,
button {
    font-family: inherit;
    font-size: inherit;
}

textarea {
    font-family: monospace;
    font-size: inherit;
    line-height: inherit;
    overflow: auto;
    color: unset;
}

textarea[name=source] {
    box-sizing: border-box;
    width: 100%;
    resize: vertical;
}


/* align checkboxes with buttons */
input[type=&quot;checkbox&quot;] {
    vertical-align: middle;
}

/* ## custom class selectors */

#nb-dialogs details:not([open])~dialog:not([open]):not(:focus-within):not(:active),
/* legend:not(:focus-within):not(:active), */
details.log:not([open])+table,
.visually-hidden:not(:focus-within):not(:active) {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 1px;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}
  &lt;/style&gt;
  &lt;style id=&quot;nb-light-theme&quot; media=&quot;screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-light-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #0969da4a }
.c { color: #66707b } /* Comment */
.err { color: #a0111f } /* Error */
.k { color: #a0111f } /* Keyword */
.l { color: #702c00 } /* Literal */
.n { color: #622cbc } /* Name */
.o { color: #024c1a } /* Operator */
.p { color: #24292f } /* Punctuation */
.ch { color: #66707b } /* Comment.Hashbang */
.cm { color: #66707b } /* Comment.Multiline */
.cp { color: #66707b } /* Comment.Preproc */
.cpf { color: #66707b } /* Comment.PreprocFile */
.c1 { color: #66707b } /* Comment.Single */
.cs { color: #66707b } /* Comment.Special */
.gd { color: #023b95 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #a0111f } /* Generic.Error */
.gh { color: #023b95 } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #023b95 } /* Generic.Subheading */
.kc { color: #023b95 } /* Keyword.Constant */
.kd { color: #a0111f } /* Keyword.Declaration */
.kn { color: #a0111f } /* Keyword.Namespace */
.kp { color: #a0111f } /* Keyword.Pseudo */
.kr { color: #a0111f } /* Keyword.Reserved */
.kt { color: #a0111f } /* Keyword.Type */
.ld { color: #702c00 } /* Literal.Date */
.m { color: #702c00 } /* Literal.Number */
.s { color: #023b95 } /* Literal.String */
.na { color: #702c00 } /* Name.Attribute */
.nb { color: #702c00 } /* Name.Builtin */
.nc { color: #023b95 } /* Name.Class */
.no { color: #023b95 } /* Name.Constant */
.nd { color: #702c00 } /* Name.Decorator */
.ni { color: #024c1a } /* Name.Entity */
.ne { color: #622cbc } /* Name.Exception */
.nf { color: #023b95 } /* Name.Function */
.nl { color: #702c00 } /* Name.Label */
.nn { color: #24292f } /* Name.Namespace */
.nx { color: #622cbc } /* Name.Other */
.py { color: #023b95 } /* Name.Property */
.nt { color: #024c1a } /* Name.Tag */
.nv { color: #702c00 } /* Name.Variable */
.ow { color: #622cbc } /* Operator.Word */
.pm { color: #24292f } /* Punctuation.Marker */
.w { color: #24292f } /* Text.Whitespace */
.mb { color: #702c00 } /* Literal.Number.Bin */
.mf { color: #702c00 } /* Literal.Number.Float */
.mh { color: #702c00 } /* Literal.Number.Hex */
.mi { color: #702c00 } /* Literal.Number.Integer */
.mo { color: #702c00 } /* Literal.Number.Oct */
.sa { color: #023b95 } /* Literal.String.Affix */
.sb { color: #023b95 } /* Literal.String.Backtick */
.sc { color: #023b95 } /* Literal.String.Char */
.dl { color: #023b95 } /* Literal.String.Delimiter */
.sd { color: #023b95 } /* Literal.String.Doc */
.s2 { color: #023b95 } /* Literal.String.Double */
.se { color: #023b95 } /* Literal.String.Escape */
.sh { color: #023b95 } /* Literal.String.Heredoc */
.si { color: #023b95 } /* Literal.String.Interpol */
.sx { color: #023b95 } /* Literal.String.Other */
.sr { color: #023b95 } /* Literal.String.Regex */
.s1 { color: #023b95 } /* Literal.String.Single */
.ss { color: #023b95 } /* Literal.String.Symbol */
.bp { color: #702c00 } /* Name.Builtin.Pseudo */
.fm { color: #023b95 } /* Name.Function.Magic */
.vc { color: #702c00 } /* Name.Variable.Class */
.vg { color: #702c00 } /* Name.Variable.Global */
.vi { color: #702c00 } /* Name.Variable.Instance */
.vm { color: #702c00 } /* Name.Variable.Magic */
.il { color: #702c00 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;style id=&quot;nb-dark-theme&quot; media=&quot;not  screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-dark-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #58a6ff70 }
.c { color: #d9dee3 } /* Comment */
.err { color: #ff9492 } /* Error */
.k { color: #ff9492 } /* Keyword */
.l { color: #ffb757 } /* Literal */
.n { color: #dbb7ff } /* Name */
.o { color: #72f088 } /* Operator */
.p { color: #C9D1D9 } /* Punctuation */
.ch { color: #d9dee3 } /* Comment.Hashbang */
.cm { color: #d9dee3 } /* Comment.Multiline */
.cp { color: #d9dee3 } /* Comment.Preproc */
.cpf { color: #d9dee3 } /* Comment.PreprocFile */
.c1 { color: #d9dee3 } /* Comment.Single */
.cs { color: #d9dee3 } /* Comment.Special */
.gd { color: #91cbff } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #ff9492 } /* Generic.Error */
.gh { color: #91cbff } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #91cbff } /* Generic.Subheading */
.kc { color: #91cbff } /* Keyword.Constant */
.kd { color: #ff9492 } /* Keyword.Declaration */
.kn { color: #ff9492 } /* Keyword.Namespace */
.kp { color: #ff9492 } /* Keyword.Pseudo */
.kr { color: #ff9492 } /* Keyword.Reserved */
.kt { color: #ff9492 } /* Keyword.Type */
.ld { color: #ffb757 } /* Literal.Date */
.m { color: #ffb757 } /* Literal.Number */
.s { color: #91cbff } /* Literal.String */
.na { color: #ffb757 } /* Name.Attribute */
.nb { color: #ffb757 } /* Name.Builtin */
.nc { color: #91cbff } /* Name.Class */
.no { color: #91cbff } /* Name.Constant */
.nd { color: #ffb757 } /* Name.Decorator */
.ni { color: #72f088 } /* Name.Entity */
.ne { color: #dbb7ff } /* Name.Exception */
.nf { color: #91cbff } /* Name.Function */
.nl { color: #ffb757 } /* Name.Label */
.nn { color: #C9D1D9 } /* Name.Namespace */
.nx { color: #dbb7ff } /* Name.Other */
.py { color: #91cbff } /* Name.Property */
.nt { color: #72f088 } /* Name.Tag */
.nv { color: #ffb757 } /* Name.Variable */
.ow { color: #dbb7ff } /* Operator.Word */
.pm { color: #C9D1D9 } /* Punctuation.Marker */
.w { color: #C9D1D9 } /* Text.Whitespace */
.mb { color: #ffb757 } /* Literal.Number.Bin */
.mf { color: #ffb757 } /* Literal.Number.Float */
.mh { color: #ffb757 } /* Literal.Number.Hex */
.mi { color: #ffb757 } /* Literal.Number.Integer */
.mo { color: #ffb757 } /* Literal.Number.Oct */
.sa { color: #91cbff } /* Literal.String.Affix */
.sb { color: #91cbff } /* Literal.String.Backtick */
.sc { color: #91cbff } /* Literal.String.Char */
.dl { color: #91cbff } /* Literal.String.Delimiter */
.sd { color: #91cbff } /* Literal.String.Doc */
.s2 { color: #91cbff } /* Literal.String.Double */
.se { color: #91cbff } /* Literal.String.Escape */
.sh { color: #91cbff } /* Literal.String.Heredoc */
.si { color: #91cbff } /* Literal.String.Interpol */
.sx { color: #91cbff } /* Literal.String.Other */
.sr { color: #91cbff } /* Literal.String.Regex */
.s1 { color: #91cbff } /* Literal.String.Single */
.ss { color: #91cbff } /* Literal.String.Symbol */
.bp { color: #ffb757 } /* Name.Builtin.Pseudo */
.fm { color: #91cbff } /* Name.Function.Magic */
.vc { color: #ffb757 } /* Name.Variable.Class */
.vg { color: #ffb757 } /* Name.Variable.Global */
.vi { color: #ffb757 } /* Name.Variable.Instance */
.vm { color: #ffb757 } /* Name.Variable.Magic */
.il { color: #ffb757 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;!-- Load mathjax --&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe&quot;&gt;
  &lt;/script&gt;
  &lt;!-- MathJax configuration --&gt;
  &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
   init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: &quot;AMS&quot;,
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], [&quot;\\(&quot;,&quot;\\)&quot;] ],
                    displayMath: [ ['$$','$$'], [&quot;\\[&quot;,&quot;\\]&quot;] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue([&quot;Typeset&quot;, MathJax.Hub]);
        }
    }
    init_mathjax();
  &lt;/script&gt;
  &lt;!-- End of mathjax configuration --&gt;
  &lt;script type=&quot;module&quot;&gt;
   document.addEventListener(&quot;DOMContentLoaded&quot;, async () =&gt; {
    const diagrams = document.querySelectorAll(&quot;.jp-Mermaid &gt; pre.mermaid&quot;);
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import(&quot;https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.5.0/mermaid.esm.min.mjs&quot;)).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue(&quot;--jp-ui-font-family&quot;),
      theme: document.querySelector(&quot;body[data-jp-theme-light='true']&quot;)
        ? &quot;default&quot;
        : &quot;dark&quot;,
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement(&quot;img&quot;);
      const doc = parser.parseFromString(svg, &quot;image/svg+xml&quot;);
      const svgEl = doc.querySelector(&quot;svg&quot;);
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector(&quot;title&quot;);
      const firstDesc = doc.querySelector(&quot;desc&quot;);

      img.setAttribute(&quot;src&quot;, `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute(&quot;alt&quot;, firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement(&quot;figcaption&quot;);
        caption.className = &quot;sr-only&quot;;
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = &quot;&quot;;
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement(&quot;details&quot;);
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement(&quot;summary&quot;);
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement(&quot;pre&quot;);
      const code = document.createElement(&quot;code&quot;);
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement(&quot;pre&quot;);
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement(&quot;div&quot;);
      el.style.visibility = &quot;hidden&quot;;
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        const { svg } = await mermaid.render(id, raw, el);
        results = makeMermaidImage(svg);
        output = document.createElement(&quot;figure&quot;);
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add(&quot;jp-mod-warning&quot;);
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add(&quot;jp-RenderedMermaid&quot;);
      parent.appendChild(output);
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
  &lt;/script&gt;
  &lt;style&gt;
   .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details &gt; pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary &gt; pre {
    display: inline-block;
    white-space: normal;
  }
  &lt;/style&gt;
  &lt;!-- End of mermaid configuration --&gt;
 &lt;/head&gt;
 &lt;body class=&quot;wcag-aa&quot;&gt;
  &lt;header aria-label=&quot;site header&quot;&gt;
   &lt;a href=&quot;#1&quot; id=&quot;TOP&quot;&gt;
    skip to main content
   &lt;/a&gt;
  &lt;/header&gt;
  &lt;main aria-labelledby=&quot;nb-notebook-label&quot;&gt;
   &lt;section aria-labelledby=&quot;nb-toc&quot;&gt;
    &lt;details open&gt;
     &lt;summary id=&quot;toc&quot;&gt;
      &lt;span id=&quot;nb-toc&quot;&gt;
       table of contents
      &lt;/span&gt;
     &lt;/summary&gt;
     &lt;a id=&quot;nb-toc-start&quot;&gt;
     &lt;/a&gt;
     &lt;ol aria-labelledby=&quot;nb-toc&quot;&gt;
     &lt;/ol&gt;
     &lt;ol&gt;
      &lt;li&gt;
       &lt;a href=&quot;#read-and-display-a-tess-target-pixel-file&quot;&gt;
        Read and Display A TESS Target Pixel File
       &lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;
         &lt;a href=&quot;#introduction&quot;&gt;
          Introduction
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#obtaining-the-target-pixel-file&quot;&gt;
          Obtaining The Target Pixel File
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#understanding-the-target-pixel-file-structure&quot;&gt;
          Understanding The Target Pixel File Structure
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#reading-the-timestamps-and-fluxes&quot;&gt;
          Reading the timestamps and fluxes.
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#show-the-calibrated-pixel-values&quot;&gt;
          Show the calibrated pixel values.
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#displaying-the-aperture-pixel-information&quot;&gt;
          Displaying The Aperture Pixel Information
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#understanding-the-aperture-pixel-values&quot;&gt;
          Understanding The Aperture Pixel Values
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#marking-all-pixels-used-in-the-photometric-aperture&quot;&gt;
          Marking All Pixels Used In The Photometric Aperture
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#about-this-notebook&quot;&gt;
          About this Notebook
         &lt;/a&gt;
        &lt;/li&gt;
       &lt;/ol&gt;
      &lt;/li&gt;
     &lt;/ol&gt;
    &lt;/details&gt;
   &lt;/section&gt;
   &lt;table id=&quot;cells&quot; role=&quot;presentation&quot;&gt;
    &lt;tbody aria-labelledby=&quot;nb-notebook-label nb-cells-label&quot; role=&quot;list&quot;&gt;
     &lt;tr hidden&gt;
      &lt;th scope=&quot;col&quot;&gt;
       index
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       execution_count
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       cell_type
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       toolbar
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       started_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       completed_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       source
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       loc
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       metadata
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       outputs
      &lt;/th&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 1 cell-1-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;1&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;1&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-1-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 1&quot; href=&quot;#1&quot; id=&quot;1&quot;&gt;
        1
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-1-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-1-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-1&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-1-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-1-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-1&quot; name=&quot;cell-1&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-1-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-1-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-1-source-label nb-source-label&quot; form=&quot;cell-1&quot; id=&quot;cell-1-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;&amp;lt;a id=&quot;title_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
# Read and Display A TESS Target Pixel File

This notebook tutorial demonstrates how to load and display the contents of a TESS target pixel (tp) file.  We will display the flux values from a given cadence, and identify the pixels used in the photometric aperture.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;title_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gh&quot; title=&quot;Generic.Heading&quot;&gt;# Read and Display A TESS Target Pixel File&lt;/span&gt;

This notebook tutorial demonstrates how to load and display the contents of a TESS target pixel (tp) file.  We will display the flux values from a given cadence, and identify the pixels used in the photometric aperture.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-1-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-1&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-1-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-1-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;title_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h1 id=&quot;read-and-display-a-tess-target-pixel-file&quot;&gt;
        &lt;a href=&quot;#read-and-display-a-tess-target-pixel-file&quot;&gt;
         Read and Display A TESS Target Pixel File
        &lt;/a&gt;
       &lt;/h1&gt;
       &lt;p&gt;
        This notebook tutorial demonstrates how to load and display the contents of a TESS target pixel (tp) file.  We will display the flux values from a given cadence, and identify the pixels used in the photometric aperture.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 2 cell-2-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;2&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;2&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-2-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 2&quot; href=&quot;#2&quot; id=&quot;2&quot;&gt;
        2
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-2-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-2-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-2&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-2-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-2-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-2&quot; name=&quot;cell-2&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-2-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-2-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-2-source-label nb-source-label&quot; form=&quot;cell-2&quot; id=&quot;cell-2-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;%matplotlib inline
from astropy.io import fits
import matplotlib.pyplot as plt
import numpy as np&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;inline&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astropy.io&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;np&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-2-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-2&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-2-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-2-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-2-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 3 cell-3-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;3&quot; data-loc=&quot;10&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;3&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-3-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 3&quot; href=&quot;#3&quot; id=&quot;3&quot;&gt;
        3
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-3-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-3-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-3&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-3-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-3-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-3&quot; name=&quot;cell-3&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-3-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-3-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-3-source-label nb-source-label&quot; form=&quot;cell-3&quot; id=&quot;cell-3-source&quot; name=&quot;source&quot; readonly rows=&quot;10&quot;&gt;## Introduction

A target pixel file contains the raw and calibrated fluxes for the pixels downloaded at a cadence shorter than the full frame images.  Nominally, these are at a two-minute cadence.  It also contains information about the aperture, including which pixels were used to calculate the total flux, which pixels were used to estimate the background flux, and which pixels were used to calculate the flux weighted or pixel response function centroids.  The data shown here will be for the star TIC 25155310, which is known to host at least one planet, WASP-126 b.

This tutorial will refer to a couple TESS-related terms that we define here.
* Sector = TESS observed the sky in regions of 24x96 degrees along the southern, then northern, ecliptic hemispheres.  Each of these regions is referred to as a &quot;sector&quot;, starting with Sector 1.
* HDU = Header Data Unit.  A FITS file is made up of HDUs that contain data and metadata relating to the file. The first HDU is called the primary HDU, and anything that follows is considered an &quot;extension&quot;, e.g., &quot;the first FITS extension&quot;, &quot;the second FITS extension&quot;, etc.
* BJD = Barycentric Julian Date, the Julian Date that has been corrected for differences in the Earth's position with respect to the Solar System center of mass.
* TBJD = TESS Barycentric Julian Date, the timestamp measured in BJD, but offset by 2457000.0.  I.e., TBJD = BJD - 2457000.0
* Cadence = The interval between flux measurements, nominally ~2 minutes for the target pixel files, and ~30 minutes for the full frame images.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Introduction&lt;/span&gt;

A target pixel file contains the raw and calibrated fluxes for the pixels downloaded at a cadence shorter than the full frame images.  Nominally, these are at a two-minute cadence.  It also contains information about the aperture, including which pixels were used to calculate the total flux, which pixels were used to estimate the background flux, and which pixels were used to calculate the flux weighted or pixel response function centroids.  The data shown here will be for the star TIC 25155310, which is known to host at least one planet, WASP-126 b.

This tutorial will refer to a couple TESS-related terms that we define here.
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Sector = TESS observed the sky in regions of 24x96 degrees along the southern, then northern, ecliptic hemispheres.  Each of these regions is referred to as a &quot;sector&quot;, starting with Sector 1.
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;HDU = Header Data Unit.  A FITS file is made up of HDUs that contain data and metadata relating to the file. The first HDU is called the primary HDU, and anything that follows is considered an &quot;extension&quot;, e.g., &quot;the first FITS extension&quot;, &quot;the second FITS extension&quot;, etc.
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;BJD = Barycentric Julian Date, the Julian Date that has been corrected for differences in the Earth's position with respect to the Solar System center of mass.
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;TBJD = TESS Barycentric Julian Date, the timestamp measured in BJD, but offset by 2457000.0.  I.e., TBJD = BJD - 2457000.0
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Cadence = The interval between flux measurements, nominally ~2 minutes for the target pixel files, and ~30 minutes for the full frame images.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-3-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-3&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-3-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-3-loc&quot; role=&quot;none&quot;&gt;
       10
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;introduction&quot;&gt;
        &lt;a href=&quot;#introduction&quot;&gt;
         Introduction
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        A target pixel file contains the raw and calibrated fluxes for the pixels downloaded at a cadence shorter than the full frame images.  Nominally, these are at a two-minute cadence.  It also contains information about the aperture, including which pixels were used to calculate the total flux, which pixels were used to estimate the background flux, and which pixels were used to calculate the flux weighted or pixel response function centroids.  The data shown here will be for the star TIC 25155310, which is known to host at least one planet, WASP-126 b.
       &lt;/p&gt;
       &lt;p&gt;
        This tutorial will refer to a couple TESS-related terms that we define here.
       &lt;/p&gt;
       &lt;ul&gt;
        &lt;li&gt;
         Sector = TESS observed the sky in regions of 24x96 degrees along the southern, then northern, ecliptic hemispheres.  Each of these regions is referred to as a &quot;sector&quot;, starting with Sector 1.
        &lt;/li&gt;
        &lt;li&gt;
         HDU = Header Data Unit.  A FITS file is made up of HDUs that contain data and metadata relating to the file. The first HDU is called the primary HDU, and anything that follows is considered an &quot;extension&quot;, e.g., &quot;the first FITS extension&quot;, &quot;the second FITS extension&quot;, etc.
        &lt;/li&gt;
        &lt;li&gt;
         BJD = Barycentric Julian Date, the Julian Date that has been corrected for differences in the Earth's position with respect to the Solar System center of mass.
        &lt;/li&gt;
        &lt;li&gt;
         TBJD = TESS Barycentric Julian Date, the timestamp measured in BJD, but offset by 2457000.0.  I.e., TBJD = BJD - 2457000.0
        &lt;/li&gt;
        &lt;li&gt;
         Cadence = The interval between flux measurements, nominally ~2 minutes for the target pixel files, and ~30 minutes for the full frame images.
        &lt;/li&gt;
       &lt;/ul&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 4 cell-4-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;4&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;4&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-4-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 4&quot; href=&quot;#4&quot; id=&quot;4&quot;&gt;
        4
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-4-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-4-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-4&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-4-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-4-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-4&quot; name=&quot;cell-4&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-4-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-4-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-4-source-label nb-source-label&quot; form=&quot;cell-4&quot; id=&quot;cell-4-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Obtaining The Target Pixel File

We will read the target pixel file from Sector 1 using the MAST URL location.  So that we can get started with understanding the file contents without reviewing how to automatically search for and retrieve TESS files, we won't show how to search and retrieve TESS target pixel files in this tutorial. Consult other TESS tutorials [in the TESS Archive Handbook](https://outerspace.stsci.edu/display/TESS/6.0+-+Data+Search+Tutorials) for much more information on how to search for TESS data using MAST services.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Obtaining The Target Pixel File&lt;/span&gt;

We will read the target pixel file from Sector 1 using the MAST URL location.  So that we can get started with understanding the file contents without reviewing how to automatically search for and retrieve TESS files, we won't show how to search and retrieve TESS target pixel files in this tutorial. Consult other TESS tutorials [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;in the TESS Archive Handbook&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://outerspace.stsci.edu/display/TESS/6.0+-+Data+Search+Tutorials&lt;/span&gt;) for much more information on how to search for TESS data using MAST services.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-4-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-4&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-4-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-4-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;obtaining-the-target-pixel-file&quot;&gt;
        &lt;a href=&quot;#obtaining-the-target-pixel-file&quot;&gt;
         Obtaining The Target Pixel File
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        We will read the target pixel file from Sector 1 using the MAST URL location.  So that we can get started with understanding the file contents without reviewing how to automatically search for and retrieve TESS files, we won't show how to search and retrieve TESS target pixel files in this tutorial. Consult other TESS tutorials
        &lt;a href=&quot;https://outerspace.stsci.edu/display/TESS/6.0+-+Data+Search+Tutorials&quot;&gt;
         in the TESS Archive Handbook
        &lt;/a&gt;
        for much more information on how to search for TESS data using MAST services.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 5 cell-5-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;5&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;5&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-5-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 5&quot; href=&quot;#5&quot; id=&quot;5&quot;&gt;
        5
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-5-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-5-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-5&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-5-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-5-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-5&quot; name=&quot;cell-5&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-5-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-5-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-5-source-label nb-source-label&quot; form=&quot;cell-5&quot; id=&quot;cell-5-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;# For the purposes of this tutorial, we just know the MAST URL location of the file we want to examine.
fits_file = &quot;https://archive.stsci.edu/missions/tess/tid/s0001/0000/0000/2515/5310/tess2018206045859-s0001-0000000025155310-0120-s_tp.fits&quot;&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# For the purposes of this tutorial, we just know the MAST URL location of the file we want to examine.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits_file&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;https://archive.stsci.edu/missions/tess/tid/s0001/0000/0000/2515/5310/tess2018206045859-s0001-0000000025155310-0120-s_tp.fits&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-5-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-5&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-5-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-5-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-5-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 6 cell-6-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;6&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;6&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-6-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 6&quot; href=&quot;#6&quot; id=&quot;6&quot;&gt;
        6
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-6-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-6-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-6&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-6-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-6-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-6&quot; name=&quot;cell-6&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-6-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-6-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-6-source-label nb-source-label&quot; form=&quot;cell-6&quot; id=&quot;cell-6-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Understanding The Target Pixel File Structure

The TESS target pixel files contain a primary HDU with metadata stored in the header.  The first extension HDU contains more metadata in the header and stores arrays of data in a binary FITS table, which include the timestamps, fluxes, and background fluxes for each cadence of the pixels read out and downloaded by the spacecraft.  The second extension HDU contains an image that stores the pixels that were read out, and records information such as which pixels were used in the optimal photometric aperture to create the SAP fluxes.  The third extension HDU is a placeholder and is not currently used by the mission:  it can be ignored.  Let's examine the structure of the FITS file using the astropy.fits `info` function, which shows the FITS file format in more detail.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Understanding The Target Pixel File Structure&lt;/span&gt;

The TESS target pixel files contain a primary HDU with metadata stored in the header.  The first extension HDU contains more metadata in the header and stores arrays of data in a binary FITS table, which include the timestamps, fluxes, and background fluxes for each cadence of the pixels read out and downloaded by the spacecraft.  The second extension HDU contains an image that stores the pixels that were read out, and records information such as which pixels were used in the optimal photometric aperture to create the SAP fluxes.  The third extension HDU is a placeholder and is not currently used by the mission:  it can be ignored.  Let's examine the structure of the FITS file using the astropy.fits &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`info`&lt;/span&gt; function, which shows the FITS file format in more detail.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-6-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-6&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-6-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-6-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;understanding-the-target-pixel-file-structure&quot;&gt;
        &lt;a href=&quot;#understanding-the-target-pixel-file-structure&quot;&gt;
         Understanding The Target Pixel File Structure
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        The TESS target pixel files contain a primary HDU with metadata stored in the header.  The first extension HDU contains more metadata in the header and stores arrays of data in a binary FITS table, which include the timestamps, fluxes, and background fluxes for each cadence of the pixels read out and downloaded by the spacecraft.  The second extension HDU contains an image that stores the pixels that were read out, and records information such as which pixels were used in the optimal photometric aperture to create the SAP fluxes.  The third extension HDU is a placeholder and is not currently used by the mission:  it can be ignored.  Let's examine the structure of the FITS file using the astropy.fits
        &lt;code&gt;
         info
        &lt;/code&gt;
        function, which shows the FITS file format in more detail.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 7 cell-7-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;7&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;7&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-7-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 7&quot; href=&quot;#7&quot; id=&quot;7&quot;&gt;
        7
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-7-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-7-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-7&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-7-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-7-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-7&quot; name=&quot;cell-7&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-7-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-7-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-7-source-label nb-source-label&quot; form=&quot;cell-7&quot; id=&quot;cell-7-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;fits.info(fits_file)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits_file&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-7-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-7&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-7-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-7-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-7-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 8 cell-8-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;8&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;8&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-8-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 8&quot; href=&quot;#8&quot; id=&quot;8&quot;&gt;
        8
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-8-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-8-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-8&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-8-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-8-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-8&quot; name=&quot;cell-8&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-8-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-8-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-8-source-label nb-source-label&quot; form=&quot;cell-8&quot; id=&quot;cell-8-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Let's examine the binary table in the first FITS extension, since that contains the arrays of timestamps and fluxes for each cadence.  We will use the astropy.fits `getdata` function to access the table from the first extension HDU, and then show the columns of the table.  We can see included in the table are columns for the timestamps in TESS BJD format (**TIME**), raw counts (**RAW_CNTS**), and calibrated fluxes (**FLUX**).&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Let's examine the binary table in the first FITS extension, since that contains the arrays of timestamps and fluxes for each cadence.  We will use the astropy.fits &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`getdata`&lt;/span&gt; function to access the table from the first extension HDU, and then show the columns of the table.  We can see included in the table are columns for the timestamps in TESS BJD format (&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**TIME**&lt;/span&gt;), raw counts (&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**RAW_CNTS**&lt;/span&gt;), and calibrated fluxes (&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**FLUX**&lt;/span&gt;).
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-8-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-8&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-8-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-8-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Let's examine the binary table in the first FITS extension, since that contains the arrays of timestamps and fluxes for each cadence.  We will use the astropy.fits
        &lt;code&gt;
         getdata
        &lt;/code&gt;
        function to access the table from the first extension HDU, and then show the columns of the table.  We can see included in the table are columns for the timestamps in TESS BJD format (
        &lt;strong&gt;
         TIME
        &lt;/strong&gt;
        ), raw counts (
        &lt;strong&gt;
         RAW_CNTS
        &lt;/strong&gt;
        ), and calibrated fluxes (
        &lt;strong&gt;
         FLUX
        &lt;/strong&gt;
        ).
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 9 cell-9-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;9&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;9&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-9-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 9&quot; href=&quot;#9&quot; id=&quot;9&quot;&gt;
        9
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-9-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-9-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-9&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-9-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-9-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-9&quot; name=&quot;cell-9&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-9-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-9-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-9-source-label nb-source-label&quot; form=&quot;cell-9&quot; id=&quot;cell-9-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;fits.getdata(fits_file, ext=1).columns&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getdata&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits_file&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ext&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;columns&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-9-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-9&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-9-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-9-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-9-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 10 cell-10-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;10&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-10-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 10&quot; href=&quot;#10&quot; id=&quot;10&quot;&gt;
        10
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-10-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-10-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-10&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-10-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-10-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-10&quot; name=&quot;cell-10&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-10-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-10-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-10-source-label nb-source-label&quot; form=&quot;cell-10&quot; id=&quot;cell-10-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;If you examine the structure of the data, the table is more complicated than just rows and columns of values.  You can see the dimensions of the raw counts, flux, flux errors, flux backgrounds, and flux background errors are 11x11 (the size of the pixel stamp read out for this particular target).  We'll show how to examine the fluxes from a particular cadence below.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;If you examine the structure of the data, the table is more complicated than just rows and columns of values.  You can see the dimensions of the raw counts, flux, flux errors, flux backgrounds, and flux background errors are 11x11 (the size of the pixel stamp read out for this particular target).  We'll show how to examine the fluxes from a particular cadence below.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-10-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-10&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-10-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-10-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        If you examine the structure of the data, the table is more complicated than just rows and columns of values.  You can see the dimensions of the raw counts, flux, flux errors, flux backgrounds, and flux background errors are 11x11 (the size of the pixel stamp read out for this particular target).  We'll show how to examine the fluxes from a particular cadence below.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 11 cell-11-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;11&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-11-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 11&quot; href=&quot;#11&quot; id=&quot;11&quot;&gt;
        11
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-11-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-11-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-11&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-11-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-11-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-11&quot; name=&quot;cell-11&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-11-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-11-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-11-source-label nb-source-label&quot; form=&quot;cell-11&quot; id=&quot;cell-11-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Reading the timestamps and fluxes.

Now that we have the target pixel file, let's store the timestamps and fluxes for use later.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Reading the timestamps and fluxes.&lt;/span&gt;

Now that we have the target pixel file, let's store the timestamps and fluxes for use later.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-11-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-11&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-11-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-11-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;reading-the-timestamps-and-fluxes&quot;&gt;
        &lt;a href=&quot;#reading-the-timestamps-and-fluxes&quot;&gt;
         Reading the timestamps and fluxes.
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Now that we have the target pixel file, let's store the timestamps and fluxes for use later.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 12 cell-12-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;12&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-12-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 12&quot; href=&quot;#12&quot; id=&quot;12&quot;&gt;
        12
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-12-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-12-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-12&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-12-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-12-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-12&quot; name=&quot;cell-12&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-12-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-12-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-12-source-label nb-source-label&quot; form=&quot;cell-12&quot; id=&quot;cell-12-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;with fits.open(fits_file, mode=&quot;readonly&quot;) as hdulist:
    tess_bjds = hdulist[1].data['TIME']
    raw_counts = hdulist[1].data['RAW_CNTS']
    calibrated_fluxes = hdulist[1].data['FLUX']&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits_file&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;readonly&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tess_bjds&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TIME'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;raw_counts&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'RAW_CNTS'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;calibrated_fluxes&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'FLUX'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-12-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-12&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-12-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-12-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-12-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 13 cell-13-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;13&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-13-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 13&quot; href=&quot;#13&quot; id=&quot;13&quot;&gt;
        13
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-13-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-13-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-13&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-13-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-13-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-13&quot; name=&quot;cell-13&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-13-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-13-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-13-source-label nb-source-label&quot; form=&quot;cell-13&quot; id=&quot;cell-13-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Let's examine one of these to see how Python stores the data.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Let's examine one of these to see how Python stores the data.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-13-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-13&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-13-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-13-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Let's examine one of these to see how Python stores the data.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 14 cell-14-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;14&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-14-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 14&quot; href=&quot;#14&quot; id=&quot;14&quot;&gt;
        14
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-14-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-14-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-14&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-14-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-14-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-14&quot; name=&quot;cell-14&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-14-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-14-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-14-source-label nb-source-label&quot; form=&quot;cell-14&quot; id=&quot;cell-14-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;print(type(calibrated_fluxes))
print(calibrated_fluxes.shape)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;calibrated_fluxes&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;calibrated_fluxes&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-14-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-14&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-14-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-14-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-14-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 15 cell-15-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;15&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-15-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 15&quot; href=&quot;#15&quot; id=&quot;15&quot;&gt;
        15
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-15-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-15-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-15&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-15-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-15-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-15&quot; name=&quot;cell-15&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-15-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-15-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-15-source-label nb-source-label&quot; form=&quot;cell-15&quot; id=&quot;cell-15-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;So these data are stored as a numpy array.  The first dimension is the number of cadences, followed by the size of the readout.  Thus, accessing `calibrated_fluxes[4,:,:]` should return to us the 11x11 grid of pixels from the **fifth** cadence (remember Python is zero-indexed, so the first cadence is stored in the zeroth index, the second in the first index, etc.)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;So these data are stored as a numpy array.  The first dimension is the number of cadences, followed by the size of the readout.  Thus, accessing &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`calibrated_fluxes[4,:,:]`&lt;/span&gt; should return to us the 11x11 grid of pixels from the &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**fifth**&lt;/span&gt; cadence (remember Python is zero-indexed, so the first cadence is stored in the zeroth index, the second in the first index, etc.)
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-15-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-15&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-15-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-15-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        So these data are stored as a numpy array.  The first dimension is the number of cadences, followed by the size of the readout.  Thus, accessing
        &lt;code&gt;
         calibrated_fluxes[4,:,:]
        &lt;/code&gt;
        should return to us the 11x11 grid of pixels from the
        &lt;strong&gt;
         fifth
        &lt;/strong&gt;
        cadence (remember Python is zero-indexed, so the first cadence is stored in the zeroth index, the second in the first index, etc.)
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 16 cell-16-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;16&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-16-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 16&quot; href=&quot;#16&quot; id=&quot;16&quot;&gt;
        16
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-16-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-16-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-16&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-16-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-16-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-16&quot; name=&quot;cell-16&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-16-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-16-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-16-source-label nb-source-label&quot; form=&quot;cell-16&quot; id=&quot;cell-16-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;calibrated_fluxes[4,:,:].shape&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;calibrated_fluxes&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,:,:]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;shape&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-16-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-16&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-16-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-16-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-16-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 17 cell-17-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;17&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-17-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 17&quot; href=&quot;#17&quot; id=&quot;17&quot;&gt;
        17
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-17-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-17-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-17&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-17-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-17-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-17&quot; name=&quot;cell-17&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-17-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-17-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-17-source-label nb-source-label&quot; form=&quot;cell-17&quot; id=&quot;cell-17-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Show the calibrated pixel values.

Let's display the calibrated fluxes for one of the cadences in our target pixel file.  For now, we'll pick the fifth cadence (index number 4).  You could of course decide to look at multiple cadences by looping over each index in the first dimension of the structure (e.g., loop over `calibrated_fluxes[i,:,:]`).  You could even make an animated .gif of the fluxes and see how they change from cadence to cadence.  To get you started though, let's just display one of the cadence's flux values.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Show the calibrated pixel values.&lt;/span&gt;

Let's display the calibrated fluxes for one of the cadences in our target pixel file.  For now, we'll pick the fifth cadence (index number 4).  You could of course decide to look at multiple cadences by looping over each index in the first dimension of the structure (e.g., loop over &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`calibrated_fluxes[i,:,:]`&lt;/span&gt;).  You could even make an animated .gif of the fluxes and see how they change from cadence to cadence.  To get you started though, let's just display one of the cadence's flux values.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-17-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-17&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-17-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-17-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;show-the-calibrated-pixel-values&quot;&gt;
        &lt;a href=&quot;#show-the-calibrated-pixel-values&quot;&gt;
         Show the calibrated pixel values.
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Let's display the calibrated fluxes for one of the cadences in our target pixel file.  For now, we'll pick the fifth cadence (index number 4).  You could of course decide to look at multiple cadences by looping over each index in the first dimension of the structure (e.g., loop over
        &lt;code&gt;
         calibrated_fluxes[i,:,:]
        &lt;/code&gt;
        ).  You could even make an animated .gif of the fluxes and see how they change from cadence to cadence.  To get you started though, let's just display one of the cadence's flux values.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 18 cell-18-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;18&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-18-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 18&quot; href=&quot;#18&quot; id=&quot;18&quot;&gt;
        18
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-18-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-18-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-18&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-18-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-18-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-18&quot; name=&quot;cell-18&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-18-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-18-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-18-source-label nb-source-label&quot; form=&quot;cell-18&quot; id=&quot;cell-18-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;# Start figure and axis.
fig, ax = plt.subplots()

# Display the calibrated fluxes as an image for the fifth cadence.
cax = ax.imshow(calibrated_fluxes[4,:,:], cmap=plt.cm.YlGnBu_r, origin=&quot;lower&quot;)

# Let's define a title for the figure.
fig.suptitle(&quot;WASP-126 b Calibrated Fluxes - Sector 1, Fifth Cadence&quot;)

# Add a color bar.
cbar = fig.colorbar(cax)
plt.show()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Start figure and axis.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Display the calibrated fluxes as an image for the fifth cadence.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;calibrated_fluxes&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,:,:],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;YlGnBu_r&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;lower&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Let's define a title for the figure.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;suptitle&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;WASP-126 b Calibrated Fluxes - Sector 1, Fifth Cadence&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Add a color bar.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cbar&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-18-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-18&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-18-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-18-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-18-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 19 cell-19-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;19&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-19-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 19&quot; href=&quot;#19&quot; id=&quot;19&quot;&gt;
        19
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-19-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-19-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-19&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-19-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-19-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-19&quot; name=&quot;cell-19&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-19-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-19-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-19-source-label nb-source-label&quot; form=&quot;cell-19&quot; id=&quot;cell-19-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Displaying The Aperture Pixel Information

Let's read in the second FITS extension HDU to display the aperture information.  First, let's read in the aperture pixels from the HDU.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Displaying The Aperture Pixel Information&lt;/span&gt;

Let's read in the second FITS extension HDU to display the aperture information.  First, let's read in the aperture pixels from the HDU.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-19-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-19&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-19-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-19-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;displaying-the-aperture-pixel-information&quot;&gt;
        &lt;a href=&quot;#displaying-the-aperture-pixel-information&quot;&gt;
         Displaying The Aperture Pixel Information
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Let's read in the second FITS extension HDU to display the aperture information.  First, let's read in the aperture pixels from the HDU.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 20 cell-20-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;20&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-20-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 20&quot; href=&quot;#20&quot; id=&quot;20&quot;&gt;
        20
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-20-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-20-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-20&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-20-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-20-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-20&quot; name=&quot;cell-20&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-20-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-20-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-20-source-label nb-source-label&quot; form=&quot;cell-20&quot; id=&quot;cell-20-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;with fits.open(fits_file, mode=&quot;readonly&quot;) as hdulist:
    aperture = hdulist[2].data&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits_file&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;readonly&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-20-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-20&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-20-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-20-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-20-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 21 cell-21-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;21&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-21-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 21&quot; href=&quot;#21&quot; id=&quot;21&quot;&gt;
        21
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-21-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-21-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-21&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-21-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-21-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-21&quot; name=&quot;cell-21&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-21-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-21-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-21-source-label nb-source-label&quot; form=&quot;cell-21&quot; id=&quot;cell-21-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Let's plot the pixels as an image.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Let's plot the pixels as an image.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-21-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-21&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-21-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-21-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Let's plot the pixels as an image.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 22 cell-22-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;22&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-22-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 22&quot; href=&quot;#22&quot; id=&quot;22&quot;&gt;
        22
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-22-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-22-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-22&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-22-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-22-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-22&quot; name=&quot;cell-22&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-22-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-22-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-22-source-label nb-source-label&quot; form=&quot;cell-22&quot; id=&quot;cell-22-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;# Start figure and axis.
fig, ax = plt.subplots()

# Display the pixels as an image.
cax = ax.imshow(aperture, cmap=plt.cm.YlGnBu_r, origin=&quot;lower&quot;)

# Add a color bar.
cbar = fig.colorbar(cax)

# Add a title to the plot.
fig.suptitle(&quot;WASP-126 b Aperture - Sector 1&quot;)
plt.show()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Start figure and axis.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Display the pixels as an image.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;YlGnBu_r&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;lower&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Add a color bar.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cbar&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Add a title to the plot.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;suptitle&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;WASP-126 b Aperture - Sector 1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-22-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-22&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-22-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-22-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-22-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 23 cell-23-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;23&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-23-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 23&quot; href=&quot;#23&quot; id=&quot;23&quot;&gt;
        23
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-23-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-23-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-23&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-23-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-23-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-23&quot; name=&quot;cell-23&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-23-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-23-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-23-source-label nb-source-label&quot; form=&quot;cell-23&quot; id=&quot;cell-23-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Understanding The Aperture Pixel Values

We see the pixel values are integers, but what do they mean?  The pixels are bitmasks that encode information about each pixel.  You can find a summary of what the different values mean [here](https://outerspace.stsci.edu/display/TESS/2.0+-+Data+Product+Overview#id-2.0-DataProductOverview-Table:ApertureMaskImageFlags).  For example, a pixel in the aperture that might have a value of 57 can be broken down into power of 2 like: 32+16+8+1 = 57.  Referencing the table of values, this means this particular pixel was in CCD Output A, was used to calculate the PRF centroid, was used to calculate the flux weighted centroid, and was collected by the spacecraft.  Numpy has a bulit-in function that can convert an integer into a binary bit mask.  Let's use that now one one of the common values we see in our displayed image above.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Understanding The Aperture Pixel Values&lt;/span&gt;

We see the pixel values are integers, but what do they mean?  The pixels are bitmasks that encode information about each pixel.  You can find a summary of what the different values mean [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;here&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://outerspace.stsci.edu/display/TESS/2.0+-+Data+Product+Overview#id-2.0-DataProductOverview-Table:ApertureMaskImageFlags&lt;/span&gt;).  For example, a pixel in the aperture that might have a value of 57 can be broken down into power of 2 like: 32+16+8+1 = 57.  Referencing the table of values, this means this particular pixel was in CCD Output A, was used to calculate the PRF centroid, was used to calculate the flux weighted centroid, and was collected by the spacecraft.  Numpy has a bulit-in function that can convert an integer into a binary bit mask.  Let's use that now one one of the common values we see in our displayed image above.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-23-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-23&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-23-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-23-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;understanding-the-aperture-pixel-values&quot;&gt;
        &lt;a href=&quot;#understanding-the-aperture-pixel-values&quot;&gt;
         Understanding The Aperture Pixel Values
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        We see the pixel values are integers, but what do they mean?  The pixels are bitmasks that encode information about each pixel.  You can find a summary of what the different values mean
        &lt;a href=&quot;https://outerspace.stsci.edu/display/TESS/2.0+-+Data+Product+Overview#id-2.0-DataProductOverview-Table:ApertureMaskImageFlags&quot;&gt;
         here
        &lt;/a&gt;
        .  For example, a pixel in the aperture that might have a value of 57 can be broken down into power of 2 like: 32+16+8+1 = 57.  Referencing the table of values, this means this particular pixel was in CCD Output A, was used to calculate the PRF centroid, was used to calculate the flux weighted centroid, and was collected by the spacecraft.  Numpy has a bulit-in function that can convert an integer into a binary bit mask.  Let's use that now one one of the common values we see in our displayed image above.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 24 cell-24-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;24&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-24-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 24&quot; href=&quot;#24&quot; id=&quot;24&quot;&gt;
        24
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-24-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-24-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-24&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-24-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-24-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-24&quot; name=&quot;cell-24&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-24-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-24-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-24-source-label nb-source-label&quot; form=&quot;cell-24&quot; id=&quot;cell-24-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;# Break down a pixel value of 267 (yellow pixels displayed above) into its constituent bits.
bits = np.binary_repr(267)
print(bits)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Break down a pixel value of 267 (yellow pixels displayed above) into its constituent bits.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bits&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;binary_repr&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;267&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bits&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-24-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-24&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-24-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-24-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-24-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 25 cell-25-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;25&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-25-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 25&quot; href=&quot;#25&quot; id=&quot;25&quot;&gt;
        25
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-25-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-25-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-25&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-25-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-25-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-25&quot; name=&quot;cell-25&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-25-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-25-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-25-source-label nb-source-label&quot; form=&quot;cell-25&quot; id=&quot;cell-25-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Binary bits start from the right and end at the left, so the bit farthest on the right is the Least Significant Bit (LSB, equal to 2^0 = 1), the second from the right is 2^1=2, the third from the right is 2^2=4, etc. This bit mask has bit values of 1 (2^0), 2 (2^1), 8 (2^3), and 256 (2^8) set. From our look-up table, these values mean the pixels have been: collected by the spacecraft (value = 1), used in the optimal photometric aperture (value = 2), used to calculate the flux-weighted centroid (value = 8), and are on CCD Output D (value = 256).&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Binary bits start from the right and end at the left, so the bit farthest on the right is the Least Significant Bit (LSB, equal to 2^0 = 1), the second from the right is 2^1=2, the third from the right is 2^2=4, etc. This bit mask has bit values of 1 (2^0), 2 (2^1), 8 (2^3), and 256 (2^8) set. From our look-up table, these values mean the pixels have been: collected by the spacecraft (value = 1), used in the optimal photometric aperture (value = 2), used to calculate the flux-weighted centroid (value = 8), and are on CCD Output D (value = 256).
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-25-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-25&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-25-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-25-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Binary bits start from the right and end at the left, so the bit farthest on the right is the Least Significant Bit (LSB, equal to 2^0 = 1), the second from the right is 2^1=2, the third from the right is 2^2=4, etc. This bit mask has bit values of 1 (2^0), 2 (2^1), 8 (2^3), and 256 (2^8) set. From our look-up table, these values mean the pixels have been: collected by the spacecraft (value = 1), used in the optimal photometric aperture (value = 2), used to calculate the flux-weighted centroid (value = 8), and are on CCD Output D (value = 256).
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 26 cell-26-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;26&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-26-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 26&quot; href=&quot;#26&quot; id=&quot;26&quot;&gt;
        26
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-26-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-26-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-26&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-26-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-26-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-26&quot; name=&quot;cell-26&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-26-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-26-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-26-source-label nb-source-label&quot; form=&quot;cell-26&quot; id=&quot;cell-26-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Marking All Pixels Used In The Photometric Aperture

Let's display the pixels in the aperture FITS extension again, but this time, let's only mark those that are used in the optimal photometric aperture (bit mask value of 2 set).  While it is possible to do this in fewer lines, we'll show more of the steps involved for clarity.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Marking All Pixels Used In The Photometric Aperture&lt;/span&gt;

Let's display the pixels in the aperture FITS extension again, but this time, let's only mark those that are used in the optimal photometric aperture (bit mask value of 2 set).  While it is possible to do this in fewer lines, we'll show more of the steps involved for clarity.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-26-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-26&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-26-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-26-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;marking-all-pixels-used-in-the-photometric-aperture&quot;&gt;
        &lt;a href=&quot;#marking-all-pixels-used-in-the-photometric-aperture&quot;&gt;
         Marking All Pixels Used In The Photometric Aperture
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Let's display the pixels in the aperture FITS extension again, but this time, let's only mark those that are used in the optimal photometric aperture (bit mask value of 2 set).  While it is possible to do this in fewer lines, we'll show more of the steps involved for clarity.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 27 cell-27-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;27&quot; data-loc=&quot;20&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-27-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 27&quot; href=&quot;#27&quot; id=&quot;27&quot;&gt;
        27
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-27-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-27-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-27&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-27-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-27-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-27&quot; name=&quot;cell-27&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-27-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-27-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-27-source-label nb-source-label&quot; form=&quot;cell-27&quot; id=&quot;cell-27-source&quot; name=&quot;source&quot; readonly rows=&quot;20&quot;&gt;# Create an array that will keep track of which pixels have a bitmask
# value of 2 set. To start, everything is set to 0 = not set.  We make it
# the same dimension as the aperture pixel table, for clarity.
bitmask2_set = np.zeros(aperture.shape)

# Identify which pixels have the bit mask value of 2 set.  We'll first
# loop over each row (i) in the 11x11 table, and then each column (j).
for i,row in enumerate(aperture):
    for j, pix in enumerate(row):

        # Get the bitmask as a string of zeros and ones.
        this_bitmask = np.binary_repr(pix)

        # Is the bitmask value of 2 set?  If so, the 2nd integer from the
        # right should be set to 1.  We'll use Python negative indexes to
        # access the second integer from the right.
        if this_bitmask[-2] == '1':

            # Then record this pixel as having a bitmask value of 2 set.
            bitmask2_set[i,j] = 1&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Create an array that will keep track of which pixels have a bitmask&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# value of 2 set. To start, everything is set to 0 = not set.  We make it&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# the same dimension as the aperture pixel table, for clarity.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bitmask2_set&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Identify which pixels have the bit mask value of 2 set.  We'll first&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# loop over each row (i) in the 11x11 table, and then each column (j).&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pix&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;

        &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Get the bitmask as a string of zeros and ones.&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;this_bitmask&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;binary_repr&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pix&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Is the bitmask value of 2 set?  If so, the 2nd integer from the&lt;/span&gt;
        &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# right should be set to 1.  We'll use Python negative indexes to&lt;/span&gt;
        &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# access the second integer from the right.&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;this_bitmask&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'1'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;

            &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Then record this pixel as having a bitmask value of 2 set.&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bitmask2_set&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-27-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-27&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-27-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-27-loc&quot; role=&quot;none&quot;&gt;
       20
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-27-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 28 cell-28-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;28&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-28-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 28&quot; href=&quot;#28&quot; id=&quot;28&quot;&gt;
        28
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-28-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-28-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-28&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-28-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-28-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-28&quot; name=&quot;cell-28&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-28-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-28-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-28-source-label nb-source-label&quot; form=&quot;cell-28&quot; id=&quot;cell-28-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Now we can display the aperture, but this time we will only display the bitmask2_set table we've created, where a zero means the bitmask value of 2 is NOT set (thus these pixels aren't used in the optimal photometric aperture) and a one means the bitmask value of 2 is set (and thus these pixels were used in the optimal photometric aperture).&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Now we can display the aperture, but this time we will only display the bitmask2_set table we've created, where a zero means the bitmask value of 2 is NOT set (thus these pixels aren't used in the optimal photometric aperture) and a one means the bitmask value of 2 is set (and thus these pixels were used in the optimal photometric aperture).
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-28-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-28&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-28-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-28-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Now we can display the aperture, but this time we will only display the bitmask2_set table we've created, where a zero means the bitmask value of 2 is NOT set (thus these pixels aren't used in the optimal photometric aperture) and a one means the bitmask value of 2 is set (and thus these pixels were used in the optimal photometric aperture).
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 29 cell-29-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;29&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-29-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 29&quot; href=&quot;#29&quot; id=&quot;29&quot;&gt;
        29
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-29-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-29-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-29&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-29-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-29-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-29&quot; name=&quot;cell-29&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-29-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-29-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-29-source-label nb-source-label&quot; form=&quot;cell-29&quot; id=&quot;cell-29-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;# Start figure and axis.
fig, ax = plt.subplots()

# Display, as an image, the 11x11 table that records the bitmask value of 2 being set.
cax = ax.imshow(bitmask2_set, cmap=plt.cm.YlGnBu_r, origin=&quot;lower&quot;)

# Add a color bar.
cbar = fig.colorbar(cax)

# Add a title to the plot.
fig.suptitle(&quot;WASP-126 b Aperture - Sector 1 - Pixels Used In Phot. Ap.&quot;)
plt.show()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Start figure and axis.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Display, as an image, the 11x11 table that records the bitmask value of 2 being set.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bitmask2_set&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;YlGnBu_r&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;lower&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Add a color bar.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cbar&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Add a title to the plot.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;suptitle&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;WASP-126 b Aperture - Sector 1 - Pixels Used In Phot. Ap.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-29-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-29&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-29-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-29-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-29-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 30 cell-30-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;30&quot; data-loc=&quot;5&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-30-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 30&quot; href=&quot;#30&quot; id=&quot;30&quot;&gt;
        30
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-30-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-30-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-30&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-30-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-30-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-30&quot; name=&quot;cell-30&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-30-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-30-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-30-source-label nb-source-label&quot; form=&quot;cell-30&quot; id=&quot;cell-30-source&quot; name=&quot;source&quot; readonly rows=&quot;5&quot;&gt;## About this Notebook

**Author:** Scott W. Fleming, STScI Archive Scientist

**Updated On:** 2018-11-21&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## About this Notebook&lt;/span&gt;

&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Author:**&lt;/span&gt; Scott W. Fleming, STScI Archive Scientist

&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Updated On:**&lt;/span&gt; 2018-11-21
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-30-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-30&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-30-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-30-loc&quot; role=&quot;none&quot;&gt;
       5
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;about-this-notebook&quot;&gt;
        &lt;a href=&quot;#about-this-notebook&quot;&gt;
         About this Notebook
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Author:
        &lt;/strong&gt;
        Scott W. Fleming, STScI Archive Scientist
       &lt;/p&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Updated On:
        &lt;/strong&gt;
        2018-11-21
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 31 cell-31-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;31&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-31-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 31&quot; href=&quot;#31&quot; id=&quot;31&quot;&gt;
        31
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-31-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-31-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-31&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-31-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-31-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-31&quot; name=&quot;cell-31&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-31-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-31-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-31-source-label nb-source-label&quot; form=&quot;cell-31&quot; id=&quot;cell-31-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;[Top of Page](#title_ID)
&amp;lt;img alt=&quot;STScI logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;/&amp;gt; &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Top of Page&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#title_ID&lt;/span&gt;)
&amp;lt;img style=&quot;float: right;&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; alt=&quot;STScI logo&quot; width=&quot;200px&quot;/&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-31-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-31&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-31-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-31-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a href=&quot;#title_ID&quot;&gt;
         Top of Page
        &lt;/a&gt;
        &lt;img alt=&quot;STScI logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;table class=&quot;nb-cells-footer&quot; hidden&gt;
    &lt;tbody&gt;
     &lt;tr class=&quot;total&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       all cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       31
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       100
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;code&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       code cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       31
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       100
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;markdown&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       markdown cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       31
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       100
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;dialog id=&quot;nb-metadata&quot;&gt;
    &lt;form method=&quot;dialog&quot;&gt;
     &lt;button formmethod=&quot;dialog&quot;&gt;
      Close
     &lt;/button&gt;
     {&quot;kernelspec&quot;: {&quot;display_name&quot;: &quot;Python 3 (ipykernel)&quot;, &quot;language&quot;: &quot;python&quot;, &quot;name&quot;: &quot;python3&quot;}, &quot;language_info&quot;: {&quot;codemirror_mode&quot;: {&quot;name&quot;: &quot;ipython&quot;, &quot;version&quot;: 3}, &quot;file_extension&quot;: &quot;.py&quot;, &quot;mimetype&quot;: &quot;text/x-python&quot;, &quot;name&quot;: &quot;python&quot;, &quot;nbconvert_exporter&quot;: &quot;python&quot;, &quot;pygments_lexer&quot;: &quot;ipython3&quot;, &quot;version&quot;: &quot;3.8.16&quot;}}
    &lt;/form&gt;
   &lt;/dialog&gt;
   &lt;form aria-labelledby=&quot;nb-notebook-label&quot; id=&quot;notebook&quot; name=&quot;notebook&quot;&gt;
    &lt;label&gt;
     &lt;input id=&quot;nb-edit-mode&quot; name=&quot;edit&quot; type=&quot;checkbox&quot;&gt;
     edit mode
    &lt;/label&gt;
    &lt;button aria-controls=&quot;nb-metadata&quot; onclick=&quot;openDialog()&quot;&gt;
     metadata
    &lt;/button&gt;
    &lt;button type=&quot;submit&quot;&gt;
     Run
    &lt;/button&gt;
   &lt;/form&gt;
  &lt;/main&gt;
  &lt;section id=&quot;nb-dialogs&quot;&gt;
   &lt;details&gt;
    &lt;summary onclick=&quot;openDialogs()&quot;&gt;
     settings, help, &amp;amp; diagnostics
    &lt;/summary&gt;
   &lt;/details&gt;
  &lt;/section&gt;
  &lt;footer&gt;
   &lt;details class=&quot;log&quot;&gt;
    &lt;summary&gt;
     &lt;span&gt;
      activity log
     &lt;/span&gt;
    &lt;/summary&gt;
   &lt;/details&gt;
   &lt;table aria-live=&quot;polite&quot;&gt;
    &lt;tbody&gt;
     &lt;tr&gt;
      &lt;th hidden&gt;
       time
      &lt;/th&gt;
      &lt;td&gt;
       message
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;a accesskey=&quot;0&quot; href=&quot;#TOP&quot;&gt;
    skip to top
   &lt;/a&gt;
  &lt;/footer&gt;
 &lt;/body&gt;
&lt;/html&gt;
" width="100%"></iframe></div>
<div class="output_html rendered_html output_subarea"><iframe height="600" srcdoc="&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
 &lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; name=&quot;viewport&quot;&gt;
  &lt;title&gt;
   Notebook
  &lt;/title&gt;
  &lt;meta content=&quot;light&quot; name=&quot;color-scheme&quot;&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js&quot;&gt;
  &lt;/script&gt;
  &lt;style type=&quot;text/css&quot;&gt;
   /* # accessible css configurations

we define these high level variables to allow for configuration during use and testing.
we are not sure what the preferred default values are for these any accessible notebooks features.
the variables specify critical degrees of freedom in the notebook style.

## notebook interface specific css variables

*/

:root {
    --nb-focus-width: 3px;
    --nb-accent-color: auto;
    --nb-background-color-dark: #2b2a33;
    --nb-background-color-light: #FFFFFF;
    --nb-margin: 5%;
    --nb-font-size: 16px;
    --nb-font-family: serif;
    --nb-line-height: 1.5;
}

/* map css variables to css properties on the `body` elements.
this mapping turns out css variables into user interfaces. */

body {
    font-size: var(--nb-font-size);
    font-family: var(--nb-font-family);
    accent-color: var(--nb-accent-color);
    margin-left: var(--nb-margin);
    margin-right: var(--nb-margin);
    line-height: var(--nb-line-height);
    width: calc(100% - 2*var(--nb-margin));
}

/* ## notebook settings

the notebook settings interface connects configurable css features to the user.
we use dialog elements to represents an element that should be hidden by default.
it turns out there are two ways to layout `dialog` elements. 
they can be used as modals or block elements.
we extract this dual purpose to provide both configurations to the user.

*/

dialog form&gt;* {
    display: block;
}

#nb-dialogs details[open]~dialog {
    position: relative;
}


/* ## wcag accessibility guidelines as a feature

flexibility is the future of assistive interfaces.
it is not in the purvey of privileged developers and inaccessible systems to decide what priority accessibility is.
it is the fucking priority.

in this implementation, we want to satisfy broad user needs by making a lot of features configurable.
one configurable feature is the accessibility priority. 
experienced developers may need less assistive features as they spend more time with an interface.

### buttons sizes

WCAG 2.1 defines a huge stinking AAA hit size for buttons. its beautiful.

/* satisfy AAA 2.5.5 */

.wcag-aaa button,
.wcag-aaa input[type=checkbox] {
    min-height: 44px;
    min-width: 44px;
}

.wcag-aaa a {
    font-size: max(44px, var(--nb-font-size));
}


/* WCAG 2.2 clarified a AA button size that is used to style checkboxes and buttons. */
/* satisfy AA 2.5.8 minimum target requirement */
.wcag-aa button,
.wcag-aa input[type=checkbox] {
    min-height: 24px;
    min-width: 24px;
}

.wcag-aa a {
    font-size: max(24px, var(--nb-font-size));
}

/* ### native textareas for AAA priority.

our AAA priority choices often ensure that third party libraries can not compromise the accessibility of notebook.
the design decisions are focused native elements so that the assistive technology users have consistent expectations and outcomes.

*/

.wcag-a textarea[name=source],
.wcag-aa textarea[name=source],
.wcag-aaa textarea[name=source]~* {
    display: none;
}


/* ## notebook components layout */

td[role=&quot;none&quot;]:not([hidden]) {
    display: unset;
}

#cells tr.cell,
#cells tbody {
    display: flex;
    flex-direction: column;
}

[reversed]#cells tbody {
    flex-direction: column-reverse;
}

/* hide the visual output area when there are no outputs. 
assistive technologies will recieve an audible notification that there are not outputs. */

fieldset[data-outputs=&quot;0&quot;] {
    display: none;
}

/* ## modifications to html defaults 

### focus 

there nothing to be said about this topic that [sara soueidan](https://www.sarasoueidan.com/blog/focus-indicators/) hasn't said.
we start with her [universal focus recommendation](https://www.sarasoueidan.com/blog/focus-indicators/#a-%E2%80%98universal%E2%80%99-focus-indicator).

*/



.cell:focus-within,
:focus-visible {
    outline: max(var(--nb-focus-width), 1px) solid;
    box-shadow: 0 0 0 calc(2 * max(var(--nb-focus-width), 1px));
}


/* on firefox, the input and output become interactive when there is overflow. chrome fixed this recently find reference.*/
textarea[name=source],
.cell&gt;td&gt;details {
    overflow: auto;
    min-width: 0;
}

#nb-settings li::marker,
summary[inert]::marker {
    content: &quot;&quot;;
}

/* ### inheriting styles */

input,
select,
button {
    font-family: inherit;
    font-size: inherit;
}

textarea {
    font-family: monospace;
    font-size: inherit;
    line-height: inherit;
    overflow: auto;
    color: unset;
}

textarea[name=source] {
    box-sizing: border-box;
    width: 100%;
    resize: vertical;
}


/* align checkboxes with buttons */
input[type=&quot;checkbox&quot;] {
    vertical-align: middle;
}

/* ## custom class selectors */

#nb-dialogs details:not([open])~dialog:not([open]):not(:focus-within):not(:active),
/* legend:not(:focus-within):not(:active), */
details.log:not([open])+table,
.visually-hidden:not(:focus-within):not(:active) {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 1px;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}
  &lt;/style&gt;
  &lt;style id=&quot;nb-light-theme&quot; media=&quot;screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-light-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #0969da4a }
.c { color: #66707b } /* Comment */
.err { color: #a0111f } /* Error */
.k { color: #a0111f } /* Keyword */
.l { color: #702c00 } /* Literal */
.n { color: #622cbc } /* Name */
.o { color: #024c1a } /* Operator */
.p { color: #24292f } /* Punctuation */
.ch { color: #66707b } /* Comment.Hashbang */
.cm { color: #66707b } /* Comment.Multiline */
.cp { color: #66707b } /* Comment.Preproc */
.cpf { color: #66707b } /* Comment.PreprocFile */
.c1 { color: #66707b } /* Comment.Single */
.cs { color: #66707b } /* Comment.Special */
.gd { color: #023b95 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #a0111f } /* Generic.Error */
.gh { color: #023b95 } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #023b95 } /* Generic.Subheading */
.kc { color: #023b95 } /* Keyword.Constant */
.kd { color: #a0111f } /* Keyword.Declaration */
.kn { color: #a0111f } /* Keyword.Namespace */
.kp { color: #a0111f } /* Keyword.Pseudo */
.kr { color: #a0111f } /* Keyword.Reserved */
.kt { color: #a0111f } /* Keyword.Type */
.ld { color: #702c00 } /* Literal.Date */
.m { color: #702c00 } /* Literal.Number */
.s { color: #023b95 } /* Literal.String */
.na { color: #702c00 } /* Name.Attribute */
.nb { color: #702c00 } /* Name.Builtin */
.nc { color: #023b95 } /* Name.Class */
.no { color: #023b95 } /* Name.Constant */
.nd { color: #702c00 } /* Name.Decorator */
.ni { color: #024c1a } /* Name.Entity */
.ne { color: #622cbc } /* Name.Exception */
.nf { color: #023b95 } /* Name.Function */
.nl { color: #702c00 } /* Name.Label */
.nn { color: #24292f } /* Name.Namespace */
.nx { color: #622cbc } /* Name.Other */
.py { color: #023b95 } /* Name.Property */
.nt { color: #024c1a } /* Name.Tag */
.nv { color: #702c00 } /* Name.Variable */
.ow { color: #622cbc } /* Operator.Word */
.pm { color: #24292f } /* Punctuation.Marker */
.w { color: #24292f } /* Text.Whitespace */
.mb { color: #702c00 } /* Literal.Number.Bin */
.mf { color: #702c00 } /* Literal.Number.Float */
.mh { color: #702c00 } /* Literal.Number.Hex */
.mi { color: #702c00 } /* Literal.Number.Integer */
.mo { color: #702c00 } /* Literal.Number.Oct */
.sa { color: #023b95 } /* Literal.String.Affix */
.sb { color: #023b95 } /* Literal.String.Backtick */
.sc { color: #023b95 } /* Literal.String.Char */
.dl { color: #023b95 } /* Literal.String.Delimiter */
.sd { color: #023b95 } /* Literal.String.Doc */
.s2 { color: #023b95 } /* Literal.String.Double */
.se { color: #023b95 } /* Literal.String.Escape */
.sh { color: #023b95 } /* Literal.String.Heredoc */
.si { color: #023b95 } /* Literal.String.Interpol */
.sx { color: #023b95 } /* Literal.String.Other */
.sr { color: #023b95 } /* Literal.String.Regex */
.s1 { color: #023b95 } /* Literal.String.Single */
.ss { color: #023b95 } /* Literal.String.Symbol */
.bp { color: #702c00 } /* Name.Builtin.Pseudo */
.fm { color: #023b95 } /* Name.Function.Magic */
.vc { color: #702c00 } /* Name.Variable.Class */
.vg { color: #702c00 } /* Name.Variable.Global */
.vi { color: #702c00 } /* Name.Variable.Instance */
.vm { color: #702c00 } /* Name.Variable.Magic */
.il { color: #702c00 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;style id=&quot;nb-dark-theme&quot; media=&quot;not  screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-dark-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #58a6ff70 }
.c { color: #d9dee3 } /* Comment */
.err { color: #ff9492 } /* Error */
.k { color: #ff9492 } /* Keyword */
.l { color: #ffb757 } /* Literal */
.n { color: #dbb7ff } /* Name */
.o { color: #72f088 } /* Operator */
.p { color: #C9D1D9 } /* Punctuation */
.ch { color: #d9dee3 } /* Comment.Hashbang */
.cm { color: #d9dee3 } /* Comment.Multiline */
.cp { color: #d9dee3 } /* Comment.Preproc */
.cpf { color: #d9dee3 } /* Comment.PreprocFile */
.c1 { color: #d9dee3 } /* Comment.Single */
.cs { color: #d9dee3 } /* Comment.Special */
.gd { color: #91cbff } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #ff9492 } /* Generic.Error */
.gh { color: #91cbff } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #91cbff } /* Generic.Subheading */
.kc { color: #91cbff } /* Keyword.Constant */
.kd { color: #ff9492 } /* Keyword.Declaration */
.kn { color: #ff9492 } /* Keyword.Namespace */
.kp { color: #ff9492 } /* Keyword.Pseudo */
.kr { color: #ff9492 } /* Keyword.Reserved */
.kt { color: #ff9492 } /* Keyword.Type */
.ld { color: #ffb757 } /* Literal.Date */
.m { color: #ffb757 } /* Literal.Number */
.s { color: #91cbff } /* Literal.String */
.na { color: #ffb757 } /* Name.Attribute */
.nb { color: #ffb757 } /* Name.Builtin */
.nc { color: #91cbff } /* Name.Class */
.no { color: #91cbff } /* Name.Constant */
.nd { color: #ffb757 } /* Name.Decorator */
.ni { color: #72f088 } /* Name.Entity */
.ne { color: #dbb7ff } /* Name.Exception */
.nf { color: #91cbff } /* Name.Function */
.nl { color: #ffb757 } /* Name.Label */
.nn { color: #C9D1D9 } /* Name.Namespace */
.nx { color: #dbb7ff } /* Name.Other */
.py { color: #91cbff } /* Name.Property */
.nt { color: #72f088 } /* Name.Tag */
.nv { color: #ffb757 } /* Name.Variable */
.ow { color: #dbb7ff } /* Operator.Word */
.pm { color: #C9D1D9 } /* Punctuation.Marker */
.w { color: #C9D1D9 } /* Text.Whitespace */
.mb { color: #ffb757 } /* Literal.Number.Bin */
.mf { color: #ffb757 } /* Literal.Number.Float */
.mh { color: #ffb757 } /* Literal.Number.Hex */
.mi { color: #ffb757 } /* Literal.Number.Integer */
.mo { color: #ffb757 } /* Literal.Number.Oct */
.sa { color: #91cbff } /* Literal.String.Affix */
.sb { color: #91cbff } /* Literal.String.Backtick */
.sc { color: #91cbff } /* Literal.String.Char */
.dl { color: #91cbff } /* Literal.String.Delimiter */
.sd { color: #91cbff } /* Literal.String.Doc */
.s2 { color: #91cbff } /* Literal.String.Double */
.se { color: #91cbff } /* Literal.String.Escape */
.sh { color: #91cbff } /* Literal.String.Heredoc */
.si { color: #91cbff } /* Literal.String.Interpol */
.sx { color: #91cbff } /* Literal.String.Other */
.sr { color: #91cbff } /* Literal.String.Regex */
.s1 { color: #91cbff } /* Literal.String.Single */
.ss { color: #91cbff } /* Literal.String.Symbol */
.bp { color: #ffb757 } /* Name.Builtin.Pseudo */
.fm { color: #91cbff } /* Name.Function.Magic */
.vc { color: #ffb757 } /* Name.Variable.Class */
.vg { color: #ffb757 } /* Name.Variable.Global */
.vi { color: #ffb757 } /* Name.Variable.Instance */
.vm { color: #ffb757 } /* Name.Variable.Magic */
.il { color: #ffb757 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;!-- Load mathjax --&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe&quot;&gt;
  &lt;/script&gt;
  &lt;!-- MathJax configuration --&gt;
  &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
   init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: &quot;AMS&quot;,
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], [&quot;\\(&quot;,&quot;\\)&quot;] ],
                    displayMath: [ ['$$','$$'], [&quot;\\[&quot;,&quot;\\]&quot;] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue([&quot;Typeset&quot;, MathJax.Hub]);
        }
    }
    init_mathjax();
  &lt;/script&gt;
  &lt;!-- End of mathjax configuration --&gt;
  &lt;script type=&quot;module&quot;&gt;
   document.addEventListener(&quot;DOMContentLoaded&quot;, async () =&gt; {
    const diagrams = document.querySelectorAll(&quot;.jp-Mermaid &gt; pre.mermaid&quot;);
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import(&quot;https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.5.0/mermaid.esm.min.mjs&quot;)).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue(&quot;--jp-ui-font-family&quot;),
      theme: document.querySelector(&quot;body[data-jp-theme-light='true']&quot;)
        ? &quot;default&quot;
        : &quot;dark&quot;,
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement(&quot;img&quot;);
      const doc = parser.parseFromString(svg, &quot;image/svg+xml&quot;);
      const svgEl = doc.querySelector(&quot;svg&quot;);
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector(&quot;title&quot;);
      const firstDesc = doc.querySelector(&quot;desc&quot;);

      img.setAttribute(&quot;src&quot;, `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute(&quot;alt&quot;, firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement(&quot;figcaption&quot;);
        caption.className = &quot;sr-only&quot;;
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = &quot;&quot;;
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement(&quot;details&quot;);
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement(&quot;summary&quot;);
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement(&quot;pre&quot;);
      const code = document.createElement(&quot;code&quot;);
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement(&quot;pre&quot;);
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement(&quot;div&quot;);
      el.style.visibility = &quot;hidden&quot;;
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        const { svg } = await mermaid.render(id, raw, el);
        results = makeMermaidImage(svg);
        output = document.createElement(&quot;figure&quot;);
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add(&quot;jp-mod-warning&quot;);
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add(&quot;jp-RenderedMermaid&quot;);
      parent.appendChild(output);
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
  &lt;/script&gt;
  &lt;style&gt;
   .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details &gt; pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary &gt; pre {
    display: inline-block;
    white-space: normal;
  }
  &lt;/style&gt;
  &lt;!-- End of mermaid configuration --&gt;
 &lt;/head&gt;
 &lt;body class=&quot;wcag-aa&quot;&gt;
  &lt;header aria-label=&quot;site header&quot;&gt;
   &lt;a href=&quot;#1&quot; id=&quot;TOP&quot;&gt;
    skip to main content
   &lt;/a&gt;
  &lt;/header&gt;
  &lt;main aria-labelledby=&quot;nb-notebook-label&quot;&gt;
   &lt;section aria-labelledby=&quot;nb-toc&quot;&gt;
    &lt;details open&gt;
     &lt;summary id=&quot;toc&quot;&gt;
      &lt;span id=&quot;nb-toc&quot;&gt;
       table of contents
      &lt;/span&gt;
     &lt;/summary&gt;
     &lt;a id=&quot;nb-toc-start&quot;&gt;
     &lt;/a&gt;
     &lt;ol aria-labelledby=&quot;nb-toc&quot;&gt;
     &lt;/ol&gt;
     &lt;ol&gt;
      &lt;li&gt;
       &lt;a href=&quot;#removing-scattered-light-from-tess-data-using-the-lightkurve-regressioncorrector&quot;&gt;
        None
       &lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;
         &lt;a href=&quot;#learning-goals&quot;&gt;
          Learning Goals
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#introduction&quot;&gt;
          Introduction
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#imports&quot;&gt;
          Imports
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#1-using-regressioncorrector-on-tesscut-ffi-cutouts&quot;&gt;
          None
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#2-creating-a-designmatrix-from-pixel-regressors&quot;&gt;
          None
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#3-removing-background-scattered-light-using-linear-regression&quot;&gt;
          3. Removing Background Scattered Light Using Linear Regression
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#4-diagnosing-the-correction&quot;&gt;
          4. Diagnosing the Correction
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#5-using-regressioncorrector-on-tess-two-minute-cadence-target-pixel-files&quot;&gt;
          None
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#6-should-i-use-regressioncorrector-or-pldcorrector&quot;&gt;
          None
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#about-this-notebook&quot;&gt;
          About this Notebook
         &lt;/a&gt;
        &lt;/li&gt;
       &lt;/ol&gt;
      &lt;/li&gt;
      &lt;li&gt;
       &lt;a href=&quot;#citing-lightkurve-and-its-dependencies&quot;&gt;
        Citing Lightkurve and its Dependencies
       &lt;/a&gt;
      &lt;/li&gt;
     &lt;/ol&gt;
    &lt;/details&gt;
   &lt;/section&gt;
   &lt;table id=&quot;cells&quot; role=&quot;presentation&quot;&gt;
    &lt;tbody aria-labelledby=&quot;nb-notebook-label nb-cells-label&quot; role=&quot;list&quot;&gt;
     &lt;tr hidden&gt;
      &lt;th scope=&quot;col&quot;&gt;
       index
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       execution_count
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       cell_type
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       toolbar
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       started_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       completed_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       source
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       loc
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       metadata
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       outputs
      &lt;/th&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 1 cell-1-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;1&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;1&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-1-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 1&quot; href=&quot;#1&quot; id=&quot;1&quot;&gt;
        1
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-1-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-1-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-1&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-1-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-1-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-1&quot; name=&quot;cell-1&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-1-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-1-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-1-source-label nb-source-label&quot; form=&quot;cell-1&quot; id=&quot;cell-1-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;# Removing Scattered Light from *TESS* Data Using the Lightkurve `RegressionCorrector`&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gh&quot; title=&quot;Generic.Heading&quot;&gt;# Removing Scattered Light from *TESS* Data Using the Lightkurve `RegressionCorrector`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-1-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-1&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-1-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'bYYGJvqP-Csl'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-1-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h1 id=&quot;removing-scattered-light-from-tess-data-using-the-lightkurve-regressioncorrector&quot;&gt;
        &lt;a href=&quot;#removing-scattered-light-from-tess-data-using-the-lightkurve-regressioncorrector&quot;&gt;
         None
        &lt;/a&gt;
       &lt;/h1&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 2 cell-2-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;2&quot; data-loc=&quot;7&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;2&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-2-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 2&quot; href=&quot;#2&quot; id=&quot;2&quot;&gt;
        2
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-2-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-2-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-2&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-2-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-2-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-2&quot; name=&quot;cell-2&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-2-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-2-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-2-source-label nb-source-label&quot; form=&quot;cell-2&quot; id=&quot;cell-2-source&quot; name=&quot;source&quot; readonly rows=&quot;7&quot;&gt;---
## Learning Goals

By the end of this tutorial, you will:
 - Be familiar with the Lightkurve `RegressionCorrector`.
 - Understand how to create regressors from a `TargetPixelFile` object.
 - Be able to remove the scattered light background signal from *TESS* data.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;---
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Learning Goals&lt;/span&gt;

By the end of this tutorial, you will:
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Be familiar with the Lightkurve &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt;.
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Understand how to create regressors from a &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`TargetPixelFile`&lt;/span&gt; object.
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Be able to remove the scattered light background signal from &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; data.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-2-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-2&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-2-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'gOFEJAKe-vjA'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-2-loc&quot; role=&quot;none&quot;&gt;
       7
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
       &lt;h2 id=&quot;learning-goals&quot;&gt;
        &lt;a href=&quot;#learning-goals&quot;&gt;
         Learning Goals
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        By the end of this tutorial, you will:
       &lt;/p&gt;
       &lt;ul&gt;
        &lt;li&gt;
         Be familiar with the Lightkurve
         &lt;code&gt;
          RegressionCorrector
         &lt;/code&gt;
         .
        &lt;/li&gt;
        &lt;li&gt;
         Understand how to create regressors from a
         &lt;code&gt;
          TargetPixelFile
         &lt;/code&gt;
         object.
        &lt;/li&gt;
        &lt;li&gt;
         Be able to remove the scattered light background signal from
         &lt;em&gt;
          TESS
         &lt;/em&gt;
         data.
        &lt;/li&gt;
       &lt;/ul&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 3 cell-3-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;3&quot; data-loc=&quot;5&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;3&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-3-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 3&quot; href=&quot;#3&quot; id=&quot;3&quot;&gt;
        3
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-3-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-3-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-3&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-3-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-3-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-3&quot; name=&quot;cell-3&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-3-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-3-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-3-source-label nb-source-label&quot; form=&quot;cell-3&quot; id=&quot;cell-3-source&quot; name=&quot;source&quot; readonly rows=&quot;5&quot;&gt;## Introduction

Lightkurve offers several tools to the community for removing instrument noise and systematics from data from the *Kepler*, *K2*, and *TESS* missions. This tutorial will demonstrate the use of Lightkurve's `RegressionCorrector` class to remove the scattered light and spacecraft motion noise from *TESS* Full Frame Images (FFIs).

*TESS* FFIs have an additive scattered light background that has not been removed by the pipeline. This scattered light must be removed by the user. This can be done in a few ways, including a basic median subtraction. In this tutorial, we'll show you how to use Lightkurve's corrector tools to remove the scattered light. &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Introduction&lt;/span&gt;

Lightkurve offers several tools to the community for removing instrument noise and systematics from data from the &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*Kepler*&lt;/span&gt;, &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*K2*&lt;/span&gt;, and &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; missions. This tutorial will demonstrate the use of Lightkurve's &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; class to remove the scattered light and spacecraft motion noise from &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; Full Frame Images (FFIs).

&lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; FFIs have an additive scattered light background that has not been removed by the pipeline. This scattered light must be removed by the user. This can be done in a few ways, including a basic median subtraction. In this tutorial, we'll show you how to use Lightkurve's corrector tools to remove the scattered light. 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-3-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-3&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-3-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': '7NGNkiQB-sKQ'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-3-loc&quot; role=&quot;none&quot;&gt;
       5
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;introduction&quot;&gt;
        &lt;a href=&quot;#introduction&quot;&gt;
         Introduction
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Lightkurve offers several tools to the community for removing instrument noise and systematics from data from the
        &lt;em&gt;
         Kepler
        &lt;/em&gt;
        ,
        &lt;em&gt;
         K2
        &lt;/em&gt;
        , and
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        missions. This tutorial will demonstrate the use of Lightkurve's
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        class to remove the scattered light and spacecraft motion noise from
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        Full Frame Images (FFIs).
       &lt;/p&gt;
       &lt;p&gt;
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        FFIs have an additive scattered light background that has not been removed by the pipeline. This scattered light must be removed by the user. This can be done in a few ways, including a basic median subtraction. In this tutorial, we'll show you how to use Lightkurve's corrector tools to remove the scattered light.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 4 cell-4-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;4&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;4&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-4-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 4&quot; href=&quot;#4&quot; id=&quot;4&quot;&gt;
        4
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-4-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-4-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-4&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-4-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-4-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-4&quot; name=&quot;cell-4&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-4-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-4-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-4-source-label nb-source-label&quot; form=&quot;cell-4&quot; id=&quot;cell-4-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Imports

This tutorial requires the [**Lightkurve**](http://docs.lightkurve.org/) package, and also makes use of **[NumPy](https://numpy.org/)** and **[Matplotlib](https://matplotlib.org/)**.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Imports&lt;/span&gt;

This tutorial requires the [&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Lightkurve**&lt;/span&gt;](http://docs.lightkurve.org/) package, and also makes use of &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**[NumPy](https://numpy.org/)**&lt;/span&gt; and &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**[Matplotlib](https://matplotlib.org/)**&lt;/span&gt;.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-4-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-4&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-4-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'EAzRgQPpAcBR'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-4-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;imports&quot;&gt;
        &lt;a href=&quot;#imports&quot;&gt;
         Imports
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        This tutorial requires the
        &lt;a href=&quot;http://docs.lightkurve.org/&quot;&gt;
         &lt;strong&gt;
          Lightkurve
         &lt;/strong&gt;
        &lt;/a&gt;
        package, and also makes use of
        &lt;strong&gt;
         &lt;a href=&quot;https://numpy.org/&quot;&gt;
          NumPy
         &lt;/a&gt;
        &lt;/strong&gt;
        and
        &lt;strong&gt;
         &lt;a href=&quot;https://matplotlib.org/&quot;&gt;
          Matplotlib
         &lt;/a&gt;
        &lt;/strong&gt;
        .
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 5 cell-5-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;5&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;5&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-5-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 5&quot; href=&quot;#5&quot; id=&quot;5&quot;&gt;
        5
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-5-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-5-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-5&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-5-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-5-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-5&quot; name=&quot;cell-5&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-5-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-5-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-5-source-label nb-source-label&quot; form=&quot;cell-5&quot; id=&quot;cell-5-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;import lightkurve as lk
import numpy as np
import matplotlib.pyplot as plt
%matplotlib inline&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;lightkurve&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;lk&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;inline&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-5-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-5&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-5-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-5-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-5-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 6 cell-6-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;6&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;6&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-6-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 6&quot; href=&quot;#6&quot; id=&quot;6&quot;&gt;
        6
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-6-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-6-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-6&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-6-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-6-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-6&quot; name=&quot;cell-6&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-6-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-6-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-6-source-label nb-source-label&quot; form=&quot;cell-6&quot; id=&quot;cell-6-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;---&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;---
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-6-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-6&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-6-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'a53oRxa12SI7'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-6-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 7 cell-7-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;7&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;7&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-7-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 7&quot; href=&quot;#7&quot; id=&quot;7&quot;&gt;
        7
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-7-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-7-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-7&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-7-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-7-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-7&quot; name=&quot;cell-7&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-7-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-7-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-7-source-label nb-source-label&quot; form=&quot;cell-7&quot; id=&quot;cell-7-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;## 1. Using `RegressionCorrector` on TESSCut FFI Cutouts

For this tutorial we will use the *TESS* Sector 15 data of [KIC 8462852](https://en.wikipedia.org/wiki/Tabby%27s_Star) (also known as Boyajian's Star).
We'll start by downloading the FFI data using MAST's TESSCut service, querying it through Lightkurve.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## 1. Using `RegressionCorrector` on TESSCut FFI Cutouts&lt;/span&gt;

For this tutorial we will use the &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; Sector 15 data of [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;KIC 8462852&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://en.wikipedia.org/wiki/Tabby%27s_Star&lt;/span&gt;) (also known as Boyajian's Star).
We'll start by downloading the FFI data using MAST's TESSCut service, querying it through Lightkurve.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-7-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-7&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-7-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'c03Y0DPv-Csl'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-7-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;1-using-regressioncorrector-on-tesscut-ffi-cutouts&quot;&gt;
        &lt;a href=&quot;#1-using-regressioncorrector-on-tesscut-ffi-cutouts&quot;&gt;
         None
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        For this tutorial we will use the
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        Sector 15 data of
        &lt;a href=&quot;https://en.wikipedia.org/wiki/Tabby%27s_Star&quot;&gt;
         KIC 8462852
        &lt;/a&gt;
        (also known as Boyajian's Star).
We'll start by downloading the FFI data using MAST's TESSCut service, querying it through Lightkurve.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 8 cell-8-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;8&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;8&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-8-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 8&quot; href=&quot;#8&quot; id=&quot;8&quot;&gt;
        8
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-8-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-8-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-8&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-8-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-8-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-8&quot; name=&quot;cell-8&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-8-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-8-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-8-source-label nb-source-label&quot; form=&quot;cell-8&quot; id=&quot;cell-8-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;target = 'KIC 8462852'  # Boyajian's Star
tpf = lk.search_tesscut(target, sector=15).download(cutout_size=(50, 50))&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'KIC 8462852'&lt;/span&gt;  &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Boyajian's Star&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;search_tesscut&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;download&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cutout_size&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-8-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-8&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-8-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-8-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-8-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 9 cell-9-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;9&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;9&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-9-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 9&quot; href=&quot;#9&quot; id=&quot;9&quot;&gt;
        9
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-9-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-9-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-9&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-9-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-9-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-9&quot; name=&quot;cell-9&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-9-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-9-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-9-source-label nb-source-label&quot; form=&quot;cell-9&quot; id=&quot;cell-9-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;tpf&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-9-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-9&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-9-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-9-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-9-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 10 cell-10-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;10&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-10-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 10&quot; href=&quot;#10&quot; id=&quot;10&quot;&gt;
        10
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-10-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-10-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-10&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-10-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-10-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-10&quot; name=&quot;cell-10&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-10-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-10-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-10-source-label nb-source-label&quot; form=&quot;cell-10&quot; id=&quot;cell-10-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;This cutout works the same as any Lightkurve target pixel file (TPF). *TESS* FFI cutouts do not have aperture masks created by the pipeline. Instead, users must create their own apertures. There are many methods we could use to do this, but for now we can create a threshold aperture, using Lightkurve's `create_threshold_mask()` method.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;This cutout works the same as any Lightkurve target pixel file (TPF). &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; FFI cutouts do not have aperture masks created by the pipeline. Instead, users must create their own apertures. There are many methods we could use to do this, but for now we can create a threshold aperture, using Lightkurve's &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`create_threshold_mask()`&lt;/span&gt; method.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-10-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-10&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-10-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'DU3iTJ03-Csu'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-10-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        This cutout works the same as any Lightkurve target pixel file (TPF).
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        FFI cutouts do not have aperture masks created by the pipeline. Instead, users must create their own apertures. There are many methods we could use to do this, but for now we can create a threshold aperture, using Lightkurve's
        &lt;code&gt;
         create_threshold_mask()
        &lt;/code&gt;
        method.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 11 cell-11-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;11&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-11-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 11&quot; href=&quot;#11&quot; id=&quot;11&quot;&gt;
        11
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-11-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-11-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-11&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-11-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-11-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-11&quot; name=&quot;cell-11&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-11-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-11-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-11-source-label nb-source-label&quot; form=&quot;cell-11&quot; id=&quot;cell-11-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;aper = tpf.create_threshold_mask()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;create_threshold_mask&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-11-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-11&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-11-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-11-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-11-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 12 cell-12-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;12&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-12-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 12&quot; href=&quot;#12&quot; id=&quot;12&quot;&gt;
        12
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-12-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-12-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-12&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-12-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-12-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-12&quot; name=&quot;cell-12&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-12-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-12-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-12-source-label nb-source-label&quot; form=&quot;cell-12&quot; id=&quot;cell-12-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Let's plot the aperture to make sure it selected the star in the center and has a reasonable number of pixels.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Let's plot the aperture to make sure it selected the star in the center and has a reasonable number of pixels.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-12-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-12&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-12-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': '6fzg_SI2-Csw'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-12-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Let's plot the aperture to make sure it selected the star in the center and has a reasonable number of pixels.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 13 cell-13-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;13&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-13-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 13&quot; href=&quot;#13&quot; id=&quot;13&quot;&gt;
        13
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-13-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-13-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-13&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-13-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-13-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-13&quot; name=&quot;cell-13&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-13-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-13-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-13-source-label nb-source-label&quot; form=&quot;cell-13&quot; id=&quot;cell-13-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;tpf.plot(aperture_mask=aper);&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture_mask&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-13-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-13&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-13-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-13-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-13-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 14 cell-14-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;14&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-14-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 14&quot; href=&quot;#14&quot; id=&quot;14&quot;&gt;
        14
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-14-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-14-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-14&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-14-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-14-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-14&quot; name=&quot;cell-14&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-14-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-14-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-14-source-label nb-source-label&quot; form=&quot;cell-14&quot; id=&quot;cell-14-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Looks good. We can sum up the pixels in this aperture, and create an uncorrected light curve.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Looks good. We can sum up the pixels in this aperture, and create an uncorrected light curve.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-14-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-14&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-14-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'L7HKo9k--Csz'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-14-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Looks good. We can sum up the pixels in this aperture, and create an uncorrected light curve.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 15 cell-15-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;15&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-15-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 15&quot; href=&quot;#15&quot; id=&quot;15&quot;&gt;
        15
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-15-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-15-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-15&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-15-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-15-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-15&quot; name=&quot;cell-15&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-15-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-15-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-15-source-label nb-source-label&quot; form=&quot;cell-15&quot; id=&quot;cell-15-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;uncorrected_lc = tpf.to_lightcurve(aperture_mask=aper)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;to_lightcurve&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture_mask&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-15-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-15&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-15-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-15-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-15-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 16 cell-16-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;16&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-16-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 16&quot; href=&quot;#16&quot; id=&quot;16&quot;&gt;
        16
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-16-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-16-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-16&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-16-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-16-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-16&quot; name=&quot;cell-16&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-16-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-16-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-16-source-label nb-source-label&quot; form=&quot;cell-16&quot; id=&quot;cell-16-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;uncorrected_lc.plot();&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-16-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-16&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-16-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-16-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-16-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 17 cell-17-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;17&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-17-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 17&quot; href=&quot;#17&quot; id=&quot;17&quot;&gt;
        17
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-17-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-17-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-17&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-17-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-17-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-17&quot; name=&quot;cell-17&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-17-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-17-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-17-source-label nb-source-label&quot; form=&quot;cell-17&quot; id=&quot;cell-17-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;## 2. Creating a `DesignMatrix` from Pixel Regressors&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## 2. Creating a `DesignMatrix` from Pixel Regressors&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-17-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-17&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-17-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'HcMtgqnyJDnC'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-17-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;2-creating-a-designmatrix-from-pixel-regressors&quot;&gt;
        &lt;a href=&quot;#2-creating-a-designmatrix-from-pixel-regressors&quot;&gt;
         None
        &lt;/a&gt;
       &lt;/h2&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 18 cell-18-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;18&quot; data-loc=&quot;7&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-18-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 18&quot; href=&quot;#18&quot; id=&quot;18&quot;&gt;
        18
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-18-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-18-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-18&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-18-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-18-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-18&quot; name=&quot;cell-18&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-18-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-18-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-18-source-label nb-source-label&quot; form=&quot;cell-18&quot; id=&quot;cell-18-source&quot; name=&quot;source&quot; readonly rows=&quot;7&quot;&gt;The flux in the aperture appears to be dominated by scattered light. We can tell because *TESS* orbits Earth twice in each sector, thus patterns which appear twice within a sector are typically related to the *TESS* orbit (such as the scattered light effect).

To remove this light, we are going to detrend the light curve against some vectors which we think are predictive of this systematic noise.

In this case, we can use the **pixels outside the aperture** as vectors that are highly predictive of the systematic noise, that is, we will make the assumption that these pixels do not contain any flux from our target.

We can select these pixels by specifying flux outside of the aperture using Python's bitwise invert operator `~` to take the inverse of the aperture mask.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;The flux in the aperture appears to be dominated by scattered light. We can tell because &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; orbits Earth twice in each sector, thus patterns which appear twice within a sector are typically related to the &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; orbit (such as the scattered light effect).

To remove this light, we are going to detrend the light curve against some vectors which we think are predictive of this systematic noise.

In this case, we can use the &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**pixels outside the aperture**&lt;/span&gt; as vectors that are highly predictive of the systematic noise, that is, we will make the assumption that these pixels do not contain any flux from our target.

We can select these pixels by specifying flux outside of the aperture using Python's bitwise invert operator &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`~`&lt;/span&gt; to take the inverse of the aperture mask.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-18-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-18&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-18-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'XCivwPyP-Cs4'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-18-loc&quot; role=&quot;none&quot;&gt;
       7
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        The flux in the aperture appears to be dominated by scattered light. We can tell because
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        orbits Earth twice in each sector, thus patterns which appear twice within a sector are typically related to the
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        orbit (such as the scattered light effect).
       &lt;/p&gt;
       &lt;p&gt;
        To remove this light, we are going to detrend the light curve against some vectors which we think are predictive of this systematic noise.
       &lt;/p&gt;
       &lt;p&gt;
        In this case, we can use the
        &lt;strong&gt;
         pixels outside the aperture
        &lt;/strong&gt;
        as vectors that are highly predictive of the systematic noise, that is, we will make the assumption that these pixels do not contain any flux from our target.
       &lt;/p&gt;
       &lt;p&gt;
        We can select these pixels by specifying flux outside of the aperture using Python's bitwise invert operator
        &lt;code&gt;
         ~
        &lt;/code&gt;
        to take the inverse of the aperture mask.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 19 cell-19-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;19&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-19-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 19&quot; href=&quot;#19&quot; id=&quot;19&quot;&gt;
        19
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-19-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-19-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-19&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-19-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-19-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-19&quot; name=&quot;cell-19&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-19-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-19-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-19-source-label nb-source-label&quot; form=&quot;cell-19&quot; id=&quot;cell-19-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;regressors = tpf.flux[:, ~aper]&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;regressors&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-19-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-19&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-19-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-19-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-19-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 20 cell-20-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;20&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-20-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 20&quot; href=&quot;#20&quot; id=&quot;20&quot;&gt;
        20
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-20-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-20-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-20&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-20-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-20-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-20&quot; name=&quot;cell-20&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-20-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-20-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-20-source-label nb-source-label&quot; form=&quot;cell-20&quot; id=&quot;cell-20-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;regressors.shape&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;regressors&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;shape&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-20-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-20&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-20-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-20-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-20-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 21 cell-21-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;21&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-21-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 21&quot; href=&quot;#21&quot; id=&quot;21&quot;&gt;
        21
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-21-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-21-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-21&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-21-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-21-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-21&quot; name=&quot;cell-21&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-21-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-21-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-21-source-label nb-source-label&quot; form=&quot;cell-21&quot; id=&quot;cell-21-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;`regressors` is now an array with shape *ntime* x *npixels outside of the aperture*. If we plot the first 30 of these pixels, we can see that they contain mostly scattered light, with some offset terms.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`regressors`&lt;/span&gt; is now an array with shape &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*ntime*&lt;/span&gt; x &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*npixels outside of the aperture*&lt;/span&gt;. If we plot the first 30 of these pixels, we can see that they contain mostly scattered light, with some offset terms.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-21-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-21&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-21-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'OcA2bJKk-Cs8'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-21-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;code&gt;
         regressors
        &lt;/code&gt;
        is now an array with shape
        &lt;em&gt;
         ntime
        &lt;/em&gt;
        x
        &lt;em&gt;
         npixels outside of the aperture
        &lt;/em&gt;
        . If we plot the first 30 of these pixels, we can see that they contain mostly scattered light, with some offset terms.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 22 cell-22-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;22&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-22-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 22&quot; href=&quot;#22&quot; id=&quot;22&quot;&gt;
        22
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-22-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-22-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-22&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-22-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-22-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-22&quot; name=&quot;cell-22&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-22-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-22-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-22-source-label nb-source-label&quot; form=&quot;cell-22&quot; id=&quot;cell-22-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;plt.plot(regressors[:, :30]);&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;regressors&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-22-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-22&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-22-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-22-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-22-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 23 cell-23-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;23&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-23-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 23&quot; href=&quot;#23&quot; id=&quot;23&quot;&gt;
        23
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-23-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-23-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-23&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-23-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-23-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-23&quot; name=&quot;cell-23&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-23-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-23-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-23-source-label nb-source-label&quot; form=&quot;cell-23&quot; id=&quot;cell-23-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;In linear regression problems, it is common to refer to the matrix of regressors as the design matrix (also known as model matrix or regressor matrix). Lightkurve provides a convenient `DesignMatrix` class which is designed to help you work with detrending vectors. 

The `DesignMatrix` class has several convenience functions, and can be passed into Lightkurve's corrector objects. Please consult the [DesignMatrix page](https://docs.lightkurve.org/api/lightkurve.correctors.DesignMatrix.html) in the API docs for the full details on the methods and features provided by this class.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;In linear regression problems, it is common to refer to the matrix of regressors as the design matrix (also known as model matrix or regressor matrix). Lightkurve provides a convenient &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`DesignMatrix`&lt;/span&gt; class which is designed to help you work with detrending vectors. 

The &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`DesignMatrix`&lt;/span&gt; class has several convenience functions, and can be passed into Lightkurve's corrector objects. Please consult the [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;DesignMatrix page&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://docs.lightkurve.org/api/lightkurve.correctors.DesignMatrix.html&lt;/span&gt;) in the API docs for the full details on the methods and features provided by this class.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-23-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-23&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-23-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'LsENQCtA-Cs_'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-23-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        In linear regression problems, it is common to refer to the matrix of regressors as the design matrix (also known as model matrix or regressor matrix). Lightkurve provides a convenient
        &lt;code&gt;
         DesignMatrix
        &lt;/code&gt;
        class which is designed to help you work with detrending vectors.
       &lt;/p&gt;
       &lt;p&gt;
        The
        &lt;code&gt;
         DesignMatrix
        &lt;/code&gt;
        class has several convenience functions, and can be passed into Lightkurve's corrector objects. Please consult the
        &lt;a href=&quot;https://docs.lightkurve.org/api/lightkurve.correctors.DesignMatrix.html&quot;&gt;
         DesignMatrix page
        &lt;/a&gt;
        in the API docs for the full details on the methods and features provided by this class.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 24 cell-24-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;24&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-24-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 24&quot; href=&quot;#24&quot; id=&quot;24&quot;&gt;
        24
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-24-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-24-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-24&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-24-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-24-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-24&quot; name=&quot;cell-24&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-24-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-24-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-24-source-label nb-source-label&quot; form=&quot;cell-24&quot; id=&quot;cell-24-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;dm = lk.DesignMatrix(regressors, name='regressors')&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;DesignMatrix&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;regressors&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'regressors'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-24-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-24&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-24-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-24-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-24-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 25 cell-25-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;25&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-25-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 25&quot; href=&quot;#25&quot; id=&quot;25&quot;&gt;
        25
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-25-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-25-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-25&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-25-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-25-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-25&quot; name=&quot;cell-25&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-25-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-25-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-25-source-label nb-source-label&quot; form=&quot;cell-25&quot; id=&quot;cell-25-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;dm&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-25-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-25&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-25-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-25-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-25-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 26 cell-26-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;26&quot; data-loc=&quot;7&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-26-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 26&quot; href=&quot;#26&quot; id=&quot;26&quot;&gt;
        26
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-26-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-26-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-26&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-26-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-26-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-26&quot; name=&quot;cell-26&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-26-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-26-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-26-source-label nb-source-label&quot; form=&quot;cell-26&quot; id=&quot;cell-26-source&quot; name=&quot;source&quot; readonly rows=&quot;7&quot;&gt;As shown above, `dm` is now a design matrix with the same shape as the input pixels. Currently, we have 2,541 pixels that we are using to detrend our light curve against. Rather than using all of the pixels, we can reduce these to their principal components using Principal Component Analysis (PCA). We do this for several reasons:

1. By reducing to a smaller number of vectors, we can remove some of the stochastic noise in our detrending vectors.
2. By reducing to the principal components, we can avoid pixels that have intrinsic variability (for example, from astrophysical long-period variables) that can be confused with the true astrophysical signal of our target.
3. By reducing the number of vectors, our detrending will be faster (although in this case, the detrending will still take seconds).

The choice of the number of components is a tricky issue, but in general you should choose a number that is much smaller than the number of vectors.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;As shown above, &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`dm`&lt;/span&gt; is now a design matrix with the same shape as the input pixels. Currently, we have 2,541 pixels that we are using to detrend our light curve against. Rather than using all of the pixels, we can reduce these to their principal components using Principal Component Analysis (PCA). We do this for several reasons:

&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;1.&lt;/span&gt; By reducing to a smaller number of vectors, we can remove some of the stochastic noise in our detrending vectors.
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;2.&lt;/span&gt; By reducing to the principal components, we can avoid pixels that have intrinsic variability (for example, from astrophysical long-period variables) that can be confused with the true astrophysical signal of our target.
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;3.&lt;/span&gt; By reducing the number of vectors, our detrending will be faster (although in this case, the detrending will still take seconds).

The choice of the number of components is a tricky issue, but in general you should choose a number that is much smaller than the number of vectors.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-26-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-26&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-26-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': '1jVWgySe-CtD'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-26-loc&quot; role=&quot;none&quot;&gt;
       7
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        As shown above,
        &lt;code&gt;
         dm
        &lt;/code&gt;
        is now a design matrix with the same shape as the input pixels. Currently, we have 2,541 pixels that we are using to detrend our light curve against. Rather than using all of the pixels, we can reduce these to their principal components using Principal Component Analysis (PCA). We do this for several reasons:
       &lt;/p&gt;
       &lt;ol&gt;
        &lt;li&gt;
         By reducing to a smaller number of vectors, we can remove some of the stochastic noise in our detrending vectors.
        &lt;/li&gt;
        &lt;li&gt;
         By reducing to the principal components, we can avoid pixels that have intrinsic variability (for example, from astrophysical long-period variables) that can be confused with the true astrophysical signal of our target.
        &lt;/li&gt;
        &lt;li&gt;
         By reducing the number of vectors, our detrending will be faster (although in this case, the detrending will still take seconds).
        &lt;/li&gt;
       &lt;/ol&gt;
       &lt;p&gt;
        The choice of the number of components is a tricky issue, but in general you should choose a number that is much smaller than the number of vectors.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 27 cell-27-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;27&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-27-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 27&quot; href=&quot;#27&quot; id=&quot;27&quot;&gt;
        27
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-27-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-27-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-27&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-27-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-27-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-27&quot; name=&quot;cell-27&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-27-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-27-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-27-source-label nb-source-label&quot; form=&quot;cell-27&quot; id=&quot;cell-27-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;dm = dm.pca(5)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pca&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-27-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-27&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-27-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-27-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-27-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 28 cell-28-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;28&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-28-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 28&quot; href=&quot;#28&quot; id=&quot;28&quot;&gt;
        28
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-28-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-28-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-28&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-28-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-28-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-28&quot; name=&quot;cell-28&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-28-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-28-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-28-source-label nb-source-label&quot; form=&quot;cell-28&quot; id=&quot;cell-28-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;dm&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-28-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-28&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-28-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-28-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-28-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 29 cell-29-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;29&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-29-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 29&quot; href=&quot;#29&quot; id=&quot;29&quot;&gt;
        29
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-29-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-29-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-29&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-29-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-29-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-29&quot; name=&quot;cell-29&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-29-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-29-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-29-source-label nb-source-label&quot; form=&quot;cell-29&quot; id=&quot;cell-29-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Using the `pca()` method, we have now reduced the number of components in our design matrix to five. These vectors show a combination of scattered light and spacecraft motion, which makes them suited to detrend our input light curve.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Using the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`pca()`&lt;/span&gt; method, we have now reduced the number of components in our design matrix to five. These vectors show a combination of scattered light and spacecraft motion, which makes them suited to detrend our input light curve.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-29-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-29&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-29-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'QJd-0Kf3-CtH'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-29-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Using the
        &lt;code&gt;
         pca()
        &lt;/code&gt;
        method, we have now reduced the number of components in our design matrix to five. These vectors show a combination of scattered light and spacecraft motion, which makes them suited to detrend our input light curve.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 30 cell-30-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;30&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-30-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 30&quot; href=&quot;#30&quot; id=&quot;30&quot;&gt;
        30
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-30-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-30-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-30&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-30-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-30-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-30&quot; name=&quot;cell-30&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-30-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-30-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-30-source-label nb-source-label&quot; form=&quot;cell-30&quot; id=&quot;cell-30-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;plt.plot(tpf.time.value, dm.values + np.arange(5)*0.2, '.');&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-30-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-30&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-30-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-30-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-30-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 31 cell-31-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;31&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-31-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 31&quot; href=&quot;#31&quot; id=&quot;31&quot;&gt;
        31
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-31-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-31-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-31&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-31-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-31-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-31&quot; name=&quot;cell-31&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-31-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-31-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-31-source-label nb-source-label&quot; form=&quot;cell-31&quot; id=&quot;cell-31-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Note: the `DesignMatrix` object provides a convenient `plot()` method to visualize the vectors:&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Note: the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`DesignMatrix`&lt;/span&gt; object provides a convenient &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`plot()`&lt;/span&gt; method to visualize the vectors:
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-31-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-31&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-31-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'zOOPOhn3-CtJ'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-31-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Note: the
        &lt;code&gt;
         DesignMatrix
        &lt;/code&gt;
        object provides a convenient
        &lt;code&gt;
         plot()
        &lt;/code&gt;
        method to visualize the vectors:
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 32 cell-32-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;32&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-32-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 32&quot; href=&quot;#32&quot; id=&quot;32&quot;&gt;
        32
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-32-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-32-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-32&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-32-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-32-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-32&quot; name=&quot;cell-32&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-32-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-32-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-32-source-label nb-source-label&quot; form=&quot;cell-32&quot; id=&quot;cell-32-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;dm.plot();&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-32-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-32&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-32-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-32-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-32-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 33 cell-33-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;33&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-33-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 33&quot; href=&quot;#33&quot; id=&quot;33&quot;&gt;
        33
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-33-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-33-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-33&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-33-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-33-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-33&quot; name=&quot;cell-33&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-33-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-33-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-33-source-label nb-source-label&quot; form=&quot;cell-33&quot; id=&quot;cell-33-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;We can now detrend the uncorrected light curve against these vectors. Lightkurve's `RegressionCorrector` will use linear algebra to find the combination of vectors that makes the input light curve **closest to zero**. To do this, we need one more component; we need an &quot;offset&quot; term, to be able to fit the mean level of the light curve. We can do this by appending a &quot;constant&quot; to our design matrix.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;We can now detrend the uncorrected light curve against these vectors. Lightkurve's &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; will use linear algebra to find the combination of vectors that makes the input light curve &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**closest to zero**&lt;/span&gt;. To do this, we need one more component; we need an &quot;offset&quot; term, to be able to fit the mean level of the light curve. We can do this by appending a &quot;constant&quot; to our design matrix.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-33-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-33&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-33-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'EVmE9d6r-CtM'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-33-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        We can now detrend the uncorrected light curve against these vectors. Lightkurve's
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        will use linear algebra to find the combination of vectors that makes the input light curve
        &lt;strong&gt;
         closest to zero
        &lt;/strong&gt;
        . To do this, we need one more component; we need an &quot;offset&quot; term, to be able to fit the mean level of the light curve. We can do this by appending a &quot;constant&quot; to our design matrix.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 34 cell-34-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;34&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-34-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 34&quot; href=&quot;#34&quot; id=&quot;34&quot;&gt;
        34
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-34-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-34-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-34&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-34-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-34-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-34&quot; name=&quot;cell-34&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-34-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-34-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-34-source-label nb-source-label&quot; form=&quot;cell-34&quot; id=&quot;cell-34-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;dm = dm.append_constant()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;append_constant&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-34-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-34&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-34-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-34-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-34-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 35 cell-35-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;35&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-35-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 35&quot; href=&quot;#35&quot; id=&quot;35&quot;&gt;
        35
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-35-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-35-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-35&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-35-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-35-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-35&quot; name=&quot;cell-35&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-35-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-35-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-35-source-label nb-source-label&quot; form=&quot;cell-35&quot; id=&quot;cell-35-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;## 3. Removing Background Scattered Light Using Linear Regression&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## 3. Removing Background Scattered Light Using Linear Regression&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-35-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-35&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-35-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': '6qYkny8tJU2f'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-35-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;3-removing-background-scattered-light-using-linear-regression&quot;&gt;
        &lt;a href=&quot;#3-removing-background-scattered-light-using-linear-regression&quot;&gt;
         3. Removing Background Scattered Light Using Linear Regression
        &lt;/a&gt;
       &lt;/h2&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 36 cell-36-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;36&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-36-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 36&quot; href=&quot;#36&quot; id=&quot;36&quot;&gt;
        36
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-36-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-36-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-36&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-36-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-36-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-36&quot; name=&quot;cell-36&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-36-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-36-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-36-source-label nb-source-label&quot; form=&quot;cell-36&quot; id=&quot;cell-36-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;Now that we have a design matrix, we only need to pass it into a `lightkurve.Corrector`. To use our design matrix, we can pass it to the `RegressionCorrector`, which will detrend the input light curve against the vectors we've built.

Please consult the [RegressionCorrector page](https://docs.lightkurve.org/api/lightkurve.correctors.RegressionCorrector.html) in the API docs for the full details on the methods and features provided by this class.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Now that we have a design matrix, we only need to pass it into a &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`lightkurve.Corrector`&lt;/span&gt;. To use our design matrix, we can pass it to the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt;, which will detrend the input light curve against the vectors we've built.

Please consult the [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;RegressionCorrector page&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://docs.lightkurve.org/api/lightkurve.correctors.RegressionCorrector.html&lt;/span&gt;) in the API docs for the full details on the methods and features provided by this class.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-36-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-36&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-36-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'l5aQXZjw-CtR'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-36-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Now that we have a design matrix, we only need to pass it into a
        &lt;code&gt;
         lightkurve.Corrector
        &lt;/code&gt;
        . To use our design matrix, we can pass it to the
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        , which will detrend the input light curve against the vectors we've built.
       &lt;/p&gt;
       &lt;p&gt;
        Please consult the
        &lt;a href=&quot;https://docs.lightkurve.org/api/lightkurve.correctors.RegressionCorrector.html&quot;&gt;
         RegressionCorrector page
        &lt;/a&gt;
        in the API docs for the full details on the methods and features provided by this class.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 37 cell-37-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;37&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-37-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 37&quot; href=&quot;#37&quot; id=&quot;37&quot;&gt;
        37
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-37-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-37-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-37&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-37-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-37-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-37&quot; name=&quot;cell-37&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-37-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-37-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-37-source-label nb-source-label&quot; form=&quot;cell-37&quot; id=&quot;cell-37-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;corrector = lk.RegressionCorrector(uncorrected_lc)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrector&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;RegressionCorrector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-37-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-37&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-37-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-37-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-37-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 38 cell-38-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;38&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-38-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 38&quot; href=&quot;#38&quot; id=&quot;38&quot;&gt;
        38
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-38-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-38-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-38&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-38-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-38-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-38&quot; name=&quot;cell-38&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-38-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-38-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-38-source-label nb-source-label&quot; form=&quot;cell-38&quot; id=&quot;cell-38-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;corrector&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrector&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-38-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-38&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-38-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-38-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-38-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 39 cell-39-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;39&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-39-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 39&quot; href=&quot;#39&quot; id=&quot;39&quot;&gt;
        39
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-39-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-39-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-39&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-39-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-39-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-39&quot; name=&quot;cell-39&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-39-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-39-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-39-source-label nb-source-label&quot; form=&quot;cell-39&quot; id=&quot;cell-39-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;To correct the light curve, we pass in our design matrix.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;To correct the light curve, we pass in our design matrix.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-39-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-39&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-39-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'tcTlNruW-CtV'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-39-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        To correct the light curve, we pass in our design matrix.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 40 cell-40-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;40&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-40-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 40&quot; href=&quot;#40&quot; id=&quot;40&quot;&gt;
        40
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-40-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-40-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-40&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-40-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-40-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-40&quot; name=&quot;cell-40&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-40-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-40-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-40-source-label nb-source-label&quot; form=&quot;cell-40&quot; id=&quot;cell-40-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;corrected_lc = corrector.correct(dm)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrector&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;correct&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-40-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-40&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-40-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-40-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-40-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 41 cell-41-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;41&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-41-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 41&quot; href=&quot;#41&quot; id=&quot;41&quot;&gt;
        41
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-41-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-41-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-41&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-41-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-41-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-41&quot; name=&quot;cell-41&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-41-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-41-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-41-source-label nb-source-label&quot; form=&quot;cell-41&quot; id=&quot;cell-41-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Now we can plot the results:&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Now we can plot the results:
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-41-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-41&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-41-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'f6v_OWxe-CtY'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-41-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Now we can plot the results:
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 42 cell-42-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;42&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-42-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 42&quot; href=&quot;#42&quot; id=&quot;42&quot;&gt;
        42
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-42-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-42-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-42&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-42-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-42-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-42&quot; name=&quot;cell-42&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-42-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-42-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-42-source-label nb-source-label&quot; form=&quot;cell-42&quot; id=&quot;cell-42-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;ax = uncorrected_lc.plot(label='Original light curve')
corrected_lc.plot(ax=ax, label='Corrected light curve');&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Original light curve'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Corrected light curve'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-42-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-42&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-42-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-42-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-42-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 43 cell-43-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;43&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-43-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 43&quot; href=&quot;#43&quot; id=&quot;43&quot;&gt;
        43
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-43-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-43-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-43&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-43-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-43-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-43&quot; name=&quot;cell-43&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-43-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-43-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-43-source-label nb-source-label&quot; form=&quot;cell-43&quot; id=&quot;cell-43-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;As shown above, the scattered light from the background has been removed. If we want to take a more in-depth look at the correction, we can use the `diagnose()` method to see what the `RegressionCorrector` found as the best fitting solution.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;As shown above, the scattered light from the background has been removed. If we want to take a more in-depth look at the correction, we can use the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`diagnose()`&lt;/span&gt; method to see what the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; found as the best fitting solution.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-43-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-43&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-43-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'wJPoKJop-Cta'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-43-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        As shown above, the scattered light from the background has been removed. If we want to take a more in-depth look at the correction, we can use the
        &lt;code&gt;
         diagnose()
        &lt;/code&gt;
        method to see what the
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        found as the best fitting solution.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 44 cell-44-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;44&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-44-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 44&quot; href=&quot;#44&quot; id=&quot;44&quot;&gt;
        44
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-44-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-44-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-44&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-44-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-44-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-44&quot; name=&quot;cell-44&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-44-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-44-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-44-source-label nb-source-label&quot; form=&quot;cell-44&quot; id=&quot;cell-44-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;## 4. Diagnosing the Correction&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## 4. Diagnosing the Correction&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-44-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-44&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-44-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'bl_TGn7DJmvy'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-44-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;4-diagnosing-the-correction&quot;&gt;
        &lt;a href=&quot;#4-diagnosing-the-correction&quot;&gt;
         4. Diagnosing the Correction
        &lt;/a&gt;
       &lt;/h2&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 45 cell-45-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;45&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-45-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 45&quot; href=&quot;#45&quot; id=&quot;45&quot;&gt;
        45
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-45-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-45-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-45&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-45-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-45-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-45&quot; name=&quot;cell-45&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-45-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-45-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-45-source-label nb-source-label&quot; form=&quot;cell-45&quot; id=&quot;cell-45-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;corrector.diagnose();&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrector&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diagnose&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-45-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-45&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-45-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-45-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-45-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 46 cell-46-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;46&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-46-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 46&quot; href=&quot;#46&quot; id=&quot;46&quot;&gt;
        46
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-46-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-46-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-46&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-46-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-46-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-46&quot; name=&quot;cell-46&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-46-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-46-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-46-source-label nb-source-label&quot; form=&quot;cell-46&quot; id=&quot;cell-46-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;The `RegressionCorrector` has clipped out some outliers during the fit of the trend. You can read more about the outlier removal, how to pass a cadence mask, and error propagation in the [docs](https://docs.lightkurve.org/api/lightkurve.correctors.RegressionCorrector.html#lightkurve.correctors.RegressionCorrector).&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;The &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; has clipped out some outliers during the fit of the trend. You can read more about the outlier removal, how to pass a cadence mask, and error propagation in the [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;docs&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://docs.lightkurve.org/api/lightkurve.correctors.RegressionCorrector.html#lightkurve.correctors.RegressionCorrector&lt;/span&gt;).
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-46-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-46&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-46-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': '9Boc_bF0-Ctc'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-46-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        The
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        has clipped out some outliers during the fit of the trend. You can read more about the outlier removal, how to pass a cadence mask, and error propagation in the
        &lt;a href=&quot;https://docs.lightkurve.org/api/lightkurve.correctors.RegressionCorrector.html#lightkurve.correctors.RegressionCorrector&quot;&gt;
         docs
        &lt;/a&gt;
        .
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 47 cell-47-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;47&quot; data-loc=&quot;5&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-47-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 47&quot; href=&quot;#47&quot; id=&quot;47&quot;&gt;
        47
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-47-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-47-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-47&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-47-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-47-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-47&quot; name=&quot;cell-47&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-47-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-47-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-47-source-label nb-source-label&quot; form=&quot;cell-47&quot; id=&quot;cell-47-source&quot; name=&quot;source&quot; readonly rows=&quot;5&quot;&gt;**Watch Out!**

The `RegressionCorrector` assumes that you want to remove the trend and set the light curve to the **mean** level of the **uncorrected light curve**. This isn't true for *TESS* scattered light. *TESS* FFI light curves have **additive background**, and so we want to reduce the flux to the lowest recorded level, assuming that at that point the contribution from scattered light is approximately zero.

To do this, we will first need to look at the model of the background that `RegressionCorrector` built. We can access that in the `corrector` object.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Watch Out!**&lt;/span&gt;

The &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; assumes that you want to remove the trend and set the light curve to the &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**mean**&lt;/span&gt; level of the &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**uncorrected light curve**&lt;/span&gt;. This isn't true for &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; scattered light. &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; FFI light curves have &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**additive background**&lt;/span&gt;, and so we want to reduce the flux to the lowest recorded level, assuming that at that point the contribution from scattered light is approximately zero.

To do this, we will first need to look at the model of the background that &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; built. We can access that in the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`corrector`&lt;/span&gt; object.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-47-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-47&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-47-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'tjbwIoe--Ctc'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-47-loc&quot; role=&quot;none&quot;&gt;
       5
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Watch Out!
        &lt;/strong&gt;
       &lt;/p&gt;
       &lt;p&gt;
        The
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        assumes that you want to remove the trend and set the light curve to the
        &lt;strong&gt;
         mean
        &lt;/strong&gt;
        level of the
        &lt;strong&gt;
         uncorrected light curve
        &lt;/strong&gt;
        . This isn't true for
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        scattered light.
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        FFI light curves have
        &lt;strong&gt;
         additive background
        &lt;/strong&gt;
        , and so we want to reduce the flux to the lowest recorded level, assuming that at that point the contribution from scattered light is approximately zero.
       &lt;/p&gt;
       &lt;p&gt;
        To do this, we will first need to look at the model of the background that
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        built. We can access that in the
        &lt;code&gt;
         corrector
        &lt;/code&gt;
        object.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 48 cell-48-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;48&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-48-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 48&quot; href=&quot;#48&quot; id=&quot;48&quot;&gt;
        48
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-48-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-48-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-48&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-48-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-48-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-48&quot; name=&quot;cell-48&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-48-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-48-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-48-source-label nb-source-label&quot; form=&quot;cell-48&quot; id=&quot;cell-48-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;corrector.model_lc&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrector&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model_lc&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-48-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-48&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-48-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-48-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-48-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 49 cell-49-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;49&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-49-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 49&quot; href=&quot;#49&quot; id=&quot;49&quot;&gt;
        49
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-49-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-49-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-49&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-49-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-49-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-49&quot; name=&quot;cell-49&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-49-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-49-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-49-source-label nb-source-label&quot; form=&quot;cell-49&quot; id=&quot;cell-49-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;model = corrector.model_lc
model.plot();&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrector&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model_lc&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-49-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-49&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-49-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-49-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-49-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 50 cell-50-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;50&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-50-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 50&quot; href=&quot;#50&quot; id=&quot;50&quot;&gt;
        50
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-50-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-50-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-50&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-50-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-50-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-50&quot; name=&quot;cell-50&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-50-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-50-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-50-source-label nb-source-label&quot; form=&quot;cell-50&quot; id=&quot;cell-50-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;As you can see above, the model drops below zero flux. This is impossible; the scattered light can't be removing flux from our target! 

To rectify this, we can subtract the model flux value at the 5th percentile.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;As you can see above, the model drops below zero flux. This is impossible; the scattered light can't be removing flux from our target! 

To rectify this, we can subtract the model flux value at the 5th percentile.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-50-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-50&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-50-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': '8GYiVNZ7-Ctg'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-50-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        As you can see above, the model drops below zero flux. This is impossible; the scattered light can't be removing flux from our target!
       &lt;/p&gt;
       &lt;p&gt;
        To rectify this, we can subtract the model flux value at the 5th percentile.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 51 cell-51-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;51&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-51-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 51&quot; href=&quot;#51&quot; id=&quot;51&quot;&gt;
        51
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-51-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-51-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-51&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-51-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-51-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-51&quot; name=&quot;cell-51&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-51-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-51-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-51-source-label nb-source-label&quot; form=&quot;cell-51&quot; id=&quot;cell-51-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;# Normalize to the 5th percentile of model flux
model -= np.percentile(model.flux, 5)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Normalize to the 5th percentile of model flux&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;percentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-51-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-51&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-51-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-51-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-51-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 52 cell-52-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;52&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-52-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 52&quot; href=&quot;#52&quot; id=&quot;52&quot;&gt;
        52
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-52-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-52-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-52&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-52-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-52-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-52&quot; name=&quot;cell-52&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-52-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-52-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-52-source-label nb-source-label&quot; form=&quot;cell-52&quot; id=&quot;cell-52-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;model.plot();&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-52-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-52&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-52-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-52-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-52-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 53 cell-53-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;53&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-53-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 53&quot; href=&quot;#53&quot; id=&quot;53&quot;&gt;
        53
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-53-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-53-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-53&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-53-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-53-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-53&quot; name=&quot;cell-53&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-53-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-53-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-53-source-label nb-source-label&quot; form=&quot;cell-53&quot; id=&quot;cell-53-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;This looks better. Now we can remove this model from our uncorrected light curve.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;This looks better. Now we can remove this model from our uncorrected light curve.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-53-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-53&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-53-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': '-F6cejiT-Ctk'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-53-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        This looks better. Now we can remove this model from our uncorrected light curve.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 54 cell-54-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;54&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-54-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 54&quot; href=&quot;#54&quot; id=&quot;54&quot;&gt;
        54
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-54-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-54-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-54&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-54-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-54-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-54&quot; name=&quot;cell-54&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-54-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-54-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-54-source-label nb-source-label&quot; form=&quot;cell-54&quot; id=&quot;cell-54-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;corrected_lc = uncorrected_lc - model&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-54-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-54&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-54-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-54-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-54-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 55 cell-55-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;55&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-55-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 55&quot; href=&quot;#55&quot; id=&quot;55&quot;&gt;
        55
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-55-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-55-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-55&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-55-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-55-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-55&quot; name=&quot;cell-55&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-55-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-55-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-55-source-label nb-source-label&quot; form=&quot;cell-55&quot; id=&quot;cell-55-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;ax = uncorrected_lc.plot(label='Original light curve')
corrected_lc.plot(ax=ax, label='Corrected light curve');&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Original light curve'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Corrected light curve'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-55-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-55&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-55-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-55-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-55-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 56 cell-56-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;56&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-56-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 56&quot; href=&quot;#56&quot; id=&quot;56&quot;&gt;
        56
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-56-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-56-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-56&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-56-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-56-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-56&quot; name=&quot;cell-56&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-56-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-56-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-56-source-label nb-source-label&quot; form=&quot;cell-56&quot; id=&quot;cell-56-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;This looks great. As a final test, let's investigate how the light curve we obtained using `RegressionCorrector` compares against a light curve obtained using a more basic median background removal method.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;This looks great. As a final test, let's investigate how the light curve we obtained using &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; compares against a light curve obtained using a more basic median background removal method.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-56-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-56&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-56-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'cVInnt_9-Cto'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-56-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        This looks great. As a final test, let's investigate how the light curve we obtained using
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        compares against a light curve obtained using a more basic median background removal method.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 57 cell-57-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;57&quot; data-loc=&quot;8&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-57-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 57&quot; href=&quot;#57&quot; id=&quot;57&quot;&gt;
        57
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-57-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-57-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-57&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-57-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-57-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-57&quot; name=&quot;cell-57&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-57-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-57-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-57-source-label nb-source-label&quot; form=&quot;cell-57&quot; id=&quot;cell-57-source&quot; name=&quot;source&quot; readonly rows=&quot;8&quot;&gt;bkg = np.median(regressors, axis=1)
bkg -= np.percentile(bkg, 5)

npix = aper.sum()
median_subtracted_lc = uncorrected_lc - npix * bkg

ax = median_subtracted_lc.plot(label='Median background subtraction')
corrected_lc.plot(ax=ax, label='RegressionCorrector');&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkg&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;regressors&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkg&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;percentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkg&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;npix&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;median_subtracted_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;npix&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkg&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;median_subtracted_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Median background subtraction'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'RegressionCorrector'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-57-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-57&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-57-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-57-loc&quot; role=&quot;none&quot;&gt;
       8
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-57-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 58 cell-58-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;58&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-58-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 58&quot; href=&quot;#58&quot; id=&quot;58&quot;&gt;
        58
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-58-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-58-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-58&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-58-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-58-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-58&quot; name=&quot;cell-58&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-58-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-58-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-58-source-label nb-source-label&quot; form=&quot;cell-58&quot; id=&quot;cell-58-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Lastly, let's show how you can do all of the above in a single cell.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Lastly, let's show how you can do all of the above in a single cell.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-58-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-58&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-58-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'VvE4PU8K-Ctq'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-58-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Lastly, let's show how you can do all of the above in a single cell.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 59 cell-59-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;59&quot; data-loc=&quot;11&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-59-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 59&quot; href=&quot;#59&quot; id=&quot;59&quot;&gt;
        59
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-59-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-59-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-59&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-59-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-59-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-59&quot; name=&quot;cell-59&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-59-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-59-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-59-source-label nb-source-label&quot; form=&quot;cell-59&quot; id=&quot;cell-59-source&quot; name=&quot;source&quot; readonly rows=&quot;11&quot;&gt;# Make an aperture mask and an uncorrected light curve
aper = tpf.create_threshold_mask()
uncorrected_lc = tpf.to_lightcurve(aperture_mask=aper)

# Make a design matrix and pass it to a linear regression corrector
dm = lk.DesignMatrix(tpf.flux[:, ~aper], name='regressors').pca(5).append_constant()
rc = lk.RegressionCorrector(uncorrected_lc)
corrected_ffi_lc = rc.correct(dm)

# Optional: Remove the scattered light, allowing for the large offset from scattered light
corrected_ffi_lc = uncorrected_lc - rc.model_lc + np.percentile(rc.model_lc.flux, 5)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Make an aperture mask and an uncorrected light curve&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;create_threshold_mask&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;to_lightcurve&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture_mask&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Make a design matrix and pass it to a linear regression corrector&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;DesignMatrix&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'regressors'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pca&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;append_constant&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;RegressionCorrector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_ffi_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;correct&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Optional: Remove the scattered light, allowing for the large offset from scattered light&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_ffi_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;percentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;rc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-59-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-59&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-59-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-59-loc&quot; role=&quot;none&quot;&gt;
       11
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-59-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 60 cell-60-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;60&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-60-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 60&quot; href=&quot;#60&quot; id=&quot;60&quot;&gt;
        60
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-60-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-60-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-60&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-60-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-60-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-60&quot; name=&quot;cell-60&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-60-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-60-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-60-source-label nb-source-label&quot; form=&quot;cell-60&quot; id=&quot;cell-60-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;ax = uncorrected_lc.plot(label='Original light curve')
corrected_ffi_lc.plot(ax=ax, label='Corrected light curve');&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Original light curve'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_ffi_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Corrected light curve'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-60-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-60&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-60-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-60-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-60-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 61 cell-61-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;61&quot; data-loc=&quot;5&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-61-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 61&quot; href=&quot;#61&quot; id=&quot;61&quot;&gt;
        61
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-61-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-61-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-61&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-61-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-61-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-61&quot; name=&quot;cell-61&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-61-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-61-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-61-source-label nb-source-label&quot; form=&quot;cell-61&quot; id=&quot;cell-61-source&quot; name=&quot;source&quot; readonly rows=&quot;5&quot;&gt;## 5. Using `RegressionCorrector` on *TESS* Two-Minute Cadence Target Pixel Files

*TESS* releases high-time resolution TPFs of interesting targets. These higher time resolution TPFs have background removed for users by the pipeline. However, there are still common trends in TPF pixels that are not due to scattered light, but could be from, for example, spacecraft motion.

`RegressionCorrector` can be used in exactly the same way to remove these common trends.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## 5. Using `RegressionCorrector` on *TESS* Two-Minute Cadence Target Pixel Files&lt;/span&gt;

&lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; releases high-time resolution TPFs of interesting targets. These higher time resolution TPFs have background removed for users by the pipeline. However, there are still common trends in TPF pixels that are not due to scattered light, but could be from, for example, spacecraft motion.

&lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; can be used in exactly the same way to remove these common trends.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-61-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-61&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-61-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'oBGQPJnx-Ctu'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-61-loc&quot; role=&quot;none&quot;&gt;
       5
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;5-using-regressioncorrector-on-tess-two-minute-cadence-target-pixel-files&quot;&gt;
        &lt;a href=&quot;#5-using-regressioncorrector-on-tess-two-minute-cadence-target-pixel-files&quot;&gt;
         None
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        releases high-time resolution TPFs of interesting targets. These higher time resolution TPFs have background removed for users by the pipeline. However, there are still common trends in TPF pixels that are not due to scattered light, but could be from, for example, spacecraft motion.
       &lt;/p&gt;
       &lt;p&gt;
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        can be used in exactly the same way to remove these common trends.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 62 cell-62-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;62&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-62-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 62&quot; href=&quot;#62&quot; id=&quot;62&quot;&gt;
        62
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-62-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-62-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-62&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-62-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-62-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-62&quot; name=&quot;cell-62&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-62-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-62-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-62-source-label nb-source-label&quot; form=&quot;cell-62&quot; id=&quot;cell-62-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;# Download a 2-minute cadence Target Pixel File (TPF)
tpf_2min = lk.search_targetpixelfile(target, mission='TESS', sector=15).download()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Download a 2-minute cadence Target Pixel File (TPF)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf_2min&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;search_targetpixelfile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;mission&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TESS'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;download&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-62-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-62&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-62-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-62-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-62-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 63 cell-63-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;63&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-63-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 63&quot; href=&quot;#63&quot; id=&quot;63&quot;&gt;
        63
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-63-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-63-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-63&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-63-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-63-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-63&quot; name=&quot;cell-63&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-63-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-63-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-63-source-label nb-source-label&quot; form=&quot;cell-63&quot; id=&quot;cell-63-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;tpf_2min&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf_2min&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-63-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-63&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-63-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-63-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-63-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 64 cell-64-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;64&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-64-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 64&quot; href=&quot;#64&quot; id=&quot;64&quot;&gt;
        64
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-64-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-64-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-64&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-64-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-64-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-64&quot; name=&quot;cell-64&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-64-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-64-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-64-source-label nb-source-label&quot; form=&quot;cell-64&quot; id=&quot;cell-64-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Note, unlike the FFI data, the TPF has been processed by the pipeline, and includes an aperture mask.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Note, unlike the FFI data, the TPF has been processed by the pipeline, and includes an aperture mask.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-64-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-64&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-64-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'xXAa6wHT-Cty'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-64-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Note, unlike the FFI data, the TPF has been processed by the pipeline, and includes an aperture mask.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 65 cell-65-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;65&quot; data-loc=&quot;10&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-65-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 65&quot; href=&quot;#65&quot; id=&quot;65&quot;&gt;
        65
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-65-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-65-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-65&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-65-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-65-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-65&quot; name=&quot;cell-65&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-65-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-65-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-65-source-label nb-source-label&quot; form=&quot;cell-65&quot; id=&quot;cell-65-source&quot; name=&quot;source&quot; readonly rows=&quot;10&quot;&gt;# Use the pipeline aperture and an uncorrected light curve
aper = tpf_2min.pipeline_mask
uncorrected_lc = tpf_2min.to_lightcurve()

# Make a design matrix
dm = lk.DesignMatrix(tpf_2min.flux[:, ~aper], name='pixels').pca(5).append_constant()

# Regression Corrector Object
reg = lk.RegressionCorrector(uncorrected_lc)
corrected_lc = reg.correct(dm)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Use the pipeline aperture and an uncorrected light curve&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf_2min&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pipeline_mask&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf_2min&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;to_lightcurve&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Make a design matrix&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;DesignMatrix&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf_2min&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aper&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'pixels'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pca&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;append_constant&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Regression Corrector Object&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;reg&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;RegressionCorrector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;correct&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dm&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-65-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-65&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-65-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-65-loc&quot; role=&quot;none&quot;&gt;
       10
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-65-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 66 cell-66-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;66&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-66-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 66&quot; href=&quot;#66&quot; id=&quot;66&quot;&gt;
        66
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-66-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-66-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-66&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-66-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-66-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-66&quot; name=&quot;cell-66&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-66-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-66-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-66-source-label nb-source-label&quot; form=&quot;cell-66&quot; id=&quot;cell-66-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;ax = uncorrected_lc.errorbar(label='Original light curve')
corrected_lc.errorbar(ax=ax, label='Corrected light curve');&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;errorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Original light curve'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;errorbar&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Corrected light curve'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-66-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-66&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-66-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-66-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-66-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 67 cell-67-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;67&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-67-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 67&quot; href=&quot;#67&quot; id=&quot;67&quot;&gt;
        67
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-67-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-67-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-67&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-67-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-67-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-67&quot; name=&quot;cell-67&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-67-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-67-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-67-source-label nb-source-label&quot; form=&quot;cell-67&quot; id=&quot;cell-67-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;As you can see, the corrected light curve has removed long-term trends and some motion noise, for example, see time around 1720 Barycentric *TESS* Julian Date (BTJD). We can use the same `diagnose()` method to understand the model that has been fit and subtracted by `RegressionCorrector`.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;As you can see, the corrected light curve has removed long-term trends and some motion noise, for example, see time around 1720 Barycentric &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; Julian Date (BTJD). We can use the same &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`diagnose()`&lt;/span&gt; method to understand the model that has been fit and subtracted by &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt;.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-67-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-67&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-67-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'PQqpVvn6-Ct2'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-67-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        As you can see, the corrected light curve has removed long-term trends and some motion noise, for example, see time around 1720 Barycentric
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        Julian Date (BTJD). We can use the same
        &lt;code&gt;
         diagnose()
        &lt;/code&gt;
        method to understand the model that has been fit and subtracted by
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        .
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 68 cell-68-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;68&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-68-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 68&quot; href=&quot;#68&quot; id=&quot;68&quot;&gt;
        68
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-68-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-68-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-68&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-68-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-68-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-68&quot; name=&quot;cell-68&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-68-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-68-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-68-source-label nb-source-label&quot; form=&quot;cell-68&quot; id=&quot;cell-68-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;reg.diagnose();&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diagnose&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-68-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-68&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-68-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-68-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-68-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 69 cell-69-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;69&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-69-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 69&quot; href=&quot;#69&quot; id=&quot;69&quot;&gt;
        69
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-69-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-69-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-69&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-69-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-69-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-69&quot; name=&quot;cell-69&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-69-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-69-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-69-source-label nb-source-label&quot; form=&quot;cell-69&quot; id=&quot;cell-69-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;To show the corrected version has improved, we can use the Combined Differential Photometric Precision (CDPP) metric. As shown below, the corrected light curve has a lower CDPP, showing it is less noisy.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;To show the corrected version has improved, we can use the Combined Differential Photometric Precision (CDPP) metric. As shown below, the corrected light curve has a lower CDPP, showing it is less noisy.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-69-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-69&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-69-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'eY_K5YDH-Ct6'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-69-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        To show the corrected version has improved, we can use the Combined Differential Photometric Precision (CDPP) metric. As shown below, the corrected light curve has a lower CDPP, showing it is less noisy.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 70 cell-70-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;70&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-70-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 70&quot; href=&quot;#70&quot; id=&quot;70&quot;&gt;
        70
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-70-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-70-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-70&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-70-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-70-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-70&quot; name=&quot;cell-70&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-70-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-70-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-70-source-label nb-source-label&quot; form=&quot;cell-70&quot; id=&quot;cell-70-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;uncorrected_lc.estimate_cdpp()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;uncorrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;estimate_cdpp&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-70-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-70&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-70-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-70-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-70-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 71 cell-71-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;71&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-71-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 71&quot; href=&quot;#71&quot; id=&quot;71&quot;&gt;
        71
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-71-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-71-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-71&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-71-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-71-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-71&quot; name=&quot;cell-71&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-71-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-71-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-71-source-label nb-source-label&quot; form=&quot;cell-71&quot; id=&quot;cell-71-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;corrected_lc.estimate_cdpp()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;estimate_cdpp&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-71-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-71&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-71-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-71-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-71-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 72 cell-72-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;72&quot; data-loc=&quot;9&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-72-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 72&quot; href=&quot;#72&quot; id=&quot;72&quot;&gt;
        72
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-72-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-72-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-72&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-72-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-72-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-72&quot; name=&quot;cell-72&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-72-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-72-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-72-source-label nb-source-label&quot; form=&quot;cell-72&quot; id=&quot;cell-72-source&quot; name=&quot;source&quot; readonly rows=&quot;9&quot;&gt;## 6. Should I use `RegressionCorrector` or `PLDCorrector`?

In addition to the corrector demonstrated in this tutorial, Lightkurve has a special case of `RegressionCorrector` called `PLDCorrector`. PLD, or Pixel Level Decorrelation, is a method of removing systematic noise from light curves using linear regression, with a design matrix constructed from a combination of pixel-level light curves. 

For more information about the `PLDCorrector`, please see the tutorial specifically on removing instrumental noise from *K2* and *TESS* light curves using PLD.

For *TESS*, the `PLDCorrector` works in a very similar way to the `RegressionCorrector`. The major difference between them is that `PLDCorrector` constructs its own design matrix, making it a streamlined, versatile tool to apply to any *TESS* or *K2* light curve.

Here, we perform PLD and diagnose the correction in just three lines. To make a more direct comparison to the `RegressionCorrector`, we pass in arguments to set the number of components to five (as in section 2), as well as remove the spline fit.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## 6. Should I use `RegressionCorrector` or `PLDCorrector`?&lt;/span&gt;

In addition to the corrector demonstrated in this tutorial, Lightkurve has a special case of &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; called &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`PLDCorrector`&lt;/span&gt;. PLD, or Pixel Level Decorrelation, is a method of removing systematic noise from light curves using linear regression, with a design matrix constructed from a combination of pixel-level light curves. 

For more information about the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`PLDCorrector`&lt;/span&gt;, please see the tutorial specifically on removing instrumental noise from &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*K2*&lt;/span&gt; and &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; light curves using PLD.

For &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt;, the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`PLDCorrector`&lt;/span&gt; works in a very similar way to the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt;. The major difference between them is that &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`PLDCorrector`&lt;/span&gt; constructs its own design matrix, making it a streamlined, versatile tool to apply to any &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; or &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*K2*&lt;/span&gt; light curve.

Here, we perform PLD and diagnose the correction in just three lines. To make a more direct comparison to the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt;, we pass in arguments to set the number of components to five (as in section 2), as well as remove the spline fit.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-72-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-72&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-72-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'zbTGkfTQRUAe'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-72-loc&quot; role=&quot;none&quot;&gt;
       9
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;6-should-i-use-regressioncorrector-or-pldcorrector&quot;&gt;
        &lt;a href=&quot;#6-should-i-use-regressioncorrector-or-pldcorrector&quot;&gt;
         None
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        In addition to the corrector demonstrated in this tutorial, Lightkurve has a special case of
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        called
        &lt;code&gt;
         PLDCorrector
        &lt;/code&gt;
        . PLD, or Pixel Level Decorrelation, is a method of removing systematic noise from light curves using linear regression, with a design matrix constructed from a combination of pixel-level light curves.
       &lt;/p&gt;
       &lt;p&gt;
        For more information about the
        &lt;code&gt;
         PLDCorrector
        &lt;/code&gt;
        , please see the tutorial specifically on removing instrumental noise from
        &lt;em&gt;
         K2
        &lt;/em&gt;
        and
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        light curves using PLD.
       &lt;/p&gt;
       &lt;p&gt;
        For
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        , the
        &lt;code&gt;
         PLDCorrector
        &lt;/code&gt;
        works in a very similar way to the
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        . The major difference between them is that
        &lt;code&gt;
         PLDCorrector
        &lt;/code&gt;
        constructs its own design matrix, making it a streamlined, versatile tool to apply to any
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        or
        &lt;em&gt;
         K2
        &lt;/em&gt;
        light curve.
       &lt;/p&gt;
       &lt;p&gt;
        Here, we perform PLD and diagnose the correction in just three lines. To make a more direct comparison to the
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        , we pass in arguments to set the number of components to five (as in section 2), as well as remove the spline fit.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 73 cell-73-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;73&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-73-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 73&quot; href=&quot;#73&quot; id=&quot;73&quot;&gt;
        73
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-73-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-73-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-73&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-73-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-73-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-73&quot; name=&quot;cell-73&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-73-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-73-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-73-source-label nb-source-label&quot; form=&quot;cell-73&quot; id=&quot;cell-73-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;pld = lk.PLDCorrector(tpf)
pld_corrected_lc = pld.correct(restore_trend=False, pca_components=5)
pld.diagnose();&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pld&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;PLDCorrector&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;tpf&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pld_corrected_lc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pld&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;correct&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;restore_trend&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot; title=&quot;Keyword.Constant&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pca_components&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pld&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diagnose&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-73-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-73&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-73-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-73-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-73-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 74 cell-74-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;74&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-74-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 74&quot; href=&quot;#74&quot; id=&quot;74&quot;&gt;
        74
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-74-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-74-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-74&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-74-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-74-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-74&quot; name=&quot;cell-74&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-74-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-74-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-74-source-label nb-source-label&quot; form=&quot;cell-74&quot; id=&quot;cell-74-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;And there we go!

Now let's compare the performance of these two corrections.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;And there we go!

Now let's compare the performance of these two corrections.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-74-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-74&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-74-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'gbdhv908S1If'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-74-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        And there we go!
       &lt;/p&gt;
       &lt;p&gt;
        Now let's compare the performance of these two corrections.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 75 cell-75-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;75&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-75-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 75&quot; href=&quot;#75&quot; id=&quot;75&quot;&gt;
        75
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-75-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-75-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-75&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-75-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-75-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-75&quot; name=&quot;cell-75&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-75-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-75-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-75-source-label nb-source-label&quot; form=&quot;cell-75&quot; id=&quot;cell-75-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;ax = corrected_ffi_lc.normalize().plot(label='RegressionCorrector')
pld_corrected_lc.normalize().plot(label='PLDCorrector', ax=ax);&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;corrected_ffi_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;normalize&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'RegressionCorrector'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pld_corrected_lc&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;normalize&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'PLDCorrector'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-75-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-75&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-75-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-75-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-75-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 76 cell-76-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;76&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-76-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 76&quot; href=&quot;#76&quot; id=&quot;76&quot;&gt;
        76
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-76-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-76-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-76&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-76-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-76-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-76&quot; name=&quot;cell-76&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-76-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-76-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-76-source-label nb-source-label&quot; form=&quot;cell-76&quot; id=&quot;cell-76-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;`PLDCorrector` offers an additional diagnostic plot, named `diagnose_masks`. This allows you to inspect the pixels that were used to create your design matrix.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`PLDCorrector`&lt;/span&gt; offers an additional diagnostic plot, named &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`diagnose_masks`&lt;/span&gt;. This allows you to inspect the pixels that were used to create your design matrix.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-76-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-76&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-76-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'M_G2hNyQTfej'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-76-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;code&gt;
         PLDCorrector
        &lt;/code&gt;
        offers an additional diagnostic plot, named
        &lt;code&gt;
         diagnose_masks
        &lt;/code&gt;
        . This allows you to inspect the pixels that were used to create your design matrix.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 77 cell-77-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;77&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-77-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 77&quot; href=&quot;#77&quot; id=&quot;77&quot;&gt;
        77
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-77-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-77-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-77&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-77-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-77-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-77&quot; name=&quot;cell-77&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-77-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-77-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-77-source-label nb-source-label&quot; form=&quot;cell-77&quot; id=&quot;cell-77-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;pld.diagnose_masks();&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;pld&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;diagnose_masks&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-77-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-77&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-77-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-77-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-77-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 78 cell-78-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;78&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-78-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 78&quot; href=&quot;#78&quot; id=&quot;78&quot;&gt;
        78
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-78-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-78-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-78&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-78-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-78-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-78&quot; name=&quot;cell-78&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-78-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-78-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-78-source-label nb-source-label&quot; form=&quot;cell-78&quot; id=&quot;cell-78-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;While it is more convenient to apply to light curves and generally works well with default parameters, the `PLDCorrector` is less flexible than the `RegressionCorrector`, which allows you to create your own custom design matrix. However, the `PLDCorrector` also allows you to create &quot;higher order&quot; PLD regressors by taking the products of existing pixel regressors, which improves the performance of corrections to *K2* data (see the paper by [Luger et al. 2016](https://arxiv.org/abs/1607.00524) for more information).

When considering which corrector to use, remember that `PLDCorrector` is minimal and designed to be effective at removing both background scattered light from *TESS* and motion noise from *K2*, while `RegressionCorrector` is flexible and gives you more control over the creation of the design matrix and the correction.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;While it is more convenient to apply to light curves and generally works well with default parameters, the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`PLDCorrector`&lt;/span&gt; is less flexible than the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt;, which allows you to create your own custom design matrix. However, the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`PLDCorrector`&lt;/span&gt; also allows you to create &quot;higher order&quot; PLD regressors by taking the products of existing pixel regressors, which improves the performance of corrections to &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*K2*&lt;/span&gt; data (see the paper by [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Luger et al. 2016&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://arxiv.org/abs/1607.00524&lt;/span&gt;) for more information).

When considering which corrector to use, remember that &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`PLDCorrector`&lt;/span&gt; is minimal and designed to be effective at removing both background scattered light from &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*TESS*&lt;/span&gt; and motion noise from &lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*K2*&lt;/span&gt;, while &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`RegressionCorrector`&lt;/span&gt; is flexible and gives you more control over the creation of the design matrix and the correction.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-78-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-78&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-78-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'WMJJIRYYT0Zl'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-78-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        While it is more convenient to apply to light curves and generally works well with default parameters, the
        &lt;code&gt;
         PLDCorrector
        &lt;/code&gt;
        is less flexible than the
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        , which allows you to create your own custom design matrix. However, the
        &lt;code&gt;
         PLDCorrector
        &lt;/code&gt;
        also allows you to create &quot;higher order&quot; PLD regressors by taking the products of existing pixel regressors, which improves the performance of corrections to
        &lt;em&gt;
         K2
        &lt;/em&gt;
        data (see the paper by
        &lt;a href=&quot;https://arxiv.org/abs/1607.00524&quot;&gt;
         Luger et al. 2016
        &lt;/a&gt;
        for more information).
       &lt;/p&gt;
       &lt;p&gt;
        When considering which corrector to use, remember that
        &lt;code&gt;
         PLDCorrector
        &lt;/code&gt;
        is minimal and designed to be effective at removing both background scattered light from
        &lt;em&gt;
         TESS
        &lt;/em&gt;
        and motion noise from
        &lt;em&gt;
         K2
        &lt;/em&gt;
        , while
        &lt;code&gt;
         RegressionCorrector
        &lt;/code&gt;
        is flexible and gives you more control over the creation of the design matrix and the correction.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 79 cell-79-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;79&quot; data-loc=&quot;5&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-79-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 79&quot; href=&quot;#79&quot; id=&quot;79&quot;&gt;
        79
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-79-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-79-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-79&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-79-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-79-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-79&quot; name=&quot;cell-79&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-79-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-79-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-79-source-label nb-source-label&quot; form=&quot;cell-79&quot; id=&quot;cell-79-source&quot; name=&quot;source&quot; readonly rows=&quot;5&quot;&gt;## About this Notebook

**Authors:** Christina Hedges (christinalouisehedges@gmail.com), Nicholas Saunders (nksaun@hawaii.edu), Geert Barentsen

**Updated On:** 2020-09-28&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## About this Notebook&lt;/span&gt;

&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Authors:**&lt;/span&gt; Christina Hedges (christinalouisehedges@gmail.com), Nicholas Saunders (nksaun@hawaii.edu), Geert Barentsen

&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Updated On:**&lt;/span&gt; 2020-09-28
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-79-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-79&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-79-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'aG4fgysD_Brp'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-79-loc&quot; role=&quot;none&quot;&gt;
       5
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;about-this-notebook&quot;&gt;
        &lt;a href=&quot;#about-this-notebook&quot;&gt;
         About this Notebook
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Authors:
        &lt;/strong&gt;
        Christina Hedges (
        &lt;a href=&quot;mailto:christinalouisehedges@gmail.com&quot;&gt;
         christinalouisehedges@gmail.com
        &lt;/a&gt;
        ), Nicholas Saunders (
        &lt;a href=&quot;mailto:nksaun@hawaii.edu&quot;&gt;
         nksaun@hawaii.edu
        &lt;/a&gt;
        ), Geert Barentsen
       &lt;/p&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Updated On:
        &lt;/strong&gt;
        2020-09-28
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 80 cell-80-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;80&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-80-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 80&quot; href=&quot;#80&quot; id=&quot;80&quot;&gt;
        80
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-80-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-80-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-80&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-80-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-80-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-80&quot; name=&quot;cell-80&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-80-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-80-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-80-source-label nb-source-label&quot; form=&quot;cell-80&quot; id=&quot;cell-80-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;# Citing Lightkurve and its Dependencies

If you use `lightkurve` or its dependencies for published research, please cite the authors. Click the buttons below to copy BibTeX entries to your clipboard.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gh&quot; title=&quot;Generic.Heading&quot;&gt;# Citing Lightkurve and its Dependencies&lt;/span&gt;

If you use &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`lightkurve`&lt;/span&gt; or its dependencies for published research, please cite the authors. Click the buttons below to copy BibTeX entries to your clipboard.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-80-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-80&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-80-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'MptPsdBQ_Qju'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-80-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h1 id=&quot;citing-lightkurve-and-its-dependencies&quot;&gt;
        &lt;a href=&quot;#citing-lightkurve-and-its-dependencies&quot;&gt;
         Citing Lightkurve and its Dependencies
        &lt;/a&gt;
       &lt;/h1&gt;
       &lt;p&gt;
        If you use
        &lt;code&gt;
         lightkurve
        &lt;/code&gt;
        or its dependencies for published research, please cite the authors. Click the buttons below to copy BibTeX entries to your clipboard.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 81 cell-81-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;81&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-81-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 81&quot; href=&quot;#81&quot; id=&quot;81&quot;&gt;
        81
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-81-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-81-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-81&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-81-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-81-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-81&quot; name=&quot;cell-81&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-81-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-81-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-81-source-label nb-source-label&quot; form=&quot;cell-81&quot; id=&quot;cell-81-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;lk.show_citation_instructions()&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lk&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;show_citation_instructions&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-81-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-81&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-81-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-81-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-81-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 82 cell-82-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;82&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-82-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 82&quot; href=&quot;#82&quot; id=&quot;82&quot;&gt;
        82
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-82-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-82-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-82&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-82-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-82-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-82&quot; name=&quot;cell-82&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-82-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-82-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-82-source-label nb-source-label&quot; form=&quot;cell-82&quot; id=&quot;cell-82-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;&amp;lt;img alt=&quot;Space Telescope Logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;/&amp;gt;&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;img style=&quot;float: right;&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; alt=&quot;Space Telescope Logo&quot; width=&quot;200px&quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-82-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-82&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-82-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'id': 'ZhdRVU3B_Zn2'}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-82-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;img alt=&quot;Space Telescope Logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;table class=&quot;nb-cells-footer&quot; hidden&gt;
    &lt;tbody&gt;
     &lt;tr class=&quot;total&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       all cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       82
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       149
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;code&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       code cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       82
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       149
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;markdown&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       markdown cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       82
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       149
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;dialog id=&quot;nb-metadata&quot;&gt;
    &lt;form method=&quot;dialog&quot;&gt;
     &lt;button formmethod=&quot;dialog&quot;&gt;
      Close
     &lt;/button&gt;
     {&quot;language_info&quot;: {&quot;name&quot;: &quot;python&quot;}}
    &lt;/form&gt;
   &lt;/dialog&gt;
   &lt;form aria-labelledby=&quot;nb-notebook-label&quot; id=&quot;notebook&quot; name=&quot;notebook&quot;&gt;
    &lt;label&gt;
     &lt;input id=&quot;nb-edit-mode&quot; name=&quot;edit&quot; type=&quot;checkbox&quot;&gt;
     edit mode
    &lt;/label&gt;
    &lt;button aria-controls=&quot;nb-metadata&quot; onclick=&quot;openDialog()&quot;&gt;
     metadata
    &lt;/button&gt;
    &lt;button type=&quot;submit&quot;&gt;
     Run
    &lt;/button&gt;
   &lt;/form&gt;
  &lt;/main&gt;
  &lt;section id=&quot;nb-dialogs&quot;&gt;
   &lt;details&gt;
    &lt;summary onclick=&quot;openDialogs()&quot;&gt;
     settings, help, &amp;amp; diagnostics
    &lt;/summary&gt;
   &lt;/details&gt;
  &lt;/section&gt;
  &lt;footer&gt;
   &lt;details class=&quot;log&quot;&gt;
    &lt;summary&gt;
     &lt;span&gt;
      activity log
     &lt;/span&gt;
    &lt;/summary&gt;
   &lt;/details&gt;
   &lt;table aria-live=&quot;polite&quot;&gt;
    &lt;tbody&gt;
     &lt;tr&gt;
      &lt;th hidden&gt;
       time
      &lt;/th&gt;
      &lt;td&gt;
       message
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;a accesskey=&quot;0&quot; href=&quot;#TOP&quot;&gt;
    skip to top
   &lt;/a&gt;
  &lt;/footer&gt;
 &lt;/body&gt;
&lt;/html&gt;
" width="100%"></iframe></div>
<div class="output_html rendered_html output_subarea"><iframe height="600" srcdoc="&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
 &lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; name=&quot;viewport&quot;&gt;
  &lt;title&gt;
   Notebook
  &lt;/title&gt;
  &lt;meta content=&quot;light&quot; name=&quot;color-scheme&quot;&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js&quot;&gt;
  &lt;/script&gt;
  &lt;style type=&quot;text/css&quot;&gt;
   /* # accessible css configurations

we define these high level variables to allow for configuration during use and testing.
we are not sure what the preferred default values are for these any accessible notebooks features.
the variables specify critical degrees of freedom in the notebook style.

## notebook interface specific css variables

*/

:root {
    --nb-focus-width: 3px;
    --nb-accent-color: auto;
    --nb-background-color-dark: #2b2a33;
    --nb-background-color-light: #FFFFFF;
    --nb-margin: 5%;
    --nb-font-size: 16px;
    --nb-font-family: serif;
    --nb-line-height: 1.5;
}

/* map css variables to css properties on the `body` elements.
this mapping turns out css variables into user interfaces. */

body {
    font-size: var(--nb-font-size);
    font-family: var(--nb-font-family);
    accent-color: var(--nb-accent-color);
    margin-left: var(--nb-margin);
    margin-right: var(--nb-margin);
    line-height: var(--nb-line-height);
    width: calc(100% - 2*var(--nb-margin));
}

/* ## notebook settings

the notebook settings interface connects configurable css features to the user.
we use dialog elements to represents an element that should be hidden by default.
it turns out there are two ways to layout `dialog` elements. 
they can be used as modals or block elements.
we extract this dual purpose to provide both configurations to the user.

*/

dialog form&gt;* {
    display: block;
}

#nb-dialogs details[open]~dialog {
    position: relative;
}


/* ## wcag accessibility guidelines as a feature

flexibility is the future of assistive interfaces.
it is not in the purvey of privileged developers and inaccessible systems to decide what priority accessibility is.
it is the fucking priority.

in this implementation, we want to satisfy broad user needs by making a lot of features configurable.
one configurable feature is the accessibility priority. 
experienced developers may need less assistive features as they spend more time with an interface.

### buttons sizes

WCAG 2.1 defines a huge stinking AAA hit size for buttons. its beautiful.

/* satisfy AAA 2.5.5 */

.wcag-aaa button,
.wcag-aaa input[type=checkbox] {
    min-height: 44px;
    min-width: 44px;
}

.wcag-aaa a {
    font-size: max(44px, var(--nb-font-size));
}


/* WCAG 2.2 clarified a AA button size that is used to style checkboxes and buttons. */
/* satisfy AA 2.5.8 minimum target requirement */
.wcag-aa button,
.wcag-aa input[type=checkbox] {
    min-height: 24px;
    min-width: 24px;
}

.wcag-aa a {
    font-size: max(24px, var(--nb-font-size));
}

/* ### native textareas for AAA priority.

our AAA priority choices often ensure that third party libraries can not compromise the accessibility of notebook.
the design decisions are focused native elements so that the assistive technology users have consistent expectations and outcomes.

*/

.wcag-a textarea[name=source],
.wcag-aa textarea[name=source],
.wcag-aaa textarea[name=source]~* {
    display: none;
}


/* ## notebook components layout */

td[role=&quot;none&quot;]:not([hidden]) {
    display: unset;
}

#cells tr.cell,
#cells tbody {
    display: flex;
    flex-direction: column;
}

[reversed]#cells tbody {
    flex-direction: column-reverse;
}

/* hide the visual output area when there are no outputs. 
assistive technologies will recieve an audible notification that there are not outputs. */

fieldset[data-outputs=&quot;0&quot;] {
    display: none;
}

/* ## modifications to html defaults 

### focus 

there nothing to be said about this topic that [sara soueidan](https://www.sarasoueidan.com/blog/focus-indicators/) hasn't said.
we start with her [universal focus recommendation](https://www.sarasoueidan.com/blog/focus-indicators/#a-%E2%80%98universal%E2%80%99-focus-indicator).

*/



.cell:focus-within,
:focus-visible {
    outline: max(var(--nb-focus-width), 1px) solid;
    box-shadow: 0 0 0 calc(2 * max(var(--nb-focus-width), 1px));
}


/* on firefox, the input and output become interactive when there is overflow. chrome fixed this recently find reference.*/
textarea[name=source],
.cell&gt;td&gt;details {
    overflow: auto;
    min-width: 0;
}

#nb-settings li::marker,
summary[inert]::marker {
    content: &quot;&quot;;
}

/* ### inheriting styles */

input,
select,
button {
    font-family: inherit;
    font-size: inherit;
}

textarea {
    font-family: monospace;
    font-size: inherit;
    line-height: inherit;
    overflow: auto;
    color: unset;
}

textarea[name=source] {
    box-sizing: border-box;
    width: 100%;
    resize: vertical;
}


/* align checkboxes with buttons */
input[type=&quot;checkbox&quot;] {
    vertical-align: middle;
}

/* ## custom class selectors */

#nb-dialogs details:not([open])~dialog:not([open]):not(:focus-within):not(:active),
/* legend:not(:focus-within):not(:active), */
details.log:not([open])+table,
.visually-hidden:not(:focus-within):not(:active) {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 1px;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}
  &lt;/style&gt;
  &lt;style id=&quot;nb-light-theme&quot; media=&quot;screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-light-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #0969da4a }
.c { color: #66707b } /* Comment */
.err { color: #a0111f } /* Error */
.k { color: #a0111f } /* Keyword */
.l { color: #702c00 } /* Literal */
.n { color: #622cbc } /* Name */
.o { color: #024c1a } /* Operator */
.p { color: #24292f } /* Punctuation */
.ch { color: #66707b } /* Comment.Hashbang */
.cm { color: #66707b } /* Comment.Multiline */
.cp { color: #66707b } /* Comment.Preproc */
.cpf { color: #66707b } /* Comment.PreprocFile */
.c1 { color: #66707b } /* Comment.Single */
.cs { color: #66707b } /* Comment.Special */
.gd { color: #023b95 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #a0111f } /* Generic.Error */
.gh { color: #023b95 } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #023b95 } /* Generic.Subheading */
.kc { color: #023b95 } /* Keyword.Constant */
.kd { color: #a0111f } /* Keyword.Declaration */
.kn { color: #a0111f } /* Keyword.Namespace */
.kp { color: #a0111f } /* Keyword.Pseudo */
.kr { color: #a0111f } /* Keyword.Reserved */
.kt { color: #a0111f } /* Keyword.Type */
.ld { color: #702c00 } /* Literal.Date */
.m { color: #702c00 } /* Literal.Number */
.s { color: #023b95 } /* Literal.String */
.na { color: #702c00 } /* Name.Attribute */
.nb { color: #702c00 } /* Name.Builtin */
.nc { color: #023b95 } /* Name.Class */
.no { color: #023b95 } /* Name.Constant */
.nd { color: #702c00 } /* Name.Decorator */
.ni { color: #024c1a } /* Name.Entity */
.ne { color: #622cbc } /* Name.Exception */
.nf { color: #023b95 } /* Name.Function */
.nl { color: #702c00 } /* Name.Label */
.nn { color: #24292f } /* Name.Namespace */
.nx { color: #622cbc } /* Name.Other */
.py { color: #023b95 } /* Name.Property */
.nt { color: #024c1a } /* Name.Tag */
.nv { color: #702c00 } /* Name.Variable */
.ow { color: #622cbc } /* Operator.Word */
.pm { color: #24292f } /* Punctuation.Marker */
.w { color: #24292f } /* Text.Whitespace */
.mb { color: #702c00 } /* Literal.Number.Bin */
.mf { color: #702c00 } /* Literal.Number.Float */
.mh { color: #702c00 } /* Literal.Number.Hex */
.mi { color: #702c00 } /* Literal.Number.Integer */
.mo { color: #702c00 } /* Literal.Number.Oct */
.sa { color: #023b95 } /* Literal.String.Affix */
.sb { color: #023b95 } /* Literal.String.Backtick */
.sc { color: #023b95 } /* Literal.String.Char */
.dl { color: #023b95 } /* Literal.String.Delimiter */
.sd { color: #023b95 } /* Literal.String.Doc */
.s2 { color: #023b95 } /* Literal.String.Double */
.se { color: #023b95 } /* Literal.String.Escape */
.sh { color: #023b95 } /* Literal.String.Heredoc */
.si { color: #023b95 } /* Literal.String.Interpol */
.sx { color: #023b95 } /* Literal.String.Other */
.sr { color: #023b95 } /* Literal.String.Regex */
.s1 { color: #023b95 } /* Literal.String.Single */
.ss { color: #023b95 } /* Literal.String.Symbol */
.bp { color: #702c00 } /* Name.Builtin.Pseudo */
.fm { color: #023b95 } /* Name.Function.Magic */
.vc { color: #702c00 } /* Name.Variable.Class */
.vg { color: #702c00 } /* Name.Variable.Global */
.vi { color: #702c00 } /* Name.Variable.Instance */
.vm { color: #702c00 } /* Name.Variable.Magic */
.il { color: #702c00 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;style id=&quot;nb-dark-theme&quot; media=&quot;not  screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-dark-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #58a6ff70 }
.c { color: #d9dee3 } /* Comment */
.err { color: #ff9492 } /* Error */
.k { color: #ff9492 } /* Keyword */
.l { color: #ffb757 } /* Literal */
.n { color: #dbb7ff } /* Name */
.o { color: #72f088 } /* Operator */
.p { color: #C9D1D9 } /* Punctuation */
.ch { color: #d9dee3 } /* Comment.Hashbang */
.cm { color: #d9dee3 } /* Comment.Multiline */
.cp { color: #d9dee3 } /* Comment.Preproc */
.cpf { color: #d9dee3 } /* Comment.PreprocFile */
.c1 { color: #d9dee3 } /* Comment.Single */
.cs { color: #d9dee3 } /* Comment.Special */
.gd { color: #91cbff } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #ff9492 } /* Generic.Error */
.gh { color: #91cbff } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #91cbff } /* Generic.Subheading */
.kc { color: #91cbff } /* Keyword.Constant */
.kd { color: #ff9492 } /* Keyword.Declaration */
.kn { color: #ff9492 } /* Keyword.Namespace */
.kp { color: #ff9492 } /* Keyword.Pseudo */
.kr { color: #ff9492 } /* Keyword.Reserved */
.kt { color: #ff9492 } /* Keyword.Type */
.ld { color: #ffb757 } /* Literal.Date */
.m { color: #ffb757 } /* Literal.Number */
.s { color: #91cbff } /* Literal.String */
.na { color: #ffb757 } /* Name.Attribute */
.nb { color: #ffb757 } /* Name.Builtin */
.nc { color: #91cbff } /* Name.Class */
.no { color: #91cbff } /* Name.Constant */
.nd { color: #ffb757 } /* Name.Decorator */
.ni { color: #72f088 } /* Name.Entity */
.ne { color: #dbb7ff } /* Name.Exception */
.nf { color: #91cbff } /* Name.Function */
.nl { color: #ffb757 } /* Name.Label */
.nn { color: #C9D1D9 } /* Name.Namespace */
.nx { color: #dbb7ff } /* Name.Other */
.py { color: #91cbff } /* Name.Property */
.nt { color: #72f088 } /* Name.Tag */
.nv { color: #ffb757 } /* Name.Variable */
.ow { color: #dbb7ff } /* Operator.Word */
.pm { color: #C9D1D9 } /* Punctuation.Marker */
.w { color: #C9D1D9 } /* Text.Whitespace */
.mb { color: #ffb757 } /* Literal.Number.Bin */
.mf { color: #ffb757 } /* Literal.Number.Float */
.mh { color: #ffb757 } /* Literal.Number.Hex */
.mi { color: #ffb757 } /* Literal.Number.Integer */
.mo { color: #ffb757 } /* Literal.Number.Oct */
.sa { color: #91cbff } /* Literal.String.Affix */
.sb { color: #91cbff } /* Literal.String.Backtick */
.sc { color: #91cbff } /* Literal.String.Char */
.dl { color: #91cbff } /* Literal.String.Delimiter */
.sd { color: #91cbff } /* Literal.String.Doc */
.s2 { color: #91cbff } /* Literal.String.Double */
.se { color: #91cbff } /* Literal.String.Escape */
.sh { color: #91cbff } /* Literal.String.Heredoc */
.si { color: #91cbff } /* Literal.String.Interpol */
.sx { color: #91cbff } /* Literal.String.Other */
.sr { color: #91cbff } /* Literal.String.Regex */
.s1 { color: #91cbff } /* Literal.String.Single */
.ss { color: #91cbff } /* Literal.String.Symbol */
.bp { color: #ffb757 } /* Name.Builtin.Pseudo */
.fm { color: #91cbff } /* Name.Function.Magic */
.vc { color: #ffb757 } /* Name.Variable.Class */
.vg { color: #ffb757 } /* Name.Variable.Global */
.vi { color: #ffb757 } /* Name.Variable.Instance */
.vm { color: #ffb757 } /* Name.Variable.Magic */
.il { color: #ffb757 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;!-- Load mathjax --&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe&quot;&gt;
  &lt;/script&gt;
  &lt;!-- MathJax configuration --&gt;
  &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
   init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: &quot;AMS&quot;,
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], [&quot;\\(&quot;,&quot;\\)&quot;] ],
                    displayMath: [ ['$$','$$'], [&quot;\\[&quot;,&quot;\\]&quot;] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue([&quot;Typeset&quot;, MathJax.Hub]);
        }
    }
    init_mathjax();
  &lt;/script&gt;
  &lt;!-- End of mathjax configuration --&gt;
  &lt;script type=&quot;module&quot;&gt;
   document.addEventListener(&quot;DOMContentLoaded&quot;, async () =&gt; {
    const diagrams = document.querySelectorAll(&quot;.jp-Mermaid &gt; pre.mermaid&quot;);
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import(&quot;https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.5.0/mermaid.esm.min.mjs&quot;)).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue(&quot;--jp-ui-font-family&quot;),
      theme: document.querySelector(&quot;body[data-jp-theme-light='true']&quot;)
        ? &quot;default&quot;
        : &quot;dark&quot;,
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement(&quot;img&quot;);
      const doc = parser.parseFromString(svg, &quot;image/svg+xml&quot;);
      const svgEl = doc.querySelector(&quot;svg&quot;);
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector(&quot;title&quot;);
      const firstDesc = doc.querySelector(&quot;desc&quot;);

      img.setAttribute(&quot;src&quot;, `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute(&quot;alt&quot;, firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement(&quot;figcaption&quot;);
        caption.className = &quot;sr-only&quot;;
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = &quot;&quot;;
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement(&quot;details&quot;);
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement(&quot;summary&quot;);
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement(&quot;pre&quot;);
      const code = document.createElement(&quot;code&quot;);
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement(&quot;pre&quot;);
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement(&quot;div&quot;);
      el.style.visibility = &quot;hidden&quot;;
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        const { svg } = await mermaid.render(id, raw, el);
        results = makeMermaidImage(svg);
        output = document.createElement(&quot;figure&quot;);
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add(&quot;jp-mod-warning&quot;);
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add(&quot;jp-RenderedMermaid&quot;);
      parent.appendChild(output);
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
  &lt;/script&gt;
  &lt;style&gt;
   .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details &gt; pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary &gt; pre {
    display: inline-block;
    white-space: normal;
  }
  &lt;/style&gt;
  &lt;!-- End of mermaid configuration --&gt;
 &lt;/head&gt;
 &lt;body class=&quot;wcag-aa&quot;&gt;
  &lt;header aria-label=&quot;site header&quot;&gt;
   &lt;a href=&quot;#1&quot; id=&quot;TOP&quot;&gt;
    skip to main content
   &lt;/a&gt;
  &lt;/header&gt;
  &lt;main aria-labelledby=&quot;nb-notebook-label&quot;&gt;
   &lt;section aria-labelledby=&quot;nb-toc&quot;&gt;
    &lt;details open&gt;
     &lt;summary id=&quot;toc&quot;&gt;
      &lt;span id=&quot;nb-toc&quot;&gt;
       table of contents
      &lt;/span&gt;
     &lt;/summary&gt;
     &lt;a id=&quot;nb-toc-start&quot;&gt;
     &lt;/a&gt;
     &lt;ol aria-labelledby=&quot;nb-toc&quot;&gt;
     &lt;/ol&gt;
     &lt;ol&gt;
      &lt;li&gt;
       &lt;a href=&quot;#cutout-of-the-tess-ffis-using-astrocut-and-astroquery&quot;&gt;
        Cutout of the TESS FFIs using Astrocut and Astroquery
       &lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;
         &lt;a href=&quot;#table-of-contents&quot;&gt;
          Table of Contents
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#import-statements&quot;&gt;
          Import Statements
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#get-coordinates-of-the-target-using-astroquery-catalogs&quot;&gt;
          Get Coordinates of the Target Using Astroquery Catalogs
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#query-which-sectors-are-available&quot;&gt;
          Query Which Sectors are Available
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#request-pixel-timeseries-cutout-from-tess-ffis&quot;&gt;
          Request pixel timeseries cutout from TESS FFIs
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#plot-the-first-image-of-the-time-series&quot;&gt;
          Plot the First Image of the Time Series
         &lt;/a&gt;
         &lt;ol&gt;
          &lt;li&gt;
           &lt;a href=&quot;#show-the-first-image-with-wcs-information&quot;&gt;
            Show the first image with WCS information
           &lt;/a&gt;
          &lt;/li&gt;
         &lt;/ol&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#create-a-light-curve-from-the-cutout&quot;&gt;
          Create a Light Curve from the Cutout
         &lt;/a&gt;
         &lt;ol&gt;
          &lt;li&gt;
           &lt;a href=&quot;#create-a-photometric-time-series-using-all-the-pixels-in-the-image&quot;&gt;
            Create a photometric time series using all the pixels in the image.
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#estimate-the-background&quot;&gt;
            Estimate the background
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#subtract-the-background-from-the-flux-time-series&quot;&gt;
            Subtract the background from the flux time series
           &lt;/a&gt;
          &lt;/li&gt;
         &lt;/ol&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#additional-resources&quot;&gt;
          Additional Resources
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#about-this-notebook&quot;&gt;
          About this Notebook
         &lt;/a&gt;
        &lt;/li&gt;
       &lt;/ol&gt;
      &lt;/li&gt;
     &lt;/ol&gt;
    &lt;/details&gt;
   &lt;/section&gt;
   &lt;table id=&quot;cells&quot; role=&quot;presentation&quot;&gt;
    &lt;tbody aria-labelledby=&quot;nb-notebook-label nb-cells-label&quot; role=&quot;list&quot;&gt;
     &lt;tr hidden&gt;
      &lt;th scope=&quot;col&quot;&gt;
       index
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       execution_count
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       cell_type
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       toolbar
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       started_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       completed_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       source
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       loc
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       metadata
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       outputs
      &lt;/th&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 1 cell-1-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;1&quot; data-loc=&quot;14&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;1&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-1-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 1&quot; href=&quot;#1&quot; id=&quot;1&quot;&gt;
        1
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-1-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-1-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-1&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-1-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-1-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-1&quot; name=&quot;cell-1&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-1-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-1-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-1-source-label nb-source-label&quot; form=&quot;cell-1&quot; id=&quot;cell-1-source&quot; name=&quot;source&quot; readonly rows=&quot;14&quot;&gt;&amp;lt;a id=&quot;title_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
# Cutout of the TESS FFIs using Astrocut and Astroquery

This notebook shows the user how to use the MAST programmatic interface to create a cutout of the small section of the TESS FFIs. For this example we will determine the RA and Dec for TIC 261105201. We then perform a query to determine which sectors contain this RA and Dec, peform a cutout of the FFI time series, open the resulting target pixel files, and plot the first image of each file with the WCS overlayed on the image. Finally we will create a light curve from the resulting image by creating a photometric aperture and summing the light in our pixels.  

This tutorial shows the users how to do the following: use `astroquery.catalogs` to query the TIC, use astroquery Tesscut to determine the number of sectors that contain our target and download a FFI cutout.


### Table of Contents 
  [Astroquery Search of the TIC](#catalog_ID) &amp;lt;br/&amp;gt; 
  [Tesscut to Perform FFI Cutout](#tesscut_ID) &amp;lt;br/&amp;gt;
  [Create Light Curve](#lightcurve) &amp;lt;br/&amp;gt;
  [Additional Resources](#resources_ID) &amp;lt;br/&amp;gt; 
  [About this Notebook](#about_ID) &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;title_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gh&quot; title=&quot;Generic.Heading&quot;&gt;# Cutout of the TESS FFIs using Astrocut and Astroquery&lt;/span&gt;

This notebook shows the user how to use the MAST programmatic interface to create a cutout of the small section of the TESS FFIs. For this example we will determine the RA and Dec for TIC 261105201. We then perform a query to determine which sectors contain this RA and Dec, peform a cutout of the FFI time series, open the resulting target pixel files, and plot the first image of each file with the WCS overlayed on the image. Finally we will create a light curve from the resulting image by creating a photometric aperture and summing the light in our pixels.  

This tutorial shows the users how to do the following: use &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`astroquery.catalogs`&lt;/span&gt; to query the TIC, use astroquery Tesscut to determine the number of sectors that contain our target and download a FFI cutout.


&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Table of Contents &lt;/span&gt;
  [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Astroquery Search of the TIC&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#catalog_ID&lt;/span&gt;) &amp;lt;br&amp;gt; 
  [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Tesscut to Perform FFI Cutout&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#tesscut_ID&lt;/span&gt;) &amp;lt;br&amp;gt;
  [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Create Light Curve&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#lightcurve&lt;/span&gt;) &amp;lt;br&amp;gt;
  [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Additional Resources&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#resources_ID&lt;/span&gt;) &amp;lt;br&amp;gt; 
  [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;About this Notebook&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#about_ID&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-1-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-1&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-1-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-1-loc&quot; role=&quot;none&quot;&gt;
       14
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;title_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h1 id=&quot;cutout-of-the-tess-ffis-using-astrocut-and-astroquery&quot;&gt;
        &lt;a href=&quot;#cutout-of-the-tess-ffis-using-astrocut-and-astroquery&quot;&gt;
         Cutout of the TESS FFIs using Astrocut and Astroquery
        &lt;/a&gt;
       &lt;/h1&gt;
       &lt;p&gt;
        This notebook shows the user how to use the MAST programmatic interface to create a cutout of the small section of the TESS FFIs. For this example we will determine the RA and Dec for TIC 261105201. We then perform a query to determine which sectors contain this RA and Dec, peform a cutout of the FFI time series, open the resulting target pixel files, and plot the first image of each file with the WCS overlayed on the image. Finally we will create a light curve from the resulting image by creating a photometric aperture and summing the light in our pixels.
       &lt;/p&gt;
       &lt;p&gt;
        This tutorial shows the users how to do the following: use
        &lt;code&gt;
         astroquery.catalogs
        &lt;/code&gt;
        to query the TIC, use astroquery Tesscut to determine the number of sectors that contain our target and download a FFI cutout.
       &lt;/p&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#table-of-contents&quot;&gt;
         Table of Contents
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        &lt;a href=&quot;#catalog_ID&quot;&gt;
         Astroquery Search of the TIC
        &lt;/a&gt;
        &lt;br&gt;
        &lt;a href=&quot;#tesscut_ID&quot;&gt;
         Tesscut to Perform FFI Cutout
        &lt;/a&gt;
        &lt;br&gt;
        &lt;a href=&quot;#lightcurve&quot;&gt;
         Create Light Curve
        &lt;/a&gt;
        &lt;br&gt;
        &lt;a href=&quot;#resources_ID&quot;&gt;
         Additional Resources
        &lt;/a&gt;
        &lt;br&gt;
        &lt;a href=&quot;#about_ID&quot;&gt;
         About this Notebook
        &lt;/a&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 2 cell-2-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;2&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;2&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-2-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 2&quot; href=&quot;#2&quot; id=&quot;2&quot;&gt;
        2
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-2-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-2-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-2&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-2-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-2-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-2&quot; name=&quot;cell-2&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-2-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-2-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-2-source-label nb-source-label&quot; form=&quot;cell-2&quot; id=&quot;cell-2-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;***&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;***
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-2-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-2&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-2-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-2-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 3 cell-3-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;3&quot; data-loc=&quot;9&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;3&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-3-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 3&quot; href=&quot;#3&quot; id=&quot;3&quot;&gt;
        3
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-3-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-3-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-3&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-3-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-3-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-3&quot; name=&quot;cell-3&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-3-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-3-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-3-source-label nb-source-label&quot; form=&quot;cell-3&quot; id=&quot;cell-3-source&quot; name=&quot;source&quot; readonly rows=&quot;9&quot;&gt;## Import Statements
&amp;lt;a id=&quot;imports_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;

We start with a few import statements.
- *numpy* to handle array functions
- *astropy.io fits* for accessing FITS files
- *astropy.wcs WCS* to interpret the World Coordinate Systems
- *matplotlib.pyplot* for plotting the data
- *astroquery.mast* for the catalogs and for tesscut.
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Import Statements&lt;/span&gt;
&amp;lt;a id=&quot;imports_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;

We start with a few import statements.
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*numpy*&lt;/span&gt; to handle array functions
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*astropy.io fits*&lt;/span&gt; for accessing FITS files
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*astropy.wcs WCS*&lt;/span&gt; to interpret the World Coordinate Systems
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*matplotlib.pyplot*&lt;/span&gt; for plotting the data
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ge&quot; title=&quot;Generic.Emph&quot;&gt;*astroquery.mast*&lt;/span&gt; for the catalogs and for tesscut.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-3-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-3&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-3-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-3-loc&quot; role=&quot;none&quot;&gt;
       9
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;import-statements&quot;&gt;
        &lt;a href=&quot;#import-statements&quot;&gt;
         Import Statements
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;a id=&quot;imports_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;p&gt;
        We start with a few import statements.
       &lt;/p&gt;
       &lt;ul&gt;
        &lt;li&gt;
         &lt;em&gt;
          numpy
         &lt;/em&gt;
         to handle array functions
        &lt;/li&gt;
        &lt;li&gt;
         &lt;em&gt;
          &lt;a href=&quot;http://astropy.io&quot;&gt;
           astropy.io
          &lt;/a&gt;
          fits
         &lt;/em&gt;
         for accessing FITS files
        &lt;/li&gt;
        &lt;li&gt;
         &lt;em&gt;
          astropy.wcs WCS
         &lt;/em&gt;
         to interpret the World Coordinate Systems
        &lt;/li&gt;
        &lt;li&gt;
         &lt;em&gt;
          matplotlib.pyplot
         &lt;/em&gt;
         for plotting the data
        &lt;/li&gt;
        &lt;li&gt;
         &lt;em&gt;
          astroquery.mast
         &lt;/em&gt;
         for the catalogs and for tesscut.
        &lt;/li&gt;
       &lt;/ul&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 4 cell-4-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;4&quot; data-loc=&quot;9&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;4&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-4-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 4&quot; href=&quot;#4&quot; id=&quot;4&quot;&gt;
        4
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-4-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-4-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-4&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-4-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-4-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-4&quot; name=&quot;cell-4&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-4-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-4-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-4-source-label nb-source-label&quot; form=&quot;cell-4&quot; id=&quot;cell-4-source&quot; name=&quot;source&quot; readonly rows=&quot;9&quot;&gt;import numpy as np
from astroquery.mast import Catalogs
from astroquery.mast import Tesscut
from astropy.coordinates import SkyCoord
from astropy.wcs import WCS
from astropy.io import fits
import matplotlib.pyplot as plt

%matplotlib inline&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astroquery.mast&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Catalogs&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astroquery.mast&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Tesscut&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astropy.coordinates&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;SkyCoord&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astropy.wcs&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;WCS&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astropy.io&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;inline&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-4-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-4&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-4-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-4-loc&quot; role=&quot;none&quot;&gt;
       9
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-4-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 5 cell-5-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;5&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;5&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-5-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 5&quot; href=&quot;#5&quot; id=&quot;5&quot;&gt;
        5
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-5-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-5-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-5&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-5-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-5-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-5&quot; name=&quot;cell-5&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-5-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-5-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-5-source-label nb-source-label&quot; form=&quot;cell-5&quot; id=&quot;cell-5-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;***&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;***
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-5-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-5&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-5-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-5-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 6 cell-6-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;6&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;6&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-6-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 6&quot; href=&quot;#6&quot; id=&quot;6&quot;&gt;
        6
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-6-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-6-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-6&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-6-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-6-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-6&quot; name=&quot;cell-6&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-6-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-6-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-6-source-label nb-source-label&quot; form=&quot;cell-6&quot; id=&quot;cell-6-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;&amp;lt;a id=&quot;catalog_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
## Get Coordinates of the Target Using Astroquery Catalogs

Here we do a cone search using `Catalogs.query_object` on the TIC catalog around TIC ID = 261105201. The advantage of doing this (instead of a directly criteria query on the Tess Input Catalog) is that it gives us the nearby stars as well as the star we are looking for. The resulting table is sorted by distance from the requested object. We print out the ID and a few other TIC quantities to ensure we found the star we were looking for. &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;catalog_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Get Coordinates of the Target Using Astroquery Catalogs&lt;/span&gt;

Here we do a cone search using &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`Catalogs.query_object`&lt;/span&gt; on the TIC catalog around TIC ID = 261105201. The advantage of doing this (instead of a directly criteria query on the Tess Input Catalog) is that it gives us the nearby stars as well as the star we are looking for. The resulting table is sorted by distance from the requested object. We print out the ID and a few other TIC quantities to ensure we found the star we were looking for. 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-6-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-6&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-6-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-6-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;catalog_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;get-coordinates-of-the-target-using-astroquery-catalogs&quot;&gt;
        &lt;a href=&quot;#get-coordinates-of-the-target-using-astroquery-catalogs&quot;&gt;
         Get Coordinates of the Target Using Astroquery Catalogs
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Here we do a cone search using
        &lt;code&gt;
         Catalogs.query_object
        &lt;/code&gt;
        on the TIC catalog around TIC ID = 261105201. The advantage of doing this (instead of a directly criteria query on the Tess Input Catalog) is that it gives us the nearby stars as well as the star we are looking for. The resulting table is sorted by distance from the requested object. We print out the ID and a few other TIC quantities to ensure we found the star we were looking for.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 7 cell-7-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;7&quot; data-loc=&quot;11&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;7&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-7-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 7&quot; href=&quot;#7&quot; id=&quot;7&quot;&gt;
        7
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-7-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-7-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-7&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-7-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-7-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-7&quot; name=&quot;cell-7&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-7-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-7-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-7-source-label nb-source-label&quot; form=&quot;cell-7&quot; id=&quot;cell-7-source&quot; name=&quot;source&quot; readonly rows=&quot;11&quot;&gt;ticid = 261105201

starName = &quot;TIC &quot; + str(ticid)
radSearch = 4/60 #radius in degrees

catalogData = Catalogs.query_object(starName, radius = radSearch, catalog = &quot;TIC&quot;)
ra = catalogData[0]['ra']
dec = catalogData[0]['dec']

# Print out the first row in the table
print( catalogData[:5]['ID', 'Tmag', 'Jmag', 'ra', 'dec', 'objType'] )&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ticid&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;261105201&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;starName&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;TIC &quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ticid&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;radSearch&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;#radius in degrees&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Catalogs&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;query_object&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;starName&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;radius&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;radSearch&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalog&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;TIC&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ra&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'ra'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dec&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'dec'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Print out the first row in the table&lt;/span&gt;
&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'ID'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Tmag'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Jmag'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'ra'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'dec'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'objType'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-7-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-7&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-7-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-7-loc&quot; role=&quot;none&quot;&gt;
       11
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-7-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 8 cell-8-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;8&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;8&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-8-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 8&quot; href=&quot;#8&quot; id=&quot;8&quot;&gt;
        8
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-8-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-8-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-8&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-8-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-8-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-8&quot; name=&quot;cell-8&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-8-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-8-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-8-source-label nb-source-label&quot; form=&quot;cell-8&quot; id=&quot;cell-8-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;# Create a list of nearby bright stars (tess magnitude less than 14) from the rest of the data for later.
bright = catalogData['Tmag'] &amp;lt; 15

# Make it a list of Ra, Dec pairs of the bright ones. This is now a list of nearby bright stars.
nearbyStars = list( map( lambda x,y:[x,y], catalogData[bright]['ra'], catalogData[bright]['dec'] ) )
len(nearbyStars)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Create a list of nearby bright stars (tess magnitude less than 14) from the rest of the data for later.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Tmag'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;15&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Make it a list of Ra, Dec pairs of the bright ones. This is now a list of nearby bright stars.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nearbyStars&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'ra'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;catalogData&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bright&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'dec'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nearbyStars&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-8-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-8&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-8-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-8-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-8-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 9 cell-9-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;9&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;9&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-9-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 9&quot; href=&quot;#9&quot; id=&quot;9&quot;&gt;
        9
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-9-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-9-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-9&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-9-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-9-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-9&quot; name=&quot;cell-9&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-9-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-9-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-9-source-label nb-source-label&quot; form=&quot;cell-9&quot; id=&quot;cell-9-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;***&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;***
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-9-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-9&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-9-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-9-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 10 cell-10-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;10&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-10-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 10&quot; href=&quot;#10&quot; id=&quot;10&quot;&gt;
        10
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-10-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-10-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-10&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-10-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-10-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-10&quot; name=&quot;cell-10&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-10-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-10-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-10-source-label nb-source-label&quot; form=&quot;cell-10&quot; id=&quot;cell-10-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Query Which Sectors are Available
&amp;lt;a id=&quot;catalog_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
Using the TESS sector information service, we make a request to determine which sectors/cameras/CCDs contain data for this target. Remember that there is a set of FFIs for each TESS sector and those are broken up into 4 cameras which each have 4 CCDs.  We will do this with a radius=0 cone search to find only those FFI sets that contain the star of interest. You can also make the query using a larger radius, which may be important if the star is near the edge of one of the CCDs.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Query Which Sectors are Available&lt;/span&gt;
&amp;lt;a id=&quot;catalog_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
Using the TESS sector information service, we make a request to determine which sectors/cameras/CCDs contain data for this target. Remember that there is a set of FFIs for each TESS sector and those are broken up into 4 cameras which each have 4 CCDs.  We will do this with a radius=0 cone search to find only those FFI sets that contain the star of interest. You can also make the query using a larger radius, which may be important if the star is near the edge of one of the CCDs.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-10-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-10&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-10-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-10-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;query-which-sectors-are-available&quot;&gt;
        &lt;a href=&quot;#query-which-sectors-are-available&quot;&gt;
         Query Which Sectors are Available
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;a id=&quot;catalog_ID&quot;&gt;
        &lt;/a&gt;
        Using the TESS sector information service, we make a request to determine which sectors/cameras/CCDs contain data for this target. Remember that there is a set of FFIs for each TESS sector and those are broken up into 4 cameras which each have 4 CCDs.  We will do this with a radius=0 cone search to find only those FFI sets that contain the star of interest. You can also make the query using a larger radius, which may be important if the star is near the edge of one of the CCDs.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 11 cell-11-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;11&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-11-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 11&quot; href=&quot;#11&quot; id=&quot;11&quot;&gt;
        11
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-11-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-11-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-11&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-11-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-11-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-11&quot; name=&quot;cell-11&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-11-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-11-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-11-source-label nb-source-label&quot; form=&quot;cell-11&quot; id=&quot;cell-11-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;coord = SkyCoord(ra, dec, unit = &quot;deg&quot;)

sectorTable = Tesscut.get_sectors(coordinates=coord)
print(sectorTable)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;coord&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;SkyCoord&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ra&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;unit&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;deg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sectorTable&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Tesscut&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;get_sectors&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;coordinates&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;coord&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sectorTable&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-11-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-11&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-11-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-11-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-11-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 12 cell-12-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;12&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-12-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 12&quot; href=&quot;#12&quot; id=&quot;12&quot;&gt;
        12
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-12-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-12-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-12&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-12-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-12-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-12&quot; name=&quot;cell-12&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-12-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-12-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-12-source-label nb-source-label&quot; form=&quot;cell-12&quot; id=&quot;cell-12-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;Wow! This target is well-observed by TESS.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Wow! This target is well-observed by TESS.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-12-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-12&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-12-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-12-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Wow! This target is well-observed by TESS.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 13 cell-13-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;13&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-13-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 13&quot; href=&quot;#13&quot; id=&quot;13&quot;&gt;
        13
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-13-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-13-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-13&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-13-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-13-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-13&quot; name=&quot;cell-13&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-13-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-13-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-13-source-label nb-source-label&quot; form=&quot;cell-13&quot; id=&quot;cell-13-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;***&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;***
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-13-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-13&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-13-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-13-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 14 cell-14-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;14&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-14-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 14&quot; href=&quot;#14&quot; id=&quot;14&quot;&gt;
        14
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-14-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-14-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-14&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-14-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-14-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-14&quot; name=&quot;cell-14&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-14-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-14-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-14-source-label nb-source-label&quot; form=&quot;cell-14&quot; id=&quot;cell-14-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;&amp;lt;a id=&quot;tesscut_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
## Request pixel timeseries cutout from TESS FFIs
Astrocut is the tool that runs the cutout service around the RA and Dec that were requested. It delivers a zipped file containing a cutout for each set of FFIs as listed above. It is also possible to request only one sector using the &quot;sector&quot; parameter.

Since 28 sectors of data is quite a lot, let's only get data from the first sector.
&amp;lt;br/&amp;gt;&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;tesscut_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Request pixel timeseries cutout from TESS FFIs&lt;/span&gt;
Astrocut is the tool that runs the cutout service around the RA and Dec that were requested. It delivers a zipped file containing a cutout for each set of FFIs as listed above. It is also possible to request only one sector using the &quot;sector&quot; parameter.

Since 28 sectors of data is quite a lot, let's only get data from the first sector.
&amp;lt;br&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-14-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-14&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-14-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-14-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;tesscut_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;request-pixel-timeseries-cutout-from-tess-ffis&quot;&gt;
        &lt;a href=&quot;#request-pixel-timeseries-cutout-from-tess-ffis&quot;&gt;
         Request pixel timeseries cutout from TESS FFIs
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Astrocut is the tool that runs the cutout service around the RA and Dec that were requested. It delivers a zipped file containing a cutout for each set of FFIs as listed above. It is also possible to request only one sector using the &quot;sector&quot; parameter.
       &lt;/p&gt;
       &lt;p&gt;
        Since 28 sectors of data is quite a lot, let's only get data from the first sector.
        &lt;br&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 15 cell-15-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;15&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-15-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 15&quot; href=&quot;#15&quot; id=&quot;15&quot;&gt;
        15
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-15-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-15-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-15&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-15-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-15-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-15&quot; name=&quot;cell-15&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-15-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-15-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-15-source-label nb-source-label&quot; form=&quot;cell-15&quot; id=&quot;cell-15-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;hdulist = Tesscut.get_cutouts(coordinates=coord, size=20, sector=1)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Tesscut&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;get_cutouts&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;coordinates&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;coord&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-15-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-15&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-15-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-15-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-15-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 16 cell-16-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;16&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-16-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 16&quot; href=&quot;#16&quot; id=&quot;16&quot;&gt;
        16
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-16-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-16-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-16&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-16-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-16-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-16&quot; name=&quot;cell-16&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-16-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-16-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-16-source-label nb-source-label&quot; form=&quot;cell-16&quot; id=&quot;cell-16-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;Notice that this returns a **list** of HDUlist objects, one for each of our files.  HDUlist objects are the same thing you get back as if you downloaded the file and then run the following on the file: 
`hdu =  astropy.io.fits.open(FITS_file_name)`&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Notice that this returns a &lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**list**&lt;/span&gt; of HDUlist objects, one for each of our files.  HDUlist objects are the same thing you get back as if you downloaded the file and then run the following on the file: 
&lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`hdu =  astropy.io.fits.open(FITS_file_name)`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-16-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-16&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-16-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-16-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        Notice that this returns a
        &lt;strong&gt;
         list
        &lt;/strong&gt;
        of HDUlist objects, one for each of our files.  HDUlist objects are the same thing you get back as if you downloaded the file and then run the following on the file:
        &lt;code&gt;
         hdu =  astropy.io.fits.open(FITS_file_name)
        &lt;/code&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 17 cell-17-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;17&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-17-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 17&quot; href=&quot;#17&quot; id=&quot;17&quot;&gt;
        17
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-17-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-17-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-17&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-17-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-17-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-17&quot; name=&quot;cell-17&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-17-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-17-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-17-source-label nb-source-label&quot; form=&quot;cell-17&quot; id=&quot;cell-17-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;hdulist[0].info()
hdulist[0][0].header['SECTOR']&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'SECTOR'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-17-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-17&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-17-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-17-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-17-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 18 cell-18-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;18&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-18-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 18&quot; href=&quot;#18&quot; id=&quot;18&quot;&gt;
        18
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-18-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-18-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-18&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-18-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-18-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-18&quot; name=&quot;cell-18&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-18-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-18-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-18-source-label nb-source-label&quot; form=&quot;cell-18&quot; id=&quot;cell-18-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;[Top of Page](#title_ID)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Top of Page&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#title_ID&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-18-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-18&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-18-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-18-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a href=&quot;#title_ID&quot;&gt;
         Top of Page
        &lt;/a&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 19 cell-19-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;19&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-19-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 19&quot; href=&quot;#19&quot; id=&quot;19&quot;&gt;
        19
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-19-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-19-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-19&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-19-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-19-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-19&quot; name=&quot;cell-19&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-19-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-19-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-19-source-label nb-source-label&quot; form=&quot;cell-19&quot; id=&quot;cell-19-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;***&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;***
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-19-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-19&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-19-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-19-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 20 cell-20-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;20&quot; data-loc=&quot;5&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-20-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 20&quot; href=&quot;#20&quot; id=&quot;20&quot;&gt;
        20
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-20-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-20-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-20&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-20-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-20-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-20&quot; name=&quot;cell-20&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-20-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-20-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-20-source-label nb-source-label&quot; form=&quot;cell-20&quot; id=&quot;cell-20-source&quot; name=&quot;source&quot; readonly rows=&quot;5&quot;&gt;&amp;lt;a id=&quot;plot_image&quot;&amp;gt;&amp;lt;/a&amp;gt;
## Plot the First Image of the Time Series
Here we show you some of the information found in the cutout. The format is identical to a TESS target pixel file. You should read through the target pixel file tutorial if you are not familiar with that file type.  

The pixel-level data is stored in the first PIXELS extension, including an array of the calibrated pixels for each time stamp. See the column called 'FLUX'. 
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;plot_image&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Plot the First Image of the Time Series&lt;/span&gt;
Here we show you some of the information found in the cutout. The format is identical to a TESS target pixel file. You should read through the target pixel file tutorial if you are not familiar with that file type.  

The pixel-level data is stored in the first PIXELS extension, including an array of the calibrated pixels for each time stamp. See the column called 'FLUX'. 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-20-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-20&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-20-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-20-loc&quot; role=&quot;none&quot;&gt;
       5
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;plot_image&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;plot-the-first-image-of-the-time-series&quot;&gt;
        &lt;a href=&quot;#plot-the-first-image-of-the-time-series&quot;&gt;
         Plot the First Image of the Time Series
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Here we show you some of the information found in the cutout. The format is identical to a TESS target pixel file. You should read through the target pixel file tutorial if you are not familiar with that file type.
       &lt;/p&gt;
       &lt;p&gt;
        The pixel-level data is stored in the first PIXELS extension, including an array of the calibrated pixels for each time stamp. See the column called 'FLUX'.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 21 cell-21-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;21&quot; data-loc=&quot;10&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-21-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 21&quot; href=&quot;#21&quot; id=&quot;21&quot;&gt;
        21
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-21-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-21-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-21&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-21-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-21-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-21&quot; name=&quot;cell-21&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-21-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-21-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-21-source-label nb-source-label&quot; form=&quot;cell-21&quot; id=&quot;cell-21-source&quot; name=&quot;source&quot; readonly rows=&quot;10&quot;&gt;# Define a function to simplify the plotting command that we do repeatedly.
def plot_cutout(image):
    &quot;&quot;&quot;
    Plot image and add grid lines.
    &quot;&quot;&quot;
    plt.imshow(image, origin = 'lower', cmap = plt.cm.YlGnBu_r, 
           vmax = np.percentile(image, 92),
           vmin = np.percentile(image, 5))

    plt.grid(axis = 'both',color = 'white', ls = 'solid')&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Define a function to simplify the plotting command that we do repeatedly.&lt;/span&gt;
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;plot_cutout&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Plot image and add grid lines.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;origin&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'lower'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cmap&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;YlGnBu_r&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; 
           &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vmax&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;percentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;92&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt;
           &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;vmin&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;percentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'both'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'white'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'solid'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-21-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-21&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-21-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-21-loc&quot; role=&quot;none&quot;&gt;
       10
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-21-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 22 cell-22-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;22&quot; data-loc=&quot;7&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-22-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 22&quot; href=&quot;#22&quot; id=&quot;22&quot;&gt;
        22
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-22-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-22-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-22&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-22-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-22-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-22&quot; name=&quot;cell-22&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-22-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-22-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-22-source-label nb-source-label&quot; form=&quot;cell-22&quot; id=&quot;cell-22-source&quot; name=&quot;source&quot; readonly rows=&quot;7&quot;&gt;hdu1 = hdulist[0]
firstImage = hdu1[1].data['FLUX'][0]

fig = plt.figure(figsize=(7, 7))
plot_cutout(firstImage)
plt.xlabel('Image Column',fontsize = 14)
plt.ylabel('Image Row',fontsize = 14)
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdulist&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;firstImage&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'FLUX'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot_cutout&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;firstImage&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Image Column'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fontsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Image Row'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fontsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-22-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-22&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-22-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-22-loc&quot; role=&quot;none&quot;&gt;
       7
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-22-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 23 cell-23-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;23&quot; data-loc=&quot;5&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-23-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 23&quot; href=&quot;#23&quot; id=&quot;23&quot;&gt;
        23
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-23-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-23-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-23&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-23-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-23-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-23&quot; name=&quot;cell-23&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-23-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-23-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-23-source-label nb-source-label&quot; form=&quot;cell-23&quot; id=&quot;cell-23-source&quot; name=&quot;source&quot; readonly rows=&quot;5&quot;&gt;### Show the first image with WCS information
We also add a WCS to the image and mark the requested star as well as nearby stars.
We use the WCS in the header to place a red dot on the image for the catalog position of the star on the figure as a demonstration of the WCS. The orange dots are the nearby stars found in the cone search done above. 

**Note. The WCS is based on the WCS stored in the FFI file for the central part of the time series and there can be some motion during a sector of observation.**&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Show the first image with WCS information&lt;/span&gt;
We also add a WCS to the image and mark the requested star as well as nearby stars.
We use the WCS in the header to place a red dot on the image for the catalog position of the star on the figure as a demonstration of the WCS. The orange dots are the nearby stars found in the cone search done above. 

&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Note. The WCS is based on the WCS stored in the FFI file for the central part of the time series and there can be some motion during a sector of observation.**&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-23-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-23&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-23-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-23-loc&quot; role=&quot;none&quot;&gt;
       5
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#show-the-first-image-with-wcs-information&quot;&gt;
         Show the first image with WCS information
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        We also add a WCS to the image and mark the requested star as well as nearby stars.
We use the WCS in the header to place a red dot on the image for the catalog position of the star on the figure as a demonstration of the WCS. The orange dots are the nearby stars found in the cone search done above.
       &lt;/p&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Note. The WCS is based on the WCS stored in the FFI file for the central part of the time series and there can be some motion during a sector of observation.
        &lt;/strong&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 24 cell-24-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;24&quot; data-loc=&quot;19&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-24-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 24&quot; href=&quot;#24&quot; id=&quot;24&quot;&gt;
        24
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-24-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-24-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-24&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-24-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-24-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-24&quot; name=&quot;cell-24&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-24-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-24-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-24-source-label nb-source-label&quot; form=&quot;cell-24&quot; id=&quot;cell-24-source&quot; name=&quot;source&quot; readonly rows=&quot;19&quot;&gt;firstImage = hdu1[1].data['FLUX'][0]

wcs = WCS(hdu1[2].header)

fig = plt.figure(figsize = (8, 8))
fig.add_subplot(111, projection = wcs)
plot_cutout(firstImage)

plt.xlabel('RA', fontsize = 12)
plt.ylabel('Dec', fontsize = 12)


starloc = wcs.all_world2pix([[ra,dec]],0)  #Second is origin
plt.scatter(starloc[0,0], starloc[0,1],s = 45,color = 'red')

# Plot nearby stars as well, which we created using our Catalog call above.
nearbyLoc = wcs.all_world2pix(nearbyStars[1:],0)
plt.scatter(nearbyLoc[1:, 0], nearbyLoc[1:, 1], 
            s = 25, color = 'orange')&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;firstImage&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'FLUX'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;wcs&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;WCS&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;add_subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;111&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;projection&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;wcs&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot_cutout&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;firstImage&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'RA'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fontsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Dec'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fontsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;starloc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;wcs&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;all_world2pix&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ra&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dec&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;#Second is origin&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;starloc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;starloc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'red'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Plot nearby stars as well, which we created using our Catalog call above.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nearbyLoc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;wcs&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;all_world2pix&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nearbyStars&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:],&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nearbyLoc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nearbyLoc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; 
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'orange'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-24-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-24&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-24-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-24-loc&quot; role=&quot;none&quot;&gt;
       19
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-24-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 25 cell-25-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;25&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-25-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 25&quot; href=&quot;#25&quot; id=&quot;25&quot;&gt;
        25
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-25-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-25-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-25&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-25-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-25-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-25&quot; name=&quot;cell-25&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-25-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-25-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-25-source-label nb-source-label&quot; form=&quot;cell-25&quot; id=&quot;cell-25-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;&amp;lt;a id=&quot;lightcurve&quot;&amp;gt;&amp;lt;/a&amp;gt;
## Create a Light Curve from the Cutout

We create two functions.  One to appply a photometric aperture to one image and the other to then apply that to all the images in the FLUX array.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;lightcurve&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Create a Light Curve from the Cutout&lt;/span&gt;

We create two functions.  One to appply a photometric aperture to one image and the other to then apply that to all the images in the FLUX array.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-25-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-25&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-25-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-25-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;lightcurve&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;create-a-light-curve-from-the-cutout&quot;&gt;
        &lt;a href=&quot;#create-a-light-curve-from-the-cutout&quot;&gt;
         Create a Light Curve from the Cutout
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        We create two functions.  One to appply a photometric aperture to one image and the other to then apply that to all the images in the FLUX array.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 26 cell-26-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;26&quot; data-loc=&quot;22&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-26-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 26&quot; href=&quot;#26&quot; id=&quot;26&quot;&gt;
        26
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-26-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-26-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-26&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-26-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-26-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-26&quot; name=&quot;cell-26&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-26-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-26-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-26-source-label nb-source-label&quot; form=&quot;cell-26&quot; id=&quot;cell-26-source&quot; name=&quot;source&quot; readonly rows=&quot;22&quot;&gt;def aperture_phot(image, aperture):
    &quot;&quot;&quot;
    Sum-up the pixels that are in the aperture for one image.
    image and aperture are 2D arrays that need to be the same size.

    aperture is a boolean array where True means to include the light of those pixels.
    &quot;&quot;&quot;
    flux = np.sum(image[aperture])

    return flux

def make_lc(flux_data, aperture):
    &quot;&quot;&quot;
    Apply the 2d aperture array to the and time series of 2D images. 
    Return the photometric series by summing over the pixels that are in the aperture.

    Aperture is a boolean array where True means it is in the desired aperture.
    &quot;&quot;&quot;

    flux = np.array(list (map (lambda x: aperture_phot(x, aperture), flux_data) ) )

    return flux
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;aperture_phot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Sum-up the pixels that are in the aperture for one image.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    image and aperture are 2D arrays that need to be the same size.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    aperture is a boolean array where True means to include the light of those pixels.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt;

&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;make_lc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux_data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Apply the 2d aperture array to the and time series of 2D images. &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Return the photometric series by summing over the pixels that are in the aperture.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Aperture is a boolean array where True means it is in the desired aperture.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture_phot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux_data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-26-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-26&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-26-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-26-loc&quot; role=&quot;none&quot;&gt;
       22
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-26-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 27 cell-27-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;27&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-27-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 27&quot; href=&quot;#27&quot; id=&quot;27&quot;&gt;
        27
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-27-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-27-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-27&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-27-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-27-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-27&quot; name=&quot;cell-27&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-27-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-27-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-27-source-label nb-source-label&quot; form=&quot;cell-27&quot; id=&quot;cell-27-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Create a photometric time series using all the pixels in the image.
The third extension indicates which pixels have data in your image. To use all the returned pixels, we set our 2D aperture array to be True for all those with a value of 1 in that image. &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Create a photometric time series using all the pixels in the image.&lt;/span&gt;
The third extension indicates which pixels have data in your image. To use all the returned pixels, we set our 2D aperture array to be True for all those with a value of 1 in that image. 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-27-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-27&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-27-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-27-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#create-a-photometric-time-series-using-all-the-pixels-in-the-image&quot;&gt;
         Create a photometric time series using all the pixels in the image.
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        The third extension indicates which pixels have data in your image. To use all the returned pixels, we set our 2D aperture array to be True for all those with a value of 1 in that image.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 28 cell-28-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;28&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-28-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 28&quot; href=&quot;#28&quot; id=&quot;28&quot;&gt;
        28
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-28-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-28-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-28&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-28-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-28-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-28&quot; name=&quot;cell-28&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-28-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-28-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-28-source-label nb-source-label&quot; form=&quot;cell-28&quot; id=&quot;cell-28-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;# Use all pixels in our aperture.
aperture = hdu1[2].data == 1

flux1 = make_lc(hdu1[1].data['FLUX'], aperture)
time1 = hdu1[1].data['TIME']

plt.figure(figsize = (11,5))
plt.plot(time1, flux1, 'k.-', lw = .5)
plt.xlim(1325,1342)
plt.xlabel('TIME (BTJD)')
plt.ylabel('Flux (e-/s)')
plt.title('Flux in Photometric Aperture')&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Use all pixels in our aperture.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;make_lc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'FLUX'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;time1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TIME'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;time1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'k.-'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lw&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1325&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1342&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TIME (BTJD)'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Flux (e-/s)'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Flux in Photometric Aperture'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-28-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-28&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-28-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-28-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-28-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 29 cell-29-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;29&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-29-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 29&quot; href=&quot;#29&quot; id=&quot;29&quot;&gt;
        29
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-29-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-29-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-29&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-29-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-29-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-29&quot; name=&quot;cell-29&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-29-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-29-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-29-source-label nb-source-label&quot; form=&quot;cell-29&quot; id=&quot;cell-29-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Estimate the background
No background subtraction has been performed on these images.  We estimate the background by using numpy's percentile function and selecting those pixels from the first image below the 5th percentile as a way of estimating the background.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Estimate the background&lt;/span&gt;
No background subtraction has been performed on these images.  We estimate the background by using numpy's percentile function and selecting those pixels from the first image below the 5th percentile as a way of estimating the background.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-29-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-29&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-29-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-29-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#estimate-the-background&quot;&gt;
         Estimate the background
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        No background subtraction has been performed on these images.  We estimate the background by using numpy's percentile function and selecting those pixels from the first image below the 5th percentile as a way of estimating the background.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 30 cell-30-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;30&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-30-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 30&quot; href=&quot;#30&quot; id=&quot;30&quot;&gt;
        30
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-30-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-30-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-30&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-30-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-30-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-30&quot; name=&quot;cell-30&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-30-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-30-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-30-source-label nb-source-label&quot; form=&quot;cell-30&quot; id=&quot;cell-30-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;# Plot the flux change of the dimmest pixels by using percentile.
bkgAperture = hdu1[1].data['FLUX'][0] &amp;lt; np.percentile(hdu1[1].data['FLUX'][0], 5)

bkgFlux1 = make_lc(hdu1[1].data['FLUX'], bkgAperture)
time1 = hdu1[1].data['TIME']

plt.figure(figsize = (11, 5))
plt.plot(time1, bkgFlux1, 'r.-', lw = .5)

plt.xlabel('TIME (BTJD)')
plt.ylabel('Estimate of Background')
plt.title('Background Flux')&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Plot the flux change of the dimmest pixels by using percentile.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkgAperture&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'FLUX'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;percentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'FLUX'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkgFlux1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;make_lc&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'FLUX'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkgAperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;time1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;hdu1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TIME'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;time1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkgFlux1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'r.-'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lw&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TIME (BTJD)'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Estimate of Background'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Background Flux'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-30-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-30&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-30-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-30-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-30-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 31 cell-31-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;31&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-31-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 31&quot; href=&quot;#31&quot; id=&quot;31&quot;&gt;
        31
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-31-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-31-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-31&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-31-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-31-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-31&quot; name=&quot;cell-31&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-31-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-31-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-31-source-label nb-source-label&quot; form=&quot;cell-31&quot; id=&quot;cell-31-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Subtract the background from the flux time series
Subtract this background after accounting for the number of pixels used to estimate the flux of the background relative to the entire image.  The final plot shows that the background subtraction removed much of unexpected variation.  This is likely an eclipsing binary system.  &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Subtract the background from the flux time series&lt;/span&gt;
Subtract this background after accounting for the number of pixels used to estimate the flux of the background relative to the entire image.  The final plot shows that the background subtraction removed much of unexpected variation.  This is likely an eclipsing binary system.  
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-31-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-31&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-31-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-31-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#subtract-the-background-from-the-flux-time-series&quot;&gt;
         Subtract the background from the flux time series
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        Subtract this background after accounting for the number of pixels used to estimate the flux of the background relative to the entire image.  The final plot shows that the background subtraction removed much of unexpected variation.  This is likely an eclipsing binary system.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 32 cell-32-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;32&quot; data-loc=&quot;8&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-32-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 32&quot; href=&quot;#32&quot; id=&quot;32&quot;&gt;
        32
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-32-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-32-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-32&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-32-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-32-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-32&quot; name=&quot;cell-32&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-32-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-32-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-32-source-label nb-source-label&quot; form=&quot;cell-32&quot; id=&quot;cell-32-source&quot; name=&quot;source&quot; readonly rows=&quot;8&quot;&gt;bkgSubFlux = flux1 - (bkgFlux1 * np.sum(aperture) / np.sum(bkgAperture) )

plt.figure(figsize = (11,5))
plt.plot(time1, bkgSubFlux,'.-k', lw = 0.5)

plt.xlabel('TIME (BTJD)')
plt.ylabel('Flux (e-/s)')
plt.title('Background Subtracted Flux')&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkgSubFlux&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkgFlux1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;aperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkgAperture&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;time1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;bkgSubFlux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'.-k'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lw&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TIME (BTJD)'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Flux (e-/s)'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Background Subtracted Flux'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-32-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-32&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-32-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-32-loc&quot; role=&quot;none&quot;&gt;
       8
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-32-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 33 cell-33-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;33&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-33-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 33&quot; href=&quot;#33&quot; id=&quot;33&quot;&gt;
        33
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-33-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-33-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-33&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-33-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-33-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-33&quot; name=&quot;cell-33&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-33-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-33-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-33-source-label nb-source-label&quot; form=&quot;cell-33&quot; id=&quot;cell-33-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;&amp;lt;a id=&quot;resources_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
## Additional Resources
[TESScut API Documentation](https://mast.stsci.edu/tesscut/)&amp;lt;br/&amp;gt;
[Astrocut Documentation](https://astrocut.readthedocs.io/en/latest/)&amp;lt;br/&amp;gt;
[TESS Homepage](https://archive.stsci.edu/tess)&amp;lt;br/&amp;gt;
[TESS Archive Manual](https://outerspace.stsci.edu/display/TESS/TESS+Archive+Manual)
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;resources_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Additional Resources&lt;/span&gt;
[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;TESScut API Documentation&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://mast.stsci.edu/tesscut/&lt;/span&gt;)&amp;lt;br&amp;gt;
[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Astrocut Documentation&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://astrocut.readthedocs.io/en/latest/&lt;/span&gt;)&amp;lt;br&amp;gt;
[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;TESS Homepage&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://archive.stsci.edu/tess&lt;/span&gt;)&amp;lt;br&amp;gt;
[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;TESS Archive Manual&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://outerspace.stsci.edu/display/TESS/TESS+Archive+Manual&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-33-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-33&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-33-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-33-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;resources_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;additional-resources&quot;&gt;
        &lt;a href=&quot;#additional-resources&quot;&gt;
         Additional Resources
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;a href=&quot;https://mast.stsci.edu/tesscut/&quot;&gt;
         TESScut API Documentation
        &lt;/a&gt;
        &lt;br&gt;
        &lt;a href=&quot;https://astrocut.readthedocs.io/en/latest/&quot;&gt;
         Astrocut Documentation
        &lt;/a&gt;
        &lt;br&gt;
        &lt;a href=&quot;https://archive.stsci.edu/tess&quot;&gt;
         TESS Homepage
        &lt;/a&gt;
        &lt;br&gt;
        &lt;a href=&quot;https://outerspace.stsci.edu/display/TESS/TESS+Archive+Manual&quot;&gt;
         TESS Archive Manual
        &lt;/a&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 34 cell-34-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;34&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-34-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 34&quot; href=&quot;#34&quot; id=&quot;34&quot;&gt;
        34
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-34-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-34-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-34&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-34-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-34-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-34&quot; name=&quot;cell-34&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-34-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-34-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-34-source-label nb-source-label&quot; form=&quot;cell-34&quot; id=&quot;cell-34-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;***&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;***
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-34-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-34&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-34-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-34-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 35 cell-35-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;35&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-35-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 35&quot; href=&quot;#35&quot; id=&quot;35&quot;&gt;
        35
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-35-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-35-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-35&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-35-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-35-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-35&quot; name=&quot;cell-35&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-35-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-35-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-35-source-label nb-source-label&quot; form=&quot;cell-35&quot; id=&quot;cell-35-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;&amp;lt;a id=&quot;about_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
## About this Notebook
**Author:** Susan E. Mullally, STScI Archive Scientist
&amp;lt;br/&amp;gt;**Last Updated:** 2023 November&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;about_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## About this Notebook&lt;/span&gt;
&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Author:**&lt;/span&gt; Susan E. Mullally, STScI Archive Scientist
&amp;lt;br&amp;gt;**Last Updated:** 2023 November
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-35-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-35&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-35-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-35-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;about_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;about-this-notebook&quot;&gt;
        &lt;a href=&quot;#about-this-notebook&quot;&gt;
         About this Notebook
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Author:
        &lt;/strong&gt;
        Susan E. Mullally, STScI Archive Scientist
        &lt;br&gt;
        &lt;strong&gt;
         Last Updated:
        &lt;/strong&gt;
        2023 November
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 36 cell-36-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;36&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-36-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 36&quot; href=&quot;#36&quot; id=&quot;36&quot;&gt;
        36
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-36-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-36-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-36&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-36-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-36-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-36&quot; name=&quot;cell-36&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-36-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-36-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-36-source-label nb-source-label&quot; form=&quot;cell-36&quot; id=&quot;cell-36-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;[Top of Page](#title_ID)
&amp;lt;img alt=&quot;STScI logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;/&amp;gt; &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Top of Page&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#title_ID&lt;/span&gt;)
&amp;lt;img style=&quot;float: right;&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; alt=&quot;STScI logo&quot; width=&quot;200px&quot;/&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-36-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-36&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-36-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-36-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a href=&quot;#title_ID&quot;&gt;
         Top of Page
        &lt;/a&gt;
        &lt;img alt=&quot;STScI logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;table class=&quot;nb-cells-footer&quot; hidden&gt;
    &lt;tbody&gt;
     &lt;tr class=&quot;total&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       all cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       36
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       164
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;code&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       code cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       36
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       164
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;markdown&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       markdown cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       36
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       164
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;dialog id=&quot;nb-metadata&quot;&gt;
    &lt;form method=&quot;dialog&quot;&gt;
     &lt;button formmethod=&quot;dialog&quot;&gt;
      Close
     &lt;/button&gt;
     {&quot;kernelspec&quot;: {&quot;display_name&quot;: &quot;Python 3 (ipykernel)&quot;, &quot;language&quot;: &quot;python&quot;, &quot;name&quot;: &quot;python3&quot;}, &quot;language_info&quot;: {&quot;codemirror_mode&quot;: {&quot;name&quot;: &quot;ipython&quot;, &quot;version&quot;: 3}, &quot;file_extension&quot;: &quot;.py&quot;, &quot;mimetype&quot;: &quot;text/x-python&quot;, &quot;name&quot;: &quot;python&quot;, &quot;nbconvert_exporter&quot;: &quot;python&quot;, &quot;pygments_lexer&quot;: &quot;ipython3&quot;, &quot;version&quot;: &quot;3.11.5&quot;}}
    &lt;/form&gt;
   &lt;/dialog&gt;
   &lt;form aria-labelledby=&quot;nb-notebook-label&quot; id=&quot;notebook&quot; name=&quot;notebook&quot;&gt;
    &lt;label&gt;
     &lt;input id=&quot;nb-edit-mode&quot; name=&quot;edit&quot; type=&quot;checkbox&quot;&gt;
     edit mode
    &lt;/label&gt;
    &lt;button aria-controls=&quot;nb-metadata&quot; onclick=&quot;openDialog()&quot;&gt;
     metadata
    &lt;/button&gt;
    &lt;button type=&quot;submit&quot;&gt;
     Run
    &lt;/button&gt;
   &lt;/form&gt;
  &lt;/main&gt;
  &lt;section id=&quot;nb-dialogs&quot;&gt;
   &lt;details&gt;
    &lt;summary onclick=&quot;openDialogs()&quot;&gt;
     settings, help, &amp;amp; diagnostics
    &lt;/summary&gt;
   &lt;/details&gt;
  &lt;/section&gt;
  &lt;footer&gt;
   &lt;details class=&quot;log&quot;&gt;
    &lt;summary&gt;
     &lt;span&gt;
      activity log
     &lt;/span&gt;
    &lt;/summary&gt;
   &lt;/details&gt;
   &lt;table aria-live=&quot;polite&quot;&gt;
    &lt;tbody&gt;
     &lt;tr&gt;
      &lt;th hidden&gt;
       time
      &lt;/th&gt;
      &lt;td&gt;
       message
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;a accesskey=&quot;0&quot; href=&quot;#TOP&quot;&gt;
    skip to top
   &lt;/a&gt;
  &lt;/footer&gt;
 &lt;/body&gt;
&lt;/html&gt;
" width="100%"></iframe></div>
<div class="output_html rendered_html output_subarea"><iframe height="600" srcdoc="&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
 &lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; name=&quot;viewport&quot;&gt;
  &lt;title&gt;
   Notebook
  &lt;/title&gt;
  &lt;meta content=&quot;light&quot; name=&quot;color-scheme&quot;&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js&quot;&gt;
  &lt;/script&gt;
  &lt;style type=&quot;text/css&quot;&gt;
   /* # accessible css configurations

we define these high level variables to allow for configuration during use and testing.
we are not sure what the preferred default values are for these any accessible notebooks features.
the variables specify critical degrees of freedom in the notebook style.

## notebook interface specific css variables

*/

:root {
    --nb-focus-width: 3px;
    --nb-accent-color: auto;
    --nb-background-color-dark: #2b2a33;
    --nb-background-color-light: #FFFFFF;
    --nb-margin: 5%;
    --nb-font-size: 16px;
    --nb-font-family: serif;
    --nb-line-height: 1.5;
}

/* map css variables to css properties on the `body` elements.
this mapping turns out css variables into user interfaces. */

body {
    font-size: var(--nb-font-size);
    font-family: var(--nb-font-family);
    accent-color: var(--nb-accent-color);
    margin-left: var(--nb-margin);
    margin-right: var(--nb-margin);
    line-height: var(--nb-line-height);
    width: calc(100% - 2*var(--nb-margin));
}

/* ## notebook settings

the notebook settings interface connects configurable css features to the user.
we use dialog elements to represents an element that should be hidden by default.
it turns out there are two ways to layout `dialog` elements. 
they can be used as modals or block elements.
we extract this dual purpose to provide both configurations to the user.

*/

dialog form&gt;* {
    display: block;
}

#nb-dialogs details[open]~dialog {
    position: relative;
}


/* ## wcag accessibility guidelines as a feature

flexibility is the future of assistive interfaces.
it is not in the purvey of privileged developers and inaccessible systems to decide what priority accessibility is.
it is the fucking priority.

in this implementation, we want to satisfy broad user needs by making a lot of features configurable.
one configurable feature is the accessibility priority. 
experienced developers may need less assistive features as they spend more time with an interface.

### buttons sizes

WCAG 2.1 defines a huge stinking AAA hit size for buttons. its beautiful.

/* satisfy AAA 2.5.5 */

.wcag-aaa button,
.wcag-aaa input[type=checkbox] {
    min-height: 44px;
    min-width: 44px;
}

.wcag-aaa a {
    font-size: max(44px, var(--nb-font-size));
}


/* WCAG 2.2 clarified a AA button size that is used to style checkboxes and buttons. */
/* satisfy AA 2.5.8 minimum target requirement */
.wcag-aa button,
.wcag-aa input[type=checkbox] {
    min-height: 24px;
    min-width: 24px;
}

.wcag-aa a {
    font-size: max(24px, var(--nb-font-size));
}

/* ### native textareas for AAA priority.

our AAA priority choices often ensure that third party libraries can not compromise the accessibility of notebook.
the design decisions are focused native elements so that the assistive technology users have consistent expectations and outcomes.

*/

.wcag-a textarea[name=source],
.wcag-aa textarea[name=source],
.wcag-aaa textarea[name=source]~* {
    display: none;
}


/* ## notebook components layout */

td[role=&quot;none&quot;]:not([hidden]) {
    display: unset;
}

#cells tr.cell,
#cells tbody {
    display: flex;
    flex-direction: column;
}

[reversed]#cells tbody {
    flex-direction: column-reverse;
}

/* hide the visual output area when there are no outputs. 
assistive technologies will recieve an audible notification that there are not outputs. */

fieldset[data-outputs=&quot;0&quot;] {
    display: none;
}

/* ## modifications to html defaults 

### focus 

there nothing to be said about this topic that [sara soueidan](https://www.sarasoueidan.com/blog/focus-indicators/) hasn't said.
we start with her [universal focus recommendation](https://www.sarasoueidan.com/blog/focus-indicators/#a-%E2%80%98universal%E2%80%99-focus-indicator).

*/



.cell:focus-within,
:focus-visible {
    outline: max(var(--nb-focus-width), 1px) solid;
    box-shadow: 0 0 0 calc(2 * max(var(--nb-focus-width), 1px));
}


/* on firefox, the input and output become interactive when there is overflow. chrome fixed this recently find reference.*/
textarea[name=source],
.cell&gt;td&gt;details {
    overflow: auto;
    min-width: 0;
}

#nb-settings li::marker,
summary[inert]::marker {
    content: &quot;&quot;;
}

/* ### inheriting styles */

input,
select,
button {
    font-family: inherit;
    font-size: inherit;
}

textarea {
    font-family: monospace;
    font-size: inherit;
    line-height: inherit;
    overflow: auto;
    color: unset;
}

textarea[name=source] {
    box-sizing: border-box;
    width: 100%;
    resize: vertical;
}


/* align checkboxes with buttons */
input[type=&quot;checkbox&quot;] {
    vertical-align: middle;
}

/* ## custom class selectors */

#nb-dialogs details:not([open])~dialog:not([open]):not(:focus-within):not(:active),
/* legend:not(:focus-within):not(:active), */
details.log:not([open])+table,
.visually-hidden:not(:focus-within):not(:active) {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 1px;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}
  &lt;/style&gt;
  &lt;style id=&quot;nb-light-theme&quot; media=&quot;screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-light-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #0969da4a }
.c { color: #66707b } /* Comment */
.err { color: #a0111f } /* Error */
.k { color: #a0111f } /* Keyword */
.l { color: #702c00 } /* Literal */
.n { color: #622cbc } /* Name */
.o { color: #024c1a } /* Operator */
.p { color: #24292f } /* Punctuation */
.ch { color: #66707b } /* Comment.Hashbang */
.cm { color: #66707b } /* Comment.Multiline */
.cp { color: #66707b } /* Comment.Preproc */
.cpf { color: #66707b } /* Comment.PreprocFile */
.c1 { color: #66707b } /* Comment.Single */
.cs { color: #66707b } /* Comment.Special */
.gd { color: #023b95 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #a0111f } /* Generic.Error */
.gh { color: #023b95 } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #023b95 } /* Generic.Subheading */
.kc { color: #023b95 } /* Keyword.Constant */
.kd { color: #a0111f } /* Keyword.Declaration */
.kn { color: #a0111f } /* Keyword.Namespace */
.kp { color: #a0111f } /* Keyword.Pseudo */
.kr { color: #a0111f } /* Keyword.Reserved */
.kt { color: #a0111f } /* Keyword.Type */
.ld { color: #702c00 } /* Literal.Date */
.m { color: #702c00 } /* Literal.Number */
.s { color: #023b95 } /* Literal.String */
.na { color: #702c00 } /* Name.Attribute */
.nb { color: #702c00 } /* Name.Builtin */
.nc { color: #023b95 } /* Name.Class */
.no { color: #023b95 } /* Name.Constant */
.nd { color: #702c00 } /* Name.Decorator */
.ni { color: #024c1a } /* Name.Entity */
.ne { color: #622cbc } /* Name.Exception */
.nf { color: #023b95 } /* Name.Function */
.nl { color: #702c00 } /* Name.Label */
.nn { color: #24292f } /* Name.Namespace */
.nx { color: #622cbc } /* Name.Other */
.py { color: #023b95 } /* Name.Property */
.nt { color: #024c1a } /* Name.Tag */
.nv { color: #702c00 } /* Name.Variable */
.ow { color: #622cbc } /* Operator.Word */
.pm { color: #24292f } /* Punctuation.Marker */
.w { color: #24292f } /* Text.Whitespace */
.mb { color: #702c00 } /* Literal.Number.Bin */
.mf { color: #702c00 } /* Literal.Number.Float */
.mh { color: #702c00 } /* Literal.Number.Hex */
.mi { color: #702c00 } /* Literal.Number.Integer */
.mo { color: #702c00 } /* Literal.Number.Oct */
.sa { color: #023b95 } /* Literal.String.Affix */
.sb { color: #023b95 } /* Literal.String.Backtick */
.sc { color: #023b95 } /* Literal.String.Char */
.dl { color: #023b95 } /* Literal.String.Delimiter */
.sd { color: #023b95 } /* Literal.String.Doc */
.s2 { color: #023b95 } /* Literal.String.Double */
.se { color: #023b95 } /* Literal.String.Escape */
.sh { color: #023b95 } /* Literal.String.Heredoc */
.si { color: #023b95 } /* Literal.String.Interpol */
.sx { color: #023b95 } /* Literal.String.Other */
.sr { color: #023b95 } /* Literal.String.Regex */
.s1 { color: #023b95 } /* Literal.String.Single */
.ss { color: #023b95 } /* Literal.String.Symbol */
.bp { color: #702c00 } /* Name.Builtin.Pseudo */
.fm { color: #023b95 } /* Name.Function.Magic */
.vc { color: #702c00 } /* Name.Variable.Class */
.vg { color: #702c00 } /* Name.Variable.Global */
.vi { color: #702c00 } /* Name.Variable.Instance */
.vm { color: #702c00 } /* Name.Variable.Magic */
.il { color: #702c00 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;style id=&quot;nb-dark-theme&quot; media=&quot;not  screen&quot; type=&quot;text/css&quot;&gt;
   /** accessible pygments github-dark-high-contrast generated by __main__**/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #58a6ff70 }
.c { color: #d9dee3 } /* Comment */
.err { color: #ff9492 } /* Error */
.k { color: #ff9492 } /* Keyword */
.l { color: #ffb757 } /* Literal */
.n { color: #dbb7ff } /* Name */
.o { color: #72f088 } /* Operator */
.p { color: #C9D1D9 } /* Punctuation */
.ch { color: #d9dee3 } /* Comment.Hashbang */
.cm { color: #d9dee3 } /* Comment.Multiline */
.cp { color: #d9dee3 } /* Comment.Preproc */
.cpf { color: #d9dee3 } /* Comment.PreprocFile */
.c1 { color: #d9dee3 } /* Comment.Single */
.cs { color: #d9dee3 } /* Comment.Special */
.gd { color: #91cbff } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #ff9492 } /* Generic.Error */
.gh { color: #91cbff } /* Generic.Heading */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #91cbff } /* Generic.Subheading */
.kc { color: #91cbff } /* Keyword.Constant */
.kd { color: #ff9492 } /* Keyword.Declaration */
.kn { color: #ff9492 } /* Keyword.Namespace */
.kp { color: #ff9492 } /* Keyword.Pseudo */
.kr { color: #ff9492 } /* Keyword.Reserved */
.kt { color: #ff9492 } /* Keyword.Type */
.ld { color: #ffb757 } /* Literal.Date */
.m { color: #ffb757 } /* Literal.Number */
.s { color: #91cbff } /* Literal.String */
.na { color: #ffb757 } /* Name.Attribute */
.nb { color: #ffb757 } /* Name.Builtin */
.nc { color: #91cbff } /* Name.Class */
.no { color: #91cbff } /* Name.Constant */
.nd { color: #ffb757 } /* Name.Decorator */
.ni { color: #72f088 } /* Name.Entity */
.ne { color: #dbb7ff } /* Name.Exception */
.nf { color: #91cbff } /* Name.Function */
.nl { color: #ffb757 } /* Name.Label */
.nn { color: #C9D1D9 } /* Name.Namespace */
.nx { color: #dbb7ff } /* Name.Other */
.py { color: #91cbff } /* Name.Property */
.nt { color: #72f088 } /* Name.Tag */
.nv { color: #ffb757 } /* Name.Variable */
.ow { color: #dbb7ff } /* Operator.Word */
.pm { color: #C9D1D9 } /* Punctuation.Marker */
.w { color: #C9D1D9 } /* Text.Whitespace */
.mb { color: #ffb757 } /* Literal.Number.Bin */
.mf { color: #ffb757 } /* Literal.Number.Float */
.mh { color: #ffb757 } /* Literal.Number.Hex */
.mi { color: #ffb757 } /* Literal.Number.Integer */
.mo { color: #ffb757 } /* Literal.Number.Oct */
.sa { color: #91cbff } /* Literal.String.Affix */
.sb { color: #91cbff } /* Literal.String.Backtick */
.sc { color: #91cbff } /* Literal.String.Char */
.dl { color: #91cbff } /* Literal.String.Delimiter */
.sd { color: #91cbff } /* Literal.String.Doc */
.s2 { color: #91cbff } /* Literal.String.Double */
.se { color: #91cbff } /* Literal.String.Escape */
.sh { color: #91cbff } /* Literal.String.Heredoc */
.si { color: #91cbff } /* Literal.String.Interpol */
.sx { color: #91cbff } /* Literal.String.Other */
.sr { color: #91cbff } /* Literal.String.Regex */
.s1 { color: #91cbff } /* Literal.String.Single */
.ss { color: #91cbff } /* Literal.String.Symbol */
.bp { color: #ffb757 } /* Name.Builtin.Pseudo */
.fm { color: #91cbff } /* Name.Function.Magic */
.vc { color: #ffb757 } /* Name.Variable.Class */
.vg { color: #ffb757 } /* Name.Variable.Global */
.vi { color: #ffb757 } /* Name.Variable.Instance */
.vm { color: #ffb757 } /* Name.Variable.Magic */
.il { color: #ffb757 } /* Literal.Number.Integer.Long */
  &lt;/style&gt;
  &lt;!-- Load mathjax --&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe&quot;&gt;
  &lt;/script&gt;
  &lt;!-- MathJax configuration --&gt;
  &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
   init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: &quot;AMS&quot;,
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], [&quot;\\(&quot;,&quot;\\)&quot;] ],
                    displayMath: [ ['$$','$$'], [&quot;\\[&quot;,&quot;\\]&quot;] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue([&quot;Typeset&quot;, MathJax.Hub]);
        }
    }
    init_mathjax();
  &lt;/script&gt;
  &lt;!-- End of mathjax configuration --&gt;
  &lt;script type=&quot;module&quot;&gt;
   document.addEventListener(&quot;DOMContentLoaded&quot;, async () =&gt; {
    const diagrams = document.querySelectorAll(&quot;.jp-Mermaid &gt; pre.mermaid&quot;);
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import(&quot;https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.5.0/mermaid.esm.min.mjs&quot;)).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue(&quot;--jp-ui-font-family&quot;),
      theme: document.querySelector(&quot;body[data-jp-theme-light='true']&quot;)
        ? &quot;default&quot;
        : &quot;dark&quot;,
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement(&quot;img&quot;);
      const doc = parser.parseFromString(svg, &quot;image/svg+xml&quot;);
      const svgEl = doc.querySelector(&quot;svg&quot;);
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector(&quot;title&quot;);
      const firstDesc = doc.querySelector(&quot;desc&quot;);

      img.setAttribute(&quot;src&quot;, `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute(&quot;alt&quot;, firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement(&quot;figcaption&quot;);
        caption.className = &quot;sr-only&quot;;
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = &quot;&quot;;
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement(&quot;details&quot;);
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement(&quot;summary&quot;);
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement(&quot;pre&quot;);
      const code = document.createElement(&quot;code&quot;);
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement(&quot;pre&quot;);
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement(&quot;div&quot;);
      el.style.visibility = &quot;hidden&quot;;
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        const { svg } = await mermaid.render(id, raw, el);
        results = makeMermaidImage(svg);
        output = document.createElement(&quot;figure&quot;);
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add(&quot;jp-mod-warning&quot;);
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add(&quot;jp-RenderedMermaid&quot;);
      parent.appendChild(output);
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
  &lt;/script&gt;
  &lt;style&gt;
   .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details &gt; pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary &gt; pre {
    display: inline-block;
    white-space: normal;
  }
  &lt;/style&gt;
  &lt;!-- End of mermaid configuration --&gt;
 &lt;/head&gt;
 &lt;body class=&quot;wcag-aa&quot;&gt;
  &lt;header aria-label=&quot;site header&quot;&gt;
   &lt;a href=&quot;#1&quot; id=&quot;TOP&quot;&gt;
    skip to main content
   &lt;/a&gt;
  &lt;/header&gt;
  &lt;main aria-labelledby=&quot;nb-notebook-label&quot;&gt;
   &lt;section aria-labelledby=&quot;nb-toc&quot;&gt;
    &lt;details open&gt;
     &lt;summary id=&quot;toc&quot;&gt;
      &lt;span id=&quot;nb-toc&quot;&gt;
       table of contents
      &lt;/span&gt;
     &lt;/summary&gt;
     &lt;a id=&quot;nb-toc-start&quot;&gt;
     &lt;/a&gt;
     &lt;ol aria-labelledby=&quot;nb-toc&quot;&gt;
     &lt;/ol&gt;
     &lt;ol&gt;
      &lt;li&gt;
       &lt;a href=&quot;#retrieve-tess-data-validation-products-with-astroquery&quot;&gt;
        Retrieve TESS Data Validation Products with Astroquery
       &lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;
         &lt;a href=&quot;#import-statements&quot;&gt;
          Import Statements
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#use-astroquery-to-find-observations-of-l98-59&quot;&gt;
          Use Astroquery to find Observations of L98-59
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#use-astroquery-to-dowload-dv-products&quot;&gt;
          Use Astroquery to Dowload DV Products
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#download-complete&quot;&gt;
          Download Complete
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#examine-the-download-manifest&quot;&gt;
          Examine the Download Manifest
         &lt;/a&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#plot-the-dvt-file&quot;&gt;
          Plot the DVT File
         &lt;/a&gt;
         &lt;ol&gt;
          &lt;li&gt;
           &lt;a href=&quot;#plot-the-dv-median-detrended-time-series&quot;&gt;
            Plot the DV Median-Detrended Time Series
           &lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
           &lt;a href=&quot;#plot-folded-light-curve&quot;&gt;
            Plot Folded Light Curve
           &lt;/a&gt;
          &lt;/li&gt;
         &lt;/ol&gt;
        &lt;/li&gt;
        &lt;li&gt;
         &lt;a href=&quot;#about-this-notebook&quot;&gt;
          About this Notebook
         &lt;/a&gt;
        &lt;/li&gt;
       &lt;/ol&gt;
      &lt;/li&gt;
     &lt;/ol&gt;
    &lt;/details&gt;
   &lt;/section&gt;
   &lt;table id=&quot;cells&quot; role=&quot;presentation&quot;&gt;
    &lt;tbody aria-labelledby=&quot;nb-notebook-label nb-cells-label&quot; role=&quot;list&quot;&gt;
     &lt;tr hidden&gt;
      &lt;th scope=&quot;col&quot;&gt;
       index
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       execution_count
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       cell_type
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       toolbar
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       started_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       completed_at
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       source
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       loc
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       metadata
      &lt;/th&gt;
      &lt;th scope=&quot;col&quot;&gt;
       outputs
      &lt;/th&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 1 cell-1-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;1&quot; data-loc=&quot;21&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;1&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-1-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 1&quot; href=&quot;#1&quot; id=&quot;1&quot;&gt;
        1
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-1-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-1-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-1&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-1-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-1-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-1&quot; name=&quot;cell-1&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-1-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-1-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-1-source-label nb-source-label&quot; form=&quot;cell-1&quot; id=&quot;cell-1-source&quot; name=&quot;source&quot; readonly rows=&quot;21&quot;&gt;# Retrieve TESS Data Validation Products with Astroquery

In addition to producing light curves and target pixel files, TESS (Transiting Exoplanet Survey Satelite) searches the 2-minute light curve data for transiting exoplanets. The mission does the search on individual sectors. But it also does multi-sector searches where they stitch the time series from a range of sectors and then do a search.  For every star in a particular search that produces a significant transiting event, a set of Data Validation products are created. The set of products are:

- DV reports (pdf), one per star
- DV summaries (pdf), one per transit signal found
- DV mini-reports (pdf), one per star
- DV time series files (fits),  one per star, one extension per transit signal

In this tutorial we show how to use astroquery to request all of the DV files available for a star of interest (L98-59 in this case). We then open the DV time series file to plot the detrended light curves produced by the mission and also a folded light curve for each signal found by the mission.

Skills explored in this notebook:

- Retrieving TESS timeseries observations with astroquery
- Retrieving TESS Data Validation products with astroquery
- Reading in a DV FITS file with astropy.io.fits
- Plotting with Matplotlib

For more information about the DV time series files, see the notebook called &quot;beginner_how_to_use_dvt&quot;. 

For more information about TESS data products, go to the [TESS Archive Manual](https://outerspace.stsci.edu/display/TESS)
&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gh&quot; title=&quot;Generic.Heading&quot;&gt;# Retrieve TESS Data Validation Products with Astroquery&lt;/span&gt;

In addition to producing light curves and target pixel files, TESS (Transiting Exoplanet Survey Satelite) searches the 2-minute light curve data for transiting exoplanets. The mission does the search on individual sectors. But it also does multi-sector searches where they stitch the time series from a range of sectors and then do a search.  For every star in a particular search that produces a significant transiting event, a set of Data Validation products are created. The set of products are:

&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;DV reports (pdf), one per star
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;DV summaries (pdf), one per transit signal found
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;DV mini-reports (pdf), one per star
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;DV time series files (fits),  one per star, one extension per transit signal

In this tutorial we show how to use astroquery to request all of the DV files available for a star of interest (L98-59 in this case). We then open the DV time series file to plot the detrended light curves produced by the mission and also a folded light curve for each signal found by the mission.

Skills explored in this notebook:

&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Retrieving TESS timeseries observations with astroquery
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Retrieving TESS Data Validation products with astroquery
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Reading in a DV FITS file with astropy.io.fits
&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt; &lt;/span&gt;Plotting with Matplotlib

For more information about the DV time series files, see the notebook called &quot;beginner_how_to_use_dvt&quot;. 

For more information about TESS data products, go to the [&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;TESS Archive Manual&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;https://outerspace.stsci.edu/display/TESS&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-1-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-1&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-1-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-1-loc&quot; role=&quot;none&quot;&gt;
       21
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h1 id=&quot;retrieve-tess-data-validation-products-with-astroquery&quot;&gt;
        &lt;a href=&quot;#retrieve-tess-data-validation-products-with-astroquery&quot;&gt;
         Retrieve TESS Data Validation Products with Astroquery
        &lt;/a&gt;
       &lt;/h1&gt;
       &lt;p&gt;
        In addition to producing light curves and target pixel files, TESS (Transiting Exoplanet Survey Satelite) searches the 2-minute light curve data for transiting exoplanets. The mission does the search on individual sectors. But it also does multi-sector searches where they stitch the time series from a range of sectors and then do a search.  For every star in a particular search that produces a significant transiting event, a set of Data Validation products are created. The set of products are:
       &lt;/p&gt;
       &lt;ul&gt;
        &lt;li&gt;
         DV reports (pdf), one per star
        &lt;/li&gt;
        &lt;li&gt;
         DV summaries (pdf), one per transit signal found
        &lt;/li&gt;
        &lt;li&gt;
         DV mini-reports (pdf), one per star
        &lt;/li&gt;
        &lt;li&gt;
         DV time series files (fits),  one per star, one extension per transit signal
        &lt;/li&gt;
       &lt;/ul&gt;
       &lt;p&gt;
        In this tutorial we show how to use astroquery to request all of the DV files available for a star of interest (L98-59 in this case). We then open the DV time series file to plot the detrended light curves produced by the mission and also a folded light curve for each signal found by the mission.
       &lt;/p&gt;
       &lt;p&gt;
        Skills explored in this notebook:
       &lt;/p&gt;
       &lt;ul&gt;
        &lt;li&gt;
         Retrieving TESS timeseries observations with astroquery
        &lt;/li&gt;
        &lt;li&gt;
         Retrieving TESS Data Validation products with astroquery
        &lt;/li&gt;
        &lt;li&gt;
         Reading in a DV FITS file with astropy.io.fits
        &lt;/li&gt;
        &lt;li&gt;
         Plotting with Matplotlib
        &lt;/li&gt;
       &lt;/ul&gt;
       &lt;p&gt;
        For more information about the DV time series files, see the notebook called &quot;beginner_how_to_use_dvt&quot;.
       &lt;/p&gt;
       &lt;p&gt;
        For more information about TESS data products, go to the
        &lt;a href=&quot;https://outerspace.stsci.edu/display/TESS&quot;&gt;
         TESS Archive Manual
        &lt;/a&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 2 cell-2-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;2&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;2&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-2-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 2&quot; href=&quot;#2&quot; id=&quot;2&quot;&gt;
        2
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-2-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-2-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-2&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-2-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-2-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-2&quot; name=&quot;cell-2&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-2-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-2-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-2-source-label nb-source-label&quot; form=&quot;cell-2&quot; id=&quot;cell-2-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;---&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;---
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-2-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-2&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-2-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-2-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;hr&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 3 cell-3-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;3&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;3&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-3-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 3&quot; href=&quot;#3&quot; id=&quot;3&quot;&gt;
        3
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-3-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-3-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-3&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-3-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-3-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-3&quot; name=&quot;cell-3&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-3-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-3-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-3-source-label nb-source-label&quot; form=&quot;cell-3&quot; id=&quot;cell-3-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;## Import Statements&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Import Statements&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-3-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-3&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-3-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-3-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;import-statements&quot;&gt;
        &lt;a href=&quot;#import-statements&quot;&gt;
         Import Statements
        &lt;/a&gt;
       &lt;/h2&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 4 cell-4-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;4&quot; data-loc=&quot;7&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;4&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-4-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 4&quot; href=&quot;#4&quot; id=&quot;4&quot;&gt;
        4
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-4-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-4-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-4&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-4-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-4-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-4&quot; name=&quot;cell-4&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-4-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-4-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-4-source-label nb-source-label&quot; form=&quot;cell-4&quot; id=&quot;cell-4-source&quot; name=&quot;source&quot; readonly rows=&quot;7&quot;&gt;from astroquery.mast import Observations
from astroquery.mast import Catalogs
from astropy.io import fits
from astropy import table
import matplotlib.pyplot as plt
import numpy as np
from copy import deepcopy&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astroquery.mast&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Observations&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astroquery.mast&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Catalogs&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astropy.io&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;astropy&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;table&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot; title=&quot;Name.Namespace&quot;&gt;copy&lt;/span&gt; &lt;span class=&quot;kn&quot; title=&quot;Keyword.Namespace&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;deepcopy&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-4-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-4&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-4-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-4-loc&quot; role=&quot;none&quot;&gt;
       7
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-4-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 5 cell-5-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;5&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;5&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-5-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 5&quot; href=&quot;#5&quot; id=&quot;5&quot;&gt;
        5
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-5-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-5-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-5&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-5-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-5-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-5&quot; name=&quot;cell-5&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-5-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-5-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-5-source-label nb-source-label&quot; form=&quot;cell-5&quot; id=&quot;cell-5-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;## Use Astroquery to find Observations of L98-59
We begin by doing a cone search usig the `Observations.query_object` function and then filtering for time series observations made by TESS. This leaves us with just the TESS 2-minute cadence data observations. There are also many Sectors' worth of observations for this target, so to minimize how many we use for this tutorial, we will
only keep results from the first 13 Sectors.  For TESS observations, the Sector number is stored in the column
called `sequence_number`.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Use Astroquery to find Observations of L98-59&lt;/span&gt;
We begin by doing a cone search usig the &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`Observations.query_object`&lt;/span&gt; function and then filtering for time series observations made by TESS. This leaves us with just the TESS 2-minute cadence data observations. There are also many Sectors' worth of observations for this target, so to minimize how many we use for this tutorial, we will
only keep results from the first 13 Sectors.  For TESS observations, the Sector number is stored in the column
called &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`sequence_number`&lt;/span&gt;.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-5-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-5&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-5-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-5-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;use-astroquery-to-find-observations-of-l98-59&quot;&gt;
        &lt;a href=&quot;#use-astroquery-to-find-observations-of-l98-59&quot;&gt;
         Use Astroquery to find Observations of L98-59
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        We begin by doing a cone search usig the
        &lt;code&gt;
         Observations.query_object
        &lt;/code&gt;
        function and then filtering for time series observations made by TESS. This leaves us with just the TESS 2-minute cadence data observations. There are also many Sectors' worth of observations for this target, so to minimize how many we use for this tutorial, we will
only keep results from the first 13 Sectors.  For TESS observations, the Sector number is stored in the column
called
        &lt;code&gt;
         sequence_number
        &lt;/code&gt;
        .
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 6 cell-6-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;6&quot; data-loc=&quot;12&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;6&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-6-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 6&quot; href=&quot;#6&quot; id=&quot;6&quot;&gt;
        6
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-6-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-6-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-6&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-6-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-6-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-6&quot; name=&quot;cell-6&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-6-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-6-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-6-source-label nb-source-label&quot; form=&quot;cell-6&quot; id=&quot;cell-6-source&quot; name=&quot;source&quot; readonly rows=&quot;12&quot;&gt;star_name = &quot;L98-59&quot;

# This query returns all obserations across all missions centered on our target.
observations = Observations.query_object(star_name, radius = &quot;0 deg&quot;)
# Create a filter that will only pick out the observations we want: TESS timeseries missions from Sectors 13 and
# below.
obs_wanted = ((observations['dataproduct_type'] == 'timeseries') &amp;amp;
              (observations['obs_collection'] == 'TESS') &amp;amp;
             (observations['sequence_number'] &amp;lt;= 13))
# Print out a few columns to show what we have selected. Note that TESS multi-Sector observations are assigned
# a sequence_number based on the last Sector used in the range.
print(observations[obs_wanted]['obs_collection', 'project', 'obs_id', 'sequence_number'])&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;star_name&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;L98-59&quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# This query returns all obserations across all missions centered on our target.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;observations&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Observations&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;query_object&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;star_name&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;radius&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;0 deg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Create a filter that will only pick out the observations we want: TESS timeseries missions from Sectors 13 and&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# below.&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;obs_wanted&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;observations&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'dataproduct_type'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'timeseries'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;amp;&lt;/span&gt;
              &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;observations&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'obs_collection'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TESS'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;amp;&lt;/span&gt;
             &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;observations&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'sequence_number'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Print out a few columns to show what we have selected. Note that TESS multi-Sector observations are assigned&lt;/span&gt;
&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# a sequence_number based on the last Sector used in the range.&lt;/span&gt;
&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;observations&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;obs_wanted&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'obs_collection'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'project'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'obs_id'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'sequence_number'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-6-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-6&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-6-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'scrolled': True}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-6-loc&quot; role=&quot;none&quot;&gt;
       12
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-6-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 7 cell-7-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;7&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;7&quot; aria-describedby=&quot;nb-markdown-label nb-cell-label cell-7-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 7&quot; href=&quot;#7&quot; id=&quot;7&quot;&gt;
        7
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-7-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-7-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-7&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-7-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-7-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-7&quot; name=&quot;cell-7&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-7-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-7-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-7-source-label nb-source-label&quot; form=&quot;cell-7&quot; id=&quot;cell-7-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;## Use Astroquery to Dowload DV Products
Use `Observations.get_product_list` to get a list of data products associated with the observations of interest. Each individual observation is associated with several data products, only some of which are the DV products we are interested in. In this case we want those data products that have &quot;productSubGroupDescription&quot; set to either DVT, DVM, DVS or DVR.  

Next, we use `Observations.download_products` to download our selected data files. This function returns a manifest, a table that contains the local path to the files that are downloaded.

**Note:** If you keep all results, this will download 115 files, which are roughly 1 GB. This is slightly excessive for a Notebook, so we're artificially selecting a set of ten files that contain our file of interest. You should not do this in your own search.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Use Astroquery to Dowload DV Products&lt;/span&gt;
Use &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`Observations.get_product_list`&lt;/span&gt; to get a list of data products associated with the observations of interest. Each individual observation is associated with several data products, only some of which are the DV products we are interested in. In this case we want those data products that have &quot;productSubGroupDescription&quot; set to either DVT, DVM, DVS or DVR.  

Next, we use &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`Observations.download_products`&lt;/span&gt; to download our selected data files. This function returns a manifest, a table that contains the local path to the files that are downloaded.

&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Note:**&lt;/span&gt; If you keep all results, this will download 115 files, which are roughly 1 GB. This is slightly excessive for a Notebook, so we're artificially selecting a set of ten files that contain our file of interest. You should not do this in your own search.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-7-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-7&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-7-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-7-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;use-astroquery-to-dowload-dv-products&quot;&gt;
        &lt;a href=&quot;#use-astroquery-to-dowload-dv-products&quot;&gt;
         Use Astroquery to Dowload DV Products
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        Use
        &lt;code&gt;
         Observations.get_product_list
        &lt;/code&gt;
        to get a list of data products associated with the observations of interest. Each individual observation is associated with several data products, only some of which are the DV products we are interested in. In this case we want those data products that have &quot;productSubGroupDescription&quot; set to either DVT, DVM, DVS or DVR.
       &lt;/p&gt;
       &lt;p&gt;
        Next, we use
        &lt;code&gt;
         Observations.download_products
        &lt;/code&gt;
        to download our selected data files. This function returns a manifest, a table that contains the local path to the files that are downloaded.
       &lt;/p&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Note:
        &lt;/strong&gt;
        If you keep all results, this will download 115 files, which are roughly 1 GB. This is slightly excessive for a Notebook, so we're artificially selecting a set of ten files that contain our file of interest. You should not do this in your own search.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 8 cell-8-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;8&quot; data-loc=&quot;11&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;8&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-8-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 8&quot; href=&quot;#8&quot; id=&quot;8&quot;&gt;
        8
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-8-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-8-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-8&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-8-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-8-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-8&quot; name=&quot;cell-8&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-8-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-8-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-8-source-label nb-source-label&quot; form=&quot;cell-8&quot; id=&quot;cell-8-source&quot; name=&quot;source&quot; readonly rows=&quot;11&quot;&gt;data_products = Observations.get_product_list(observations[obs_wanted])
products_wanted = Observations.filter_products(data_products, 
                                    productSubGroupDescription=[&quot;DVT&quot;,&quot;DVM&quot;,&quot;DVS&quot;,&quot;DVR&quot;])

# Keep ten results from the list for smaller download size
products_wanted.sort('obsID')
products_wanted = products_wanted[-10:]


print(products_wanted[&quot;productFilename&quot;])
manifest = Observations.download_products(products_wanted)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data_products&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Observations&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;get_product_list&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;observations&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;obs_wanted&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;products_wanted&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Observations&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;filter_products&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data_products&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; 
                                    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;productSubGroupDescription&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;DVT&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;DVM&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;DVS&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;DVR&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Keep ten results from the list for smaller download size&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;products_wanted&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'obsID'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;products_wanted&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;products_wanted&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:]&lt;/span&gt;


&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;products_wanted&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;productFilename&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;manifest&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Observations&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;download_products&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;products_wanted&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-8-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-8&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-8-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-8-loc&quot; role=&quot;none&quot;&gt;
       11
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-8-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 9 cell-9-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;9&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a accesskey=&quot;9&quot; aria-describedby=&quot;nb-code-label nb-cell-label cell-9-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 9&quot; href=&quot;#9&quot; id=&quot;9&quot;&gt;
        9
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-9-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-9-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-9&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-9-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-9-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-9&quot; name=&quot;cell-9&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-9-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-9-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-9-source-label nb-source-label&quot; form=&quot;cell-9&quot; id=&quot;cell-9-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;products_wanted['size']/10**6&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;products_wanted&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'size'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;6&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-9-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-9&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-9-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {'tags': []}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-9-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-9-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 10 cell-10-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;10&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-10-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 10&quot; href=&quot;#10&quot; id=&quot;10&quot;&gt;
        10
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-10-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-10-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-10&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-10-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-10-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-10&quot; name=&quot;cell-10&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-10-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-10-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-10-source-label nb-source-label&quot; form=&quot;cell-10&quot; id=&quot;cell-10-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;## Download Complete
You have now downloaded a subset of the TESS DV products for this star and their locations can be seen by printing the &quot;Local Path&quot; in the manifest. Notice that because this star was observed in many sectors, there are many different sets of DV products, one set for each range of sectors searched.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Download Complete&lt;/span&gt;
You have now downloaded a subset of the TESS DV products for this star and their locations can be seen by printing the &quot;Local Path&quot; in the manifest. Notice that because this star was observed in many sectors, there are many different sets of DV products, one set for each range of sectors searched.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-10-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-10&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-10-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-10-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;download-complete&quot;&gt;
        &lt;a href=&quot;#download-complete&quot;&gt;
         Download Complete
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        You have now downloaded a subset of the TESS DV products for this star and their locations can be seen by printing the &quot;Local Path&quot; in the manifest. Notice that because this star was observed in many sectors, there are many different sets of DV products, one set for each range of sectors searched.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 11 cell-11-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;11&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-11-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 11&quot; href=&quot;#11&quot; id=&quot;11&quot;&gt;
        11
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-11-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-11-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-11&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-11-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-11-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-11&quot; name=&quot;cell-11&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-11-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-11-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-11-source-label nb-source-label&quot; form=&quot;cell-11&quot; id=&quot;cell-11-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;print( manifest['Local Path'] )&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Local Path'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-11-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-11&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-11-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-11-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-11-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 12 cell-12-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;12&quot; data-loc=&quot;3&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-12-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 12&quot; href=&quot;#12&quot; id=&quot;12&quot;&gt;
        12
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-12-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-12-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-12&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-12-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-12-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-12&quot; name=&quot;cell-12&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-12-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-12-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-12-source-label nb-source-label&quot; form=&quot;cell-12&quot; id=&quot;cell-12-source&quot; name=&quot;source&quot; readonly rows=&quot;3&quot;&gt;## Examine the Download Manifest

TESS file names tell you a lot about what is in the file. In the function `parse_manifest` below I break them apart so that I can make an easy to read table about the type of data that we downloaded.  Then we write-out that part of the table.   This makes it obvious that there are lots of different sets of DV files based on different searches, each with a different sector range.  For each sector it was observed, there is a single sector search, and then there are also several multi sector searches.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Examine the Download Manifest&lt;/span&gt;

TESS file names tell you a lot about what is in the file. In the function &lt;span class=&quot;sb&quot; title=&quot;Literal.String.Backtick&quot;&gt;`parse_manifest`&lt;/span&gt; below I break them apart so that I can make an easy to read table about the type of data that we downloaded.  Then we write-out that part of the table.   This makes it obvious that there are lots of different sets of DV files based on different searches, each with a different sector range.  For each sector it was observed, there is a single sector search, and then there are also several multi sector searches.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-12-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-12&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-12-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-12-loc&quot; role=&quot;none&quot;&gt;
       3
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;examine-the-download-manifest&quot;&gt;
        &lt;a href=&quot;#examine-the-download-manifest&quot;&gt;
         Examine the Download Manifest
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        TESS file names tell you a lot about what is in the file. In the function
        &lt;code&gt;
         parse_manifest
        &lt;/code&gt;
        below I break them apart so that I can make an easy to read table about the type of data that we downloaded.  Then we write-out that part of the table.   This makes it obvious that there are lots of different sets of DV files based on different searches, each with a different sector range.  For each sector it was observed, there is a single sector search, and then there are also several multi sector searches.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 13 cell-13-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;13&quot; data-loc=&quot;31&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-13-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 13&quot; href=&quot;#13&quot; id=&quot;13&quot;&gt;
        13
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-13-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-13-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-13&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-13-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-13-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-13&quot; name=&quot;cell-13&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-13-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-13-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-13-source-label nb-source-label&quot; form=&quot;cell-13&quot; id=&quot;cell-13-source&quot; name=&quot;source&quot; readonly rows=&quot;31&quot;&gt;def parse_manifest(manifest):
    &quot;&quot;&quot;
    Parse manifest and add back columns that are useful for TESS DV exploration.
    &quot;&quot;&quot;
    results = deepcopy(manifest)
    filenames = []
    sector_range = []
    exts = []
    for i,f in enumerate(manifest['Local Path']):
        file_parts = np.array(np.unique(f.split(sep = '-')))
        sectors = list( map ( lambda x: x[0:2] == 's0', file_parts))
        s1 = file_parts[sectors][0]
        try:
            s2 = file_parts[sectors][1]
        except:
            s2 = s1
        sector_range.append(&quot;%s-%s&quot; % (s1,s2))
        path_parts = np.array(f.split(sep = '/'))
        filenames.append(path_parts[-1])
        exts.append(path_parts[-1][-8:])

    results.add_column(table.Column(name = &quot;filename&quot;, data = filenames))
    results.add_column(table.Column(name = &quot;sectors&quot;, data = sector_range))
    results.add_column(table.Column(name = &quot;fileType&quot;, data = exts))
    results.add_column(table.Column(name = &quot;index&quot;, data = np.arange(0,len(manifest))))

    return results

#Run parser and print
results = parse_manifest(manifest)
print(results['index','sectors','fileType'])&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;parse_manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;w&quot; title=&quot;Text.Whitespace&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    Parse manifest and add back columns that are useful for TESS DV exploration.&lt;/span&gt;
&lt;span class=&quot;sd&quot; title=&quot;Literal.String.Doc&quot;&gt;    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;deepcopy&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;filenames&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector_range&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;exts&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Local Path'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]):&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;file_parts&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sep&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'-'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)))&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sectors&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'s0'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;file_parts&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;file_parts&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sectors&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;s2&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;file_parts&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sectors&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;s2&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;s1&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector_range&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path_parts&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sep&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'/'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;filenames&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path_parts&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;exts&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;path_parts&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;:])&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;add_column&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;filename&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;filenames&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;add_column&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;sectors&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;sector_range&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;add_column&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;fileType&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;exts&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;add_column&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;index&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))))&lt;/span&gt;

    &lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;#Run parser and print&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;parse_manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'index'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'sectors'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'fileType'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-13-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-13&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-13-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-13-loc&quot; role=&quot;none&quot;&gt;
       31
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-13-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 14 cell-14-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;14&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-14-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 14&quot; href=&quot;#14&quot; id=&quot;14&quot;&gt;
        14
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-14-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-14-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-14&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-14-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-14-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-14&quot; name=&quot;cell-14&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-14-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-14-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-14-source-label nb-source-label&quot; form=&quot;cell-14&quot; id=&quot;cell-14-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;## Plot the DVT File
The time series data used to find the repeating transit signals (which are also known as Threshold Crossing events (TCEs)) is found in the dvt.fits files.  As you can see there is a dvt file. If we want the file with the most data, we should pick the one with the longest sector range in the file name.  In this case it is s0001-s0013. &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## Plot the DVT File&lt;/span&gt;
The time series data used to find the repeating transit signals (which are also known as Threshold Crossing events (TCEs)) is found in the dvt.fits files.  As you can see there is a dvt file. If we want the file with the most data, we should pick the one with the longest sector range in the file name.  In this case it is s0001-s0013. 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-14-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-14&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-14-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-14-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h2 id=&quot;plot-the-dvt-file&quot;&gt;
        &lt;a href=&quot;#plot-the-dvt-file&quot;&gt;
         Plot the DVT File
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        The time series data used to find the repeating transit signals (which are also known as Threshold Crossing events (TCEs)) is found in the dvt.fits files.  As you can see there is a dvt file. If we want the file with the most data, we should pick the one with the longest sector range in the file name.  In this case it is s0001-s0013.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 15 cell-15-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;15&quot; data-loc=&quot;1&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-15-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 15&quot; href=&quot;#15&quot; id=&quot;15&quot;&gt;
        15
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-15-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-15-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-15&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-15-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-15-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-15&quot; name=&quot;cell-15&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-15-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-15-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-15-source-label nb-source-label&quot; form=&quot;cell-15&quot; id=&quot;cell-15-source&quot; name=&quot;source&quot; readonly rows=&quot;1&quot;&gt;print(results['index', 'sectors', 'fileType'][results['sectors'] == &quot;s0001-s0013&quot;])&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'index'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'sectors'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'fileType'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'sectors'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;s0001-s0013&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-15-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-15&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-15-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-15-loc&quot; role=&quot;none&quot;&gt;
       1
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-15-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 16 cell-16-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;16&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-16-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 16&quot; href=&quot;#16&quot; id=&quot;16&quot;&gt;
        16
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-16-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-16-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-16&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-16-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-16-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-16&quot; name=&quot;cell-16&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-16-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-16-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-16-source-label nb-source-label&quot; form=&quot;cell-16&quot; id=&quot;cell-16-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Plot the DV Median-Detrended Time Series
The median detrended fluxes are stored in the first extension under 'LC_DETREND'. This is a median detrended version of the light curve that was searched for transit signals. While in the continuous viewing zone, L98-59 was not observed during every sector so there will be gaps in our light curve.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Plot the DV Median-Detrended Time Series&lt;/span&gt;
The median detrended fluxes are stored in the first extension under 'LC_DETREND'. This is a median detrended version of the light curve that was searched for transit signals. While in the continuous viewing zone, L98-59 was not observed during every sector so there will be gaps in our light curve.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-16-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-16&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-16-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-16-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#plot-the-dv-median-detrended-time-series&quot;&gt;
         Plot the DV Median-Detrended Time Series
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        The median detrended fluxes are stored in the first extension under 'LC_DETREND'. This is a median detrended version of the light curve that was searched for transit signals. While in the continuous viewing zone, L98-59 was not observed during every sector so there will be gaps in our light curve.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 17 cell-17-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;17&quot; data-loc=&quot;6&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-17-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 17&quot; href=&quot;#17&quot; id=&quot;17&quot;&gt;
        17
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-17-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-17-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-17&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-17-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-17-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-17&quot; name=&quot;cell-17&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-17-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-17-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-17-source-label nb-source-label&quot; form=&quot;cell-17&quot; id=&quot;cell-17-source&quot; name=&quot;source&quot; readonly rows=&quot;6&quot;&gt;# Locate the file that has the data
want = (results['sectors'] == &quot;s0001-s0013&quot;) &amp;amp; (results['fileType'] == &quot;dvt.fits&quot;)
dvt_filename = manifest[want]['Local Path'][0]

# Print out the file info
fits.info(dvt_filename)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Locate the file that has the data&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;want&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'sectors'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;s0001-s0013&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'fileType'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;dvt.fits&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dvt_filename&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;want&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Local Path'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Print out the file info&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dvt_filename&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-17-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-17&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-17-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-17-loc&quot; role=&quot;none&quot;&gt;
       6
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-17-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 18 cell-18-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;18&quot; data-loc=&quot;9&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-18-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 18&quot; href=&quot;#18&quot; id=&quot;18&quot;&gt;
        18
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-18-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-18-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-18&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-18-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-18-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-18&quot; name=&quot;cell-18&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-18-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-18-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-18-source-label nb-source-label&quot; form=&quot;cell-18&quot; id=&quot;cell-18-source&quot; name=&quot;source&quot; readonly rows=&quot;9&quot;&gt;# Plot the detrended photometric time series in the first binary table. 
data = fits.getdata(dvt_filename, 1)
time = data['TIME']
relflux = data['LC_DETREND']

plt.figure(figsize = (16,3))
plt.plot (time, relflux, 'b.')
plt.ylim(1.2* np.nanpercentile(relflux, .5) , 1.2 * np.nanpercentile(relflux, 99.5))
plt.title('Data Validation Detrended Light Curve for %s' % (star_name))&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;c1&quot; title=&quot;Comment.Single&quot;&gt;# Plot the detrended photometric time series in the first binary table. &lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getdata&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dvt_filename&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TIME'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;relflux&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'LC_DETREND'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;relflux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'b.'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nanpercentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;relflux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1.2&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nanpercentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;relflux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;99.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Data Validation Detrended Light Curve for &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;star_name&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-18-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-18&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-18-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-18-loc&quot; role=&quot;none&quot;&gt;
       9
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-18-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 19 cell-19-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;19&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-19-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 19&quot; href=&quot;#19&quot; id=&quot;19&quot;&gt;
        19
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-19-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-19-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-19&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-19-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-19-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-19&quot; name=&quot;cell-19&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-19-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-19-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-19-source-label nb-source-label&quot; form=&quot;cell-19&quot; id=&quot;cell-19-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;### Plot Folded Light Curve
Each extension of the DVT data file contains a separate TCE. After the pipeline finds a set of transits, the transits are removed and the light curve is once again searched for transits.  L98-59 has three TCEs, each is consistent with the three confirmed planets found around this star.  Here we plot the phase folded light curve for each TCE, each as its own subplot.  The DVT file also contains a transit model as one of the columns in the FITS table. We overplot that in orange.&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;### Plot Folded Light Curve&lt;/span&gt;
Each extension of the DVT data file contains a separate TCE. After the pipeline finds a set of transits, the transits are removed and the light curve is once again searched for transits.  L98-59 has three TCEs, each is consistent with the three confirmed planets found around this star.  Here we plot the phase folded light curve for each TCE, each as its own subplot.  The DVT file also contains a transit model as one of the columns in the FITS table. We overplot that in orange.
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-19-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-19&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-19-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-19-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;h3&gt;
        &lt;a href=&quot;#plot-folded-light-curve&quot;&gt;
         Plot Folded Light Curve
        &lt;/a&gt;
       &lt;/h3&gt;
       &lt;p&gt;
        Each extension of the DVT data file contains a separate TCE. After the pipeline finds a set of transits, the transits are removed and the light curve is once again searched for transits.  L98-59 has three TCEs, each is consistent with the three confirmed planets found around this star.  Here we plot the phase folded light curve for each TCE, each as its own subplot.  The DVT file also contains a transit model as one of the columns in the FITS table. We overplot that in orange.
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 20 cell-20-cell_type&quot; class=&quot;cell code&quot; data-index=&quot;20&quot; data-loc=&quot;22&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-code-label nb-cell-label cell-20-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 20&quot; href=&quot;#20&quot; id=&quot;20&quot;&gt;
        20
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-20-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
         None
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-20-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-20&quot; name=&quot;cell_type&quot;&gt;
         &lt;option value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option id=&quot;cell-20-cell_type&quot; selected value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-20-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-20&quot; name=&quot;cell-20&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-20-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-20-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-20-source-label nb-source-label&quot; form=&quot;cell-20&quot; id=&quot;cell-20-source&quot; name=&quot;source&quot; readonly rows=&quot;22&quot;&gt;def plot_folded(phase, data, model, ext, period):
    isort = phase.argsort()

    plt.plot(phase[isort], data[isort], '.', ms = .5)
    plt.plot(phase[isort], model[isort], '-', lw = 1, label = &quot;TCE %i&quot; % ext)
    plt.xlabel('Phase (Period = %5.2f days)' % period)
    plt.ylim(1.5 * np.nanpercentile(data, .5) , 1.4 * np.nanpercentile(data,99.5))
    plt.legend(loc = &quot;lower right&quot;)

plt.figure(figsize = (14,10))

nTCEs = fits.getheader(dvt_filename)['NEXTEND'] - 2

for ext in range(1, nTCEs + 1):
    data = fits.getdata(dvt_filename, ext)
    head = fits.getheader(dvt_filename, ext)
    period = head['TPERIOD']
    phase = data['PHASE']
    flux = data['LC_INIT']
    model = data['MODEL_INIT']
    plt.subplot(3, 1, ext)
    plot_folded(phase, flux, model, ext, period)&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot; title=&quot;Name.Function&quot;&gt;plot_folded&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;phase&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ext&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;period&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;isort&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;phase&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;argsort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;phase&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;isort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;isort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ms&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;phase&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;isort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;isort&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'-'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;lw&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;TCE &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%i&lt;/span&gt;&lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ext&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'Phase (Period = &lt;/span&gt;&lt;span class=&quot;si&quot; title=&quot;Literal.String.Interpol&quot;&gt;%5.2f&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt; days)'&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;period&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1.5&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nanpercentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;1.4&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nanpercentile&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot; title=&quot;Literal.Number.Float&quot;&gt;99.5&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;loc&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot; title=&quot;Literal.String.Double&quot;&gt;&quot;lower right&quot;&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nTCEs&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getheader&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dvt_filename&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'NEXTEND'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;k&quot; title=&quot;Keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ext&lt;/span&gt; &lt;span class=&quot;ow&quot; title=&quot;Operator.Word&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot; title=&quot;Name.Builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;nTCEs&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getdata&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dvt_filename&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ext&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;fits&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;getheader&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;dvt_filename&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ext&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;period&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'TPERIOD'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;phase&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'PHASE'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'LC_INIT'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot; title=&quot;Literal.String.Single&quot;&gt;'MODEL_INIT'&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot; title=&quot;Operator&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; title=&quot;Literal.Number.Integer&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ext&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;plot_folded&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;phase&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;flux&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;ext&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot; title=&quot;Name&quot;&gt;period&lt;/span&gt;&lt;span class=&quot;p&quot; title=&quot;Punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-20-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-20&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-20-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-20-loc&quot; role=&quot;none&quot;&gt;
       22
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;span class=&quot;visually-hidden&quot; id=&quot;cell-20-outputs-len&quot;&gt;
        In None has 0
    outputs.
       &lt;/span&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 21 cell-21-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;21&quot; data-loc=&quot;4&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-21-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 21&quot; href=&quot;#21&quot; id=&quot;21&quot;&gt;
        21
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-21-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-21-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-21&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-21-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-21-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-21&quot; name=&quot;cell-21&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-21-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-21-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-21-source-label nb-source-label&quot; form=&quot;cell-21&quot; id=&quot;cell-21-source&quot; name=&quot;source&quot; readonly rows=&quot;4&quot;&gt;&amp;lt;a id=&quot;about_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
## About this Notebook
**Authors:** Susan E. Mullally, STScI 
&amp;lt;br/&amp;gt;**Last updated**: Aug 2023&lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;a id=&quot;about_ID&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;span class=&quot;gu&quot; title=&quot;Generic.Subheading&quot;&gt;## About this Notebook&lt;/span&gt;
&lt;span class=&quot;gs&quot; title=&quot;Generic.Strong&quot;&gt;**Authors:**&lt;/span&gt; Susan E. Mullally, STScI 
&amp;lt;br&amp;gt;**Last updated**: Aug 2023
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-21-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-21&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-21-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-21-loc&quot; role=&quot;none&quot;&gt;
       4
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a id=&quot;about_ID&quot;&gt;
        &lt;/a&gt;
       &lt;/p&gt;
       &lt;h2 id=&quot;about-this-notebook&quot;&gt;
        &lt;a href=&quot;#about-this-notebook&quot;&gt;
         About this Notebook
        &lt;/a&gt;
       &lt;/h2&gt;
       &lt;p&gt;
        &lt;strong&gt;
         Authors:
        &lt;/strong&gt;
        Susan E. Mullally, STScI
        &lt;br&gt;
        &lt;strong&gt;
         Last updated
        &lt;/strong&gt;
        : Aug 2023
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr aria-labelledby=&quot;nb-cell-label 22 cell-22-cell_type&quot; class=&quot;cell markdown&quot; data-index=&quot;22&quot; data-loc=&quot;2&quot; role=&quot;listitem&quot;&gt;
      &lt;td class=&quot;nb-anchor&quot; role=&quot;none&quot;&gt;
       &lt;a aria-describedby=&quot;nb-markdown-label nb-cell-label cell-22-loc nb-loc-label&quot; aria-labelledby=&quot;nb-cell-label 22&quot; href=&quot;#22&quot; id=&quot;22&quot;&gt;
        22
       &lt;/a&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-execution_count&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;cell-22-source-label&quot;&gt;
        &lt;span&gt;
         In
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         [
        &lt;/span&gt;
        &lt;span&gt;
        &lt;/span&gt;
        &lt;span aria-hidden=&quot;true&quot;&gt;
         ]
        &lt;/span&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot; hidden role=&quot;none&quot;&gt;
       &lt;label id=&quot;nb-cell-22-select&quot;&gt;
        cell type
        &lt;select form=&quot;cell-22&quot; name=&quot;cell_type&quot;&gt;
         &lt;option id=&quot;cell-22-cell_type&quot; selected value=&quot;markdown&quot;&gt;
          markdown
         &lt;/option&gt;
         &lt;option value=&quot;code&quot;&gt;
          code
         &lt;/option&gt;
         &lt;option value=&quot;raw&quot;&gt;
          raw
         &lt;/option&gt;
        &lt;/select&gt;
       &lt;/label&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot; hidden role=&quot;none&quot;&gt;
       &lt;form aria-labelledby=&quot;cell-22-source-label&quot; class=&quot;nb-toolbar&quot; hidden id=&quot;cell-22&quot; name=&quot;cell-22&quot;&gt;
        &lt;fieldset&gt;
         &lt;legend&gt;
          actions
         &lt;/legend&gt;
         &lt;button type=&quot;submit&quot;&gt;
          Run Cell
         &lt;/button&gt;
        &lt;/fieldset&gt;
       &lt;/form&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-start&quot; hidden id=&quot;cell-22-start&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-end&quot; hidden id=&quot;cell-22-end&quot; role=&quot;none&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot; hidden role=&quot;none&quot;&gt;
       &lt;textarea aria-labelledby=&quot;cell-22-source-label nb-source-label&quot; form=&quot;cell-22&quot; id=&quot;cell-22-source&quot; name=&quot;source&quot; readonly rows=&quot;2&quot;&gt;[Top of Page](#title_ID)
&amp;lt;img alt=&quot;STScI logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;/&amp;gt; &lt;/textarea&gt;
       &lt;div aria-labelledby=&quot;nb-source-label&quot; role=&quot;group&quot;&gt;
        &lt;div class=&quot;highlight&quot;&gt;
         &lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class=&quot;nt&quot; title=&quot;Name.Tag&quot;&gt;Top of Page&lt;/span&gt;](&lt;span class=&quot;na&quot; title=&quot;Name.Attribute&quot;&gt;#title_ID&lt;/span&gt;)
&amp;lt;img style=&quot;float: right;&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; alt=&quot;STScI logo&quot; width=&quot;200px&quot;/&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
       &lt;/div&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot; hidden role=&quot;none&quot;&gt;
       &lt;button aria-controls=&quot;cell-22-metadata&quot; aria-describedby=&quot;nb-metadata-desc&quot; form=&quot;cell-22&quot; name=&quot;metadata&quot; onclick=&quot;openDialog()&quot;&gt;
        metadata
       &lt;/button&gt;
       &lt;dialog id=&quot;cell-22-metadata&quot;&gt;
        &lt;form&gt;
         &lt;button formmethod=&quot;dialog&quot;&gt;
          Close
         &lt;/button&gt;
         &lt;pre&gt;&lt;code&gt;
        {}
        &lt;/code&gt;&lt;/pre&gt;
        &lt;/form&gt;
       &lt;/dialog&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot; hidden id=&quot;cell-22-loc&quot; role=&quot;none&quot;&gt;
       2
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot; role=&quot;none&quot;&gt;
       &lt;p&gt;
        &lt;a href=&quot;#title_ID&quot;&gt;
         Top of Page
        &lt;/a&gt;
        &lt;img alt=&quot;STScI logo&quot; src=&quot;https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png&quot; style=&quot;float: right;&quot; width=&quot;200px&quot;&gt;
       &lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;table class=&quot;nb-cells-footer&quot; hidden&gt;
    &lt;tbody&gt;
     &lt;tr class=&quot;total&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       all cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       22
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       128
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;code&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       code cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
       unexecuted
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       22
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
       0
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       128
      &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr class=&quot;markdown&quot;&gt;
      &lt;th scope=&quot;row&quot;&gt;
       markdown cells
      &lt;/th&gt;
      &lt;th scope=&quot;row&quot;&gt;
       count
      &lt;/th&gt;
      &lt;td class=&quot;nb-ordered&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-cell_type&quot;&gt;
       22
      &lt;/td&gt;
      &lt;td class=&quot;nb-source&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-outputs&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-toolbar&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-metadata&quot;&gt;
      &lt;/td&gt;
      &lt;td class=&quot;nb-loc&quot;&gt;
       128
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;dialog id=&quot;nb-metadata&quot;&gt;
    &lt;form method=&quot;dialog&quot;&gt;
     &lt;button formmethod=&quot;dialog&quot;&gt;
      Close
     &lt;/button&gt;
     {&quot;kernelspec&quot;: {&quot;display_name&quot;: &quot;Python 3 (ipykernel)&quot;, &quot;language&quot;: &quot;python&quot;, &quot;name&quot;: &quot;python3&quot;}, &quot;language_info&quot;: {&quot;codemirror_mode&quot;: {&quot;name&quot;: &quot;ipython&quot;, &quot;version&quot;: 3}, &quot;file_extension&quot;: &quot;.py&quot;, &quot;mimetype&quot;: &quot;text/x-python&quot;, &quot;name&quot;: &quot;python&quot;, &quot;nbconvert_exporter&quot;: &quot;python&quot;, &quot;pygments_lexer&quot;: &quot;ipython3&quot;, &quot;version&quot;: &quot;3.11.4&quot;}}
    &lt;/form&gt;
   &lt;/dialog&gt;
   &lt;form aria-labelledby=&quot;nb-notebook-label&quot; id=&quot;notebook&quot; name=&quot;notebook&quot;&gt;
    &lt;label&gt;
     &lt;input id=&quot;nb-edit-mode&quot; name=&quot;edit&quot; type=&quot;checkbox&quot;&gt;
     edit mode
    &lt;/label&gt;
    &lt;button aria-controls=&quot;nb-metadata&quot; onclick=&quot;openDialog()&quot;&gt;
     metadata
    &lt;/button&gt;
    &lt;button type=&quot;submit&quot;&gt;
     Run
    &lt;/button&gt;
   &lt;/form&gt;
  &lt;/main&gt;
  &lt;section id=&quot;nb-dialogs&quot;&gt;
   &lt;details&gt;
    &lt;summary onclick=&quot;openDialogs()&quot;&gt;
     settings, help, &amp;amp; diagnostics
    &lt;/summary&gt;
   &lt;/details&gt;
  &lt;/section&gt;
  &lt;footer&gt;
   &lt;details class=&quot;log&quot;&gt;
    &lt;summary&gt;
     &lt;span&gt;
      activity log
     &lt;/span&gt;
    &lt;/summary&gt;
   &lt;/details&gt;
   &lt;table aria-live=&quot;polite&quot;&gt;
    &lt;tbody&gt;
     &lt;tr&gt;
      &lt;th hidden&gt;
       time
      &lt;/th&gt;
      &lt;td&gt;
       message
      &lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
   &lt;a accesskey=&quot;0&quot; href=&quot;#TOP&quot;&gt;
    skip to top
   &lt;/a&gt;
  &lt;/footer&gt;
 &lt;/body&gt;
&lt;/html&gt;
" width="100%"></iframe></div>

<h2 id="closing-thoughts">closing thoughts<a class="headerlink" href="#closing-thoughts" title="Permanent link">¤</a></h2>
<p>currently i cannot handle site navigation and licensing, but that is on the roadmap. (we want to think about them accessibly).
i'd like to use the jupyter toc as the toc to generate these templates.
this format for the documentation is a lot more flexible to modify than standard documentation systems.
we are dealing with our documentation as an intermediate table to offers introspection and manipulation.</p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script>







  
  






<script src="https://giscus.app/client.js"
        data-repo="tonyfast/tonyfast"
        data-repo-id="MDEwOlJlcG9zaXRvcnkyOTg2OTcxNjg="
        data-category-id="DIC_kwDOEc3B0M4CTmKy"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.top", "toc.integrate", "navigation.expand", "toc.follow"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c18c5fb9.min.js"></script>
      
    
  </body>
</html>